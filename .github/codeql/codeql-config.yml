name: "TideWatch CodeQL Config"

# This configuration file customizes CodeQL analysis for TideWatch
# It excludes known false positives where custom sanitizers are used

# Path filters to exclude test files from analysis
paths-ignore:
  - "**/tests/**"
  - "**/__tests__/**"
  - "**/test_*.py"
  - "**/*.test.ts"
  - "**/*.test.tsx"
  - "**/*.spec.ts"

# Query filters to exclude specific rules that produce false positives
# TideWatch uses custom sanitization functions that CodeQL doesn't recognize:
# - sanitize_log_message() for log injection prevention
# - sanitize_path() for path traversal prevention
# - validate_filename() for file name validation
# - validate_container_name() for container name validation
query-filters:
  # Exclude log injection - we use sanitize_log_message() from app.utils.security
  # which removes newlines and control characters from logged values
  - exclude:
      id: py/log-injection

  # Exclude path injection - we use sanitize_path() and validate_filename()
  # which properly validate paths against traversal attacks
  - exclude:
      id: py/path-injection
