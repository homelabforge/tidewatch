import{j as e,a as l}from"./index-BUvqVJQz.js";import{r}from"./router-vendor-h5EZ-JED.js";import{af as de,X as K,b as ve,o as Ae,v as te,F as Re,p as aa,ag as Gt,q as ot,a9 as V,l as ra,w as Ue,x as ct,r as ia,y as ne,s as Qt,U as da,t as d,I as na,aa as la,P as Vt,S as ca,R as N,ah as Kt,ai as oa,m as xa,aj as ma,a as ua,E as pa,V as Xt,ak as ha,Z as Yt,k as Fe,al as ba,a4 as ga,am as fa,an as ya,d as ja,ao as va,ap as qt,aq as Na,g as wa,j as ka}from"./ui-vendor-C3V6pTL3.js";import{S as _a}from"./StatusBadge-3gfg4x1Y.js";import{a as ee,f as U}from"./utils-vendor-DnsfCnls.js";import{R as Ca,L as be,C as ge,X as fe,Y as J,T as ye,a as je,b as z}from"./charts-vendor-dUpW-fSj.js";import"./react-vendor-C6WxKkic.js";function Sa({dependency:a,dependencyType:w,onClose:o,onConfirm:x}){const[y,m]=r.useState(""),[p,c]=r.useState(!1),k=async()=>{c(!0);try{await x(y||void 0),o()}catch(f){console.error("Failed to ignore dependency:",f)}finally{c(!1)}},P=()=>"image_name"in a?a.image_name:a.name,D=()=>"current_tag"in a?a.current_tag:a.current_version,g=()=>"latest_tag"in a?a.latest_tag:a.latest_version;return e.jsx("div",{className:"fixed inset-0 z-[60] overflow-y-auto",children:e.jsxs("div",{className:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0",children:[e.jsx("div",{className:"fixed inset-0 transition-opacity bg-tide-surface/75 backdrop-blur-sm",onClick:o}),e.jsxs("div",{className:"inline-block overflow-hidden text-left align-bottom transition-all transform bg-tide-surface rounded-lg shadow-xl sm:my-8 sm:align-middle sm:max-w-lg sm:w-full relative border border-tide-border",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-tide-border",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-yellow-500/20 rounded-lg",children:e.jsx(de,{className:"w-5 h-5 text-yellow-400"})}),e.jsx("h2",{className:"text-xl font-bold text-tide-text",children:"Ignore Update"})]}),e.jsx("button",{onClick:o,className:"text-tide-text-muted hover:text-tide-text transition-colors",children:e.jsx(K,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"p-6",children:[e.jsxs("p",{className:"text-tide-text mb-4",children:["Ignore update for ",e.jsx("span",{className:"font-semibold",children:P()})," from"," ",e.jsx("span",{className:"font-mono text-sm",children:D()})," to"," ",e.jsx("span",{className:"font-mono text-sm text-accent",children:g()}),"?"]}),e.jsx("div",{className:"bg-tide-surface-light border border-tide-border rounded-lg p-4 mb-4",children:e.jsx("p",{className:"text-sm text-tide-text-muted",children:"Note: If a newer version is released later, the ignore will be automatically cleared and you'll be notified about the new update."})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-tide-text mb-2",children:"Reason (optional)"}),e.jsx("textarea",{className:"w-full px-3 py-2 bg-tide-surface border border-tide-border rounded-lg text-tide-text placeholder-tide-text-muted focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent transition-all",value:y,onChange:f=>m(f.target.value),placeholder:"e.g., Known breaking change, waiting for stable release...",rows:3})]})]}),e.jsxs("div",{className:"flex gap-3 justify-end p-6 border-t border-tide-border bg-tide-surface-light",children:[e.jsx("button",{onClick:o,disabled:p,className:"px-4 py-2 text-sm font-medium text-tide-text bg-tide-surface border border-tide-border rounded-lg hover:bg-tide-surface-light transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancel"}),e.jsx("button",{onClick:k,disabled:p,className:"px-4 py-2 text-sm font-medium text-white bg-primary border border-primary rounded-lg hover:bg-primary/90 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:p?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Ignoring..."]}):e.jsxs(e.Fragment,{children:[e.jsx(de,{className:"w-4 h-4"}),"Ignore Update"]})})]})]})]})})}function Da({dependency:a,dependencyType:w,onClose:o,onConfirmUpdate:x,onPreview:y}){const[m,p]=r.useState(null),[c,k]=r.useState(!0),[P,D]=r.useState(!1),[g,f]=r.useState(null),[R,le]=r.useState(!1),C=async()=>{k(!0),f(null);try{const j=await y();p(j)}catch(j){console.error("Failed to load preview:",j),f(j instanceof Error?j.message:"Failed to load preview")}finally{k(!1)}};r.useEffect(()=>{C()},[]);const se=async()=>{D(!0);try{await x(),o()}catch(j){console.error("Failed to update dependency:",j),f(j instanceof Error?j.message:"Failed to update dependency")}finally{D(!1)}},ae=()=>"image_name"in a?a.image_name:a.name,b=()=>{if(!m)return!1;try{const j=parseInt(m.current_version.split(".")[0].replace(/[^0-9]/g,""));return parseInt(m.new_version.split(".")[0].replace(/[^0-9]/g,""))>j}catch{return!1}};return e.jsx("div",{className:"fixed inset-0 z-[60] overflow-y-auto",children:e.jsxs("div",{className:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0",children:[e.jsx("div",{className:"fixed inset-0 transition-opacity bg-tide-surface/75 backdrop-blur-sm",onClick:o}),e.jsxs("div",{className:"inline-block overflow-hidden text-left align-bottom transition-all transform bg-tide-surface rounded-lg shadow-xl sm:my-8 sm:align-middle sm:max-w-3xl sm:w-full relative border border-tide-border",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-tide-border",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-primary/20 rounded-lg",children:e.jsx(ve,{className:"w-5 h-5 text-primary"})}),e.jsx("h2",{className:"text-xl font-bold text-tide-text",children:"Preview Update"})]}),e.jsx("button",{onClick:o,className:"text-tide-text-muted hover:text-tide-text transition-colors",children:e.jsx(K,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("p",{className:"text-sm text-tide-text-muted mb-2",children:"Dependency"}),e.jsx("p",{className:"text-lg font-semibold text-tide-text",children:ae()})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("p",{className:"text-sm text-tide-text-muted mb-2",children:"Version Change"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"font-mono text-lg text-primary",children:m?.current_version||(c?"...":"N/A")}),e.jsx(Ae,{className:"text-orange-500",size:20}),e.jsx("span",{className:"font-mono text-lg text-orange-500 font-semibold",children:m?.new_version||(c?"...":"N/A")})]})]}),c&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"inline-block w-8 h-8 border-4 border-primary border-t-transparent rounded-full animate-spin mb-4"}),e.jsx("p",{className:"text-tide-text-muted",children:"Loading preview..."})]}),g&&e.jsx("div",{className:"bg-red-500/10 border border-red-500/30 rounded-lg p-4 mb-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(te,{className:"w-5 h-5 text-red-400 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-red-400 mb-1",children:"Preview Failed"}),e.jsx("p",{className:"text-sm text-red-400/80",children:g.includes("Not Found")||g.includes("404")?"This dependency type does not support file updates yet. Only Dockerfile dependencies and HTTP servers can be updated through the UI currently.":g})]})]})}),!c&&!g&&m&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-tide-surface-light border border-tide-border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-tide-text-muted mb-2",children:[e.jsx(Re,{size:16}),e.jsx("span",{className:"font-medium",children:"File to be updated"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"font-mono text-sm text-tide-text break-all",children:m.file_path}),m.line_number&&e.jsxs("div",{className:"text-sm text-tide-text-muted",children:["Line ",m.line_number]})]})]}),e.jsxs("div",{className:"bg-tide-surface-light border border-tide-border rounded-lg p-4",children:[e.jsx("div",{className:"flex items-center justify-between mb-2",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Re,{size:16,className:"text-primary"}),e.jsx("span",{className:"font-medium text-tide-text",children:"What's Changed"})]})}),m.changelog?e.jsxs("div",{children:[e.jsxs("button",{onClick:()=>le(!R),className:"w-full flex items-center justify-between py-2 text-left hover:opacity-80 transition-opacity",children:[e.jsx("span",{className:"text-sm text-tide-text-muted",children:"View Release Notes"}),e.jsxs("div",{className:"flex items-center gap-2",children:[m.changelog_url&&e.jsx("a",{href:m.changelog_url,target:"_blank",rel:"noopener noreferrer",onClick:j=>j.stopPropagation(),className:"text-primary hover:text-primary/80 transition-colors",children:e.jsx(aa,{size:16})}),R?e.jsx(Gt,{size:16,className:"text-tide-text-muted"}):e.jsx(ot,{size:16,className:"text-tide-text-muted"})]})]}),R&&e.jsx("div",{className:"mt-2 p-3 bg-tide-surface rounded border border-tide-border max-h-96 overflow-y-auto",children:e.jsx("pre",{className:"text-sm text-tide-text-muted whitespace-pre-wrap font-mono",children:m.changelog})})]}):e.jsx("p",{className:"text-sm text-tide-text-muted",children:"No changelog available for this update. Check the project's documentation or release notes for details."})]}),b()&&e.jsx("div",{className:"bg-orange-500/10 border border-orange-500/30 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(te,{className:"w-5 h-5 text-orange-400 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold text-orange-400 mb-1",children:"Major Version Update"}),e.jsx("p",{className:"text-sm text-orange-400/90",children:"This is a major version update which may contain breaking changes. Please review the changelog and ensure your application is compatible before proceeding."})]})]})}),e.jsx("div",{className:"bg-blue-500/10 border border-blue-500/30 rounded-lg p-4",children:e.jsx("p",{className:"text-sm text-blue-400",children:"A backup will be created before updating. You can restore from the backup if needed."})})]})]}),e.jsxs("div",{className:"flex gap-3 justify-end p-6 border-t border-tide-border bg-tide-surface-light",children:[e.jsx("button",{onClick:o,disabled:P,className:"px-4 py-2 text-sm font-medium text-tide-text bg-tide-surface border border-tide-border rounded-lg hover:bg-tide-surface-light transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancel"}),e.jsx("button",{onClick:se,disabled:P||c||!!g,className:"px-4 py-2 text-sm font-medium text-white bg-primary border border-primary rounded-lg hover:bg-primary/90 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:P?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Updating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(V,{className:"w-4 h-4"}),"Apply Update"]})})]})]})]})})}function Fa({dependencies:a,onClose:w,onConfirm:o,isUpdating:x}){const y=a.some(p=>p.security_advisories>0),m=a.reduce((p,c)=>p+c.security_advisories,0);return e.jsx("div",{className:"fixed inset-0 z-[60] overflow-y-auto",children:e.jsxs("div",{className:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0",children:[e.jsx("div",{className:"fixed inset-0 transition-opacity bg-tide-surface/75 backdrop-blur-sm",onClick:w}),e.jsxs("div",{className:"inline-block overflow-hidden text-left align-bottom transition-all transform bg-tide-surface rounded-lg shadow-xl sm:my-8 sm:align-middle sm:max-w-lg sm:w-full relative border border-tide-border",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-tide-border",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-primary/20 rounded-lg",children:e.jsx(V,{className:"w-5 h-5 text-primary"})}),e.jsxs("h2",{className:"text-xl font-bold text-tide-text",children:["Update ",a.length," Dependencies"]})]}),e.jsx("button",{onClick:w,disabled:x,className:"text-tide-text-muted hover:text-tide-text transition-colors disabled:opacity-50",children:e.jsx(K,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"p-6",children:[y&&e.jsxs("div",{className:"bg-orange-500/10 border border-orange-500/30 rounded-lg p-4 mb-4 flex items-start gap-3",children:[e.jsx(ra,{className:"w-5 h-5 text-orange-400 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-orange-400",children:"Security Advisories"}),e.jsxs("p",{className:"text-sm text-tide-text-muted mt-1",children:[m," security"," ",m===1?"advisory":"advisories"," will be addressed by these updates."]})]})]}),e.jsx("p",{className:"text-tide-text-muted mb-4",children:"The following dependencies will be updated in their manifest files:"}),e.jsx("div",{className:"max-h-64 overflow-y-auto border border-tide-border rounded-lg divide-y divide-tide-border",children:a.map(p=>e.jsxs("div",{className:"p-3 flex items-center justify-between hover:bg-tide-surface-light",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium text-tide-text truncate",children:p.name}),e.jsxs("p",{className:"text-sm text-tide-text-muted",children:[e.jsx("span",{className:"font-mono",children:p.current_version}),e.jsx("span",{className:"mx-2",children:"â†’"}),e.jsx("span",{className:"font-mono text-accent",children:p.latest_version})]})]}),p.security_advisories>0&&e.jsxs("span",{className:"ml-2 px-2 py-0.5 text-xs font-medium bg-red-500/20 text-red-400 rounded",children:[p.security_advisories," CVE",p.security_advisories>1?"s":""]})]},p.id))}),e.jsx("div",{className:"bg-tide-surface-light border border-tide-border rounded-lg p-4 mt-4",children:e.jsx("p",{className:"text-sm text-tide-text-muted",children:"Backups will be created for each modified file. You can view update history in the History tab."})})]}),e.jsxs("div",{className:"flex gap-3 justify-end p-6 border-t border-tide-border bg-tide-surface-light",children:[e.jsx("button",{onClick:w,disabled:x,className:"px-4 py-2 text-sm font-medium text-tide-text bg-tide-surface border border-tide-border rounded-lg hover:bg-tide-surface-light transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancel"}),e.jsx("button",{onClick:o,disabled:x,className:"px-4 py-2 text-sm font-medium text-white bg-primary border border-primary rounded-lg hover:bg-primary/90 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:x?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Updating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(V,{className:"w-4 h-4"}),"Update All"]})})]})]})]})})}function Aa({results:a,onClose:w}){const[o,x]=r.useState(new Set),y=c=>{const k=new Set(o);k.has(c)?k.delete(c):k.add(c),x(k)},m=a.failed.length===0,p=a.updated.length===0;return e.jsx("div",{className:"fixed inset-0 z-[60] overflow-y-auto",children:e.jsxs("div",{className:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0",children:[e.jsx("div",{className:"fixed inset-0 transition-opacity bg-tide-surface/75 backdrop-blur-sm",onClick:w}),e.jsxs("div",{className:"inline-block overflow-hidden text-left align-bottom transition-all transform bg-tide-surface rounded-lg shadow-xl sm:my-8 sm:align-middle sm:max-w-lg sm:w-full relative border border-tide-border",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-tide-border",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`p-2 rounded-lg ${m?"bg-green-500/20":p?"bg-red-500/20":"bg-yellow-500/20"}`,children:m?e.jsx(Ue,{className:"w-5 h-5 text-green-400"}):p?e.jsx(ct,{className:"w-5 h-5 text-red-400"}):e.jsx(Ue,{className:"w-5 h-5 text-yellow-400"})}),e.jsx("h2",{className:"text-xl font-bold text-tide-text",children:m?"All Updates Successful":p?"Updates Failed":"Partial Success"})]}),e.jsx("button",{onClick:w,className:"text-tide-text-muted hover:text-tide-text transition-colors",children:e.jsx(K,{className:"w-5 h-5"})})]}),e.jsx("div",{className:"p-6 border-b border-tide-border",children:e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-tide-text",children:a.summary.total}),e.jsx("p",{className:"text-sm text-tide-text-muted",children:"Total"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-green-400",children:a.summary.updated_count}),e.jsx("p",{className:"text-sm text-tide-text-muted",children:"Succeeded"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-red-400",children:a.summary.failed_count}),e.jsx("p",{className:"text-sm text-tide-text-muted",children:"Failed"})]})]})}),e.jsxs("div",{className:"max-h-80 overflow-y-auto",children:[a.updated.length>0&&e.jsxs("div",{className:"p-4",children:[e.jsx("h3",{className:"text-sm font-medium text-green-400 mb-2",children:"Successful Updates"}),e.jsx("div",{className:"space-y-2",children:a.updated.map(c=>e.jsxs("div",{className:"flex items-center gap-3 p-2 bg-green-500/10 border border-green-500/20 rounded-lg",children:[e.jsx(Ue,{className:"w-4 h-4 text-green-400 flex-shrink-0"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium text-tide-text truncate",children:c.name}),e.jsxs("p",{className:"text-xs text-tide-text-muted",children:[e.jsx("span",{className:"font-mono",children:c.from_version}),e.jsx("span",{className:"mx-1",children:"â†’"}),e.jsx("span",{className:"font-mono text-green-400",children:c.to_version})]})]})]},c.id))})]}),a.failed.length>0&&e.jsxs("div",{className:"p-4 border-t border-tide-border",children:[e.jsx("h3",{className:"text-sm font-medium text-red-400 mb-2",children:"Failed Updates"}),e.jsx("div",{className:"space-y-2",children:a.failed.map(c=>e.jsxs("div",{className:"bg-red-500/10 border border-red-500/20 rounded-lg overflow-hidden",children:[e.jsxs("button",{onClick:()=>y(c.id),className:"w-full flex items-center gap-3 p-2 text-left hover:bg-red-500/5 transition-colors",children:[e.jsx(ct,{className:"w-4 h-4 text-red-400 flex-shrink-0"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium text-tide-text truncate",children:c.name}),e.jsxs("p",{className:"text-xs text-tide-text-muted",children:[e.jsx("span",{className:"font-mono",children:c.from_version}),c.to_version&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"mx-1",children:"â†’"}),e.jsx("span",{className:"font-mono",children:c.to_version})]})]})]}),c.error&&(o.has(c.id)?e.jsx(ot,{className:"w-4 h-4 text-tide-text-muted flex-shrink-0"}):e.jsx(ia,{className:"w-4 h-4 text-tide-text-muted flex-shrink-0"}))]}),c.error&&o.has(c.id)&&e.jsx("div",{className:"px-3 pb-3 pt-1 border-t border-red-500/20",children:e.jsx("p",{className:"text-xs text-red-400 font-mono break-all",children:c.error})})]},c.id))})]})]}),e.jsx("div",{className:"flex justify-end p-6 border-t border-tide-border bg-tide-surface-light",children:e.jsx("button",{onClick:w,className:"px-4 py-2 text-sm font-medium text-white bg-primary border border-primary rounded-lg hover:bg-primary/90 transition-colors",children:"Close"})})]})]})})}function Ua({dependency:a,dependencyType:w,onClose:o,onRollbackComplete:x}){const[y,m]=r.useState(null),[p,c]=r.useState(!0),[k,P]=r.useState(!1),[D,g]=r.useState(null),[f,R]=r.useState(null),le=async()=>{c(!0),g(null);try{let b;w==="dockerfile"?b=await l.dependencies.getDockerfileRollbackHistory(a.id):w==="http_server"?b=await l.dependencies.getHttpServerRollbackHistory(a.id):b=await l.dependencies.getAppDependencyRollbackHistory(a.id),m(b)}catch(b){console.error("Failed to load rollback history:",b),g(b instanceof Error?b.message:"Failed to load rollback history")}finally{c(!1)}};r.useEffect(()=>{le()},[]);const C=async()=>{if(f){P(!0),g(null);try{w==="dockerfile"?await l.dependencies.rollbackDockerfile(a.id,f.from_version):w==="http_server"?await l.dependencies.rollbackHttpServer(a.id,f.from_version):await l.dependencies.rollbackAppDependency(a.id,f.from_version),x(),o()}catch(b){console.error("Failed to rollback dependency:",b),g(b instanceof Error?b.message:"Failed to rollback dependency")}finally{P(!1)}}},se=()=>"image_name"in a?a.image_name:a.name,ae=()=>"current_tag"in a?a.current_tag:a.current_version;return e.jsx("div",{className:"fixed inset-0 z-[60] overflow-y-auto",children:e.jsxs("div",{className:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0",children:[e.jsx("div",{className:"fixed inset-0 transition-opacity bg-tide-surface/75 backdrop-blur-sm",onClick:o}),e.jsxs("div",{className:"inline-block overflow-hidden text-left align-bottom transition-all transform bg-tide-surface rounded-lg shadow-xl sm:my-8 sm:align-middle sm:max-w-lg sm:w-full relative border border-tide-border",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-tide-border",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-orange-500/20 rounded-lg",children:e.jsx(ne,{className:"w-5 h-5 text-orange-400"})}),e.jsx("h2",{className:"text-xl font-bold text-tide-text",children:"Rollback Dependency"})]}),e.jsx("button",{onClick:o,disabled:k,className:"text-tide-text-muted hover:text-tide-text transition-colors disabled:opacity-50",children:e.jsx(K,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("p",{className:"text-sm text-tide-text-muted mb-1",children:"Dependency"}),e.jsx("p",{className:"text-lg font-semibold text-tide-text",children:se()}),e.jsxs("p",{className:"text-sm text-tide-text-muted mt-1",children:["Current version: ",e.jsx("span",{className:"font-mono text-primary",children:ae()})]})]}),p&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"inline-block w-8 h-8 border-4 border-orange-400 border-t-transparent rounded-full animate-spin mb-4"}),e.jsx("p",{className:"text-tide-text-muted",children:"Loading rollback history..."})]}),D&&e.jsx("div",{className:"bg-red-500/10 border border-red-500/30 rounded-lg p-4 mb-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(te,{className:"w-5 h-5 text-red-400 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-red-400 mb-1",children:"Error"}),e.jsx("p",{className:"text-sm text-red-400/80",children:D})]})]})}),!p&&!D&&y&&y.rollback_options.length===0&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx(ne,{className:"w-12 h-12 text-tide-text-muted mx-auto mb-4 opacity-50"}),e.jsx("p",{className:"text-tide-text-muted",children:"No rollback options available"}),e.jsx("p",{className:"text-sm text-tide-text-muted mt-1",children:"This dependency has no previous versions to roll back to."})]}),!p&&!D&&y&&y.rollback_options.length>0&&e.jsxs("div",{className:"space-y-3",children:[e.jsx("p",{className:"text-sm text-tide-text-muted mb-2",children:"Select a version to roll back to:"}),e.jsx("div",{className:"max-h-64 overflow-y-auto border border-tide-border rounded-lg divide-y divide-tide-border",children:y.rollback_options.map(b=>e.jsxs("button",{onClick:()=>R(b),className:`w-full p-3 text-left hover:bg-tide-surface-light transition-colors ${f?.history_id===b.history_id?"bg-orange-500/10 border-l-2 border-orange-400":""}`,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"font-mono font-medium text-tide-text",children:b.from_version}),f?.history_id===b.history_id&&e.jsx("span",{className:"text-xs bg-orange-500/20 text-orange-400 px-2 py-0.5 rounded",children:"Selected"})]}),e.jsxs("div",{className:"flex items-center gap-4 mt-1 text-xs text-tide-text-muted",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Qt,{size:12}),ee(new Date(b.updated_at),{addSuffix:!0})]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(da,{size:12}),b.triggered_by]})]}),e.jsxs("div",{className:"text-xs text-tide-text-muted mt-1",children:["Updated to ",e.jsx("span",{className:"font-mono",children:b.to_version})]})]},b.history_id))}),f&&e.jsx("div",{className:"bg-orange-500/10 border border-orange-500/30 rounded-lg p-4 mt-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(te,{className:"w-5 h-5 text-orange-400 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-orange-400 mb-1",children:"Confirm Rollback"}),e.jsxs("p",{className:"text-sm text-orange-400/90",children:["This will change the version from"," ",e.jsx("span",{className:"font-mono font-medium",children:ae()})," to"," ",e.jsx("span",{className:"font-mono font-medium",children:f.from_version}),". The file will be updated, but you'll need to rebuild/redeploy the project for changes to take effect."]})]})]})})]})]}),e.jsxs("div",{className:"flex gap-3 justify-end p-6 border-t border-tide-border bg-tide-surface-light",children:[e.jsx("button",{onClick:o,disabled:k,className:"px-4 py-2 text-sm font-medium text-tide-text bg-tide-surface border border-tide-border rounded-lg hover:bg-tide-surface-light transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancel"}),e.jsx("button",{onClick:C,disabled:k||p||!f,className:"px-4 py-2 text-sm font-medium text-white bg-orange-500 border border-orange-500 rounded-lg hover:bg-orange-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:k?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Rolling Back..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ne,{className:"w-4 h-4"}),"Rollback"]})})]})]})]})})}function La({container:a,onClose:w,onUpdate:o}){const[x,y]=r.useState("overview"),[m,p]=r.useState(!1),[c,k]=r.useState(null),[P,D]=r.useState(!1),[g,f]=r.useState(null),[R,le]=r.useState("24h"),[C,se]=r.useState([]),[ae,b]=r.useState(!1),[j,Pe]=r.useState(""),[$e,xt]=r.useState(!1),[B,Zt]=r.useState(!0),[Me,Jt]=r.useState(100),[ce,es]=r.useState(""),[oe,ts]=r.useState(!0),[X,ss]=r.useState(!1),[mt,ut]=r.useState([]),[He,pt]=r.useState(!1),[Te,as]=r.useState(a.policy),[Ee,rs]=r.useState(a.scope),[Ne,is]=r.useState(a.include_prereleases),[ht]=r.useState(a.vulnforge_enabled),[ds,ns]=r.useState(a.health_check_method),[Le,bt]=r.useState(a.health_check_url||""),[Ie,gt]=r.useState(""),[ze,ft]=r.useState(a.release_source||""),[re,yt]=r.useState(a.auto_restart_enabled),[$,jt]=r.useState(!1),[M,Be]=r.useState(null),[ls,vt]=r.useState(!1),[h,E]=r.useState({max_attempts:10,backoff_strategy:"exponential",base_delay_seconds:2,max_delay_seconds:300,success_window_seconds:300,health_check_enabled:!0,health_check_timeout:60,rollback_on_health_fail:!1}),[xe,Oe]=r.useState(a.dependencies||[]),[Nt,cs]=r.useState(a.dependents||[]),[os,xs]=r.useState([]),[we,wt]=r.useState(""),[kt,_t]=r.useState(a.update_window||""),[We,ie]=r.useState(a.update_window||""),[Y,ms]=r.useState(null),[Ve,Ct]=r.useState(!1),[ke,_e]=r.useState(!1),[me,Ke]=r.useState("updates"),[L,St]=r.useState(null),[Xe,Ce]=r.useState(!1),[q,Dt]=r.useState(null),[Ye,Se]=r.useState(!1),[v,qe]=r.useState("infra"),[us,Ft]=r.useState(!1),[ue,At]=r.useState(null),[ps,Ge]=r.useState(!1),[G,Qe]=r.useState(null),[hs,Ut]=r.useState(!1),[Ze,Rt]=r.useState(null),[Pt,bs]=r.useState(new Set),[$t,gs]=r.useState(new Set),[Je,Mt]=r.useState(!1),[fs,et]=r.useState(!1),[ys,Ht]=r.useState(!1),[Tt,Et]=r.useState(null),[js,vs]=r.useState(!0);r.useEffect(()=>{(async()=>{try{const i=(await l.settings.getAll()).find(u=>u.key==="my_projects_enabled");vs(i?.value==="true"||i?.value===!0)}catch(s){console.error("Failed to load settings:",s)}})()},[]);const Lt=r.useCallback(async()=>{D(!0);try{const t=await l.containers.getMetrics(a.id);k(t)}catch(t){console.error("Failed to load metrics:",t),k(null)}finally{D(!1)}},[a.id]),It=r.useCallback(async()=>{b(!0);try{const t=await fetch(`/api/v1/containers/${a.id}/metrics/history?period=${R}`);if(!t.ok)throw new Error("Failed to fetch history");const s=await t.json();se(s)}catch(t){console.error("Failed to load historical data:",t),se([])}finally{b(!1)}},[a.id,R]),De=r.useCallback(async()=>{xt(!0);try{const t=await l.containers.getLogs(a.id,Me);Pe(t.logs.join(`
`)||"")}catch(t){console.error("Failed to load logs:",t),Pe("Failed to load logs")}finally{xt(!1)}},[a.id,Me]);r.useEffect(()=>{if(x==="logs"&&(De(),B)){const t=setInterval(De,2e3);return()=>clearInterval(t)}},[x,B,De]);const pe=r.useCallback(async()=>{pt(!0);try{const t=await fetch(`/api/v1/containers/${a.id}/details`);if(!t.ok)throw new Error("Failed to fetch history");const s=await t.json();console.log("History data:",s.history),ut(s.history||[])}catch(t){console.error("Failed to load update history:",t),ut([])}finally{pt(!1)}},[a.id]),I=async t=>{jt(!0);try{await l.containers.update(a.id,t),d.success("Settings saved successfully"),o&&o()}catch(s){console.error("Failed to save settings:",s),d.error("Failed to save settings")}finally{jt(!1)}},Ns=async t=>{t==="auto"&&!window.confirm(`âš ï¸ Warning: Auto Policy

The "Auto" policy will automatically apply ALL updates, including MAJOR version updates that may contain breaking changes.

Consider using:
â€¢ "Patch Only" - Only patch updates (safest)
â€¢ "Minor + Patch" - Minor and patch updates (no breaking changes)
â€¢ "Security Only" - Only security updates

Are you sure you want to enable the Auto policy?`)||(as(t),await I({policy:t}))},ws=async t=>{const s=Ee;if(rs(t),await I({scope:t}),s!==t)try{await l.containers.recheckUpdates(a.id),d.success("Updates re-checked with new scope"),o&&o()}catch(i){console.error("Failed to re-check updates:",i),d.error("Failed to re-check updates")}},ks=async()=>{const t=!Ne;is(t),await I({include_prereleases:t})},_s=async t=>{ns(t),await I({health_check_method:t})},Cs=async()=>{console.log("Saving health check URL:",Le),await I({health_check_url:Le})},Ss=async()=>{console.log("Saving health check auth"),await I({health_check_auth:Ie}),gt("")},Ds=async()=>{console.log("Saving release source:",ze),await I({release_source:ze})},Fs=async()=>{try{const s=await(await fetch(`/api/v1/containers/${a.id}/detect-health-check`)).json();s.success&&s.detected_url?(bt(s.detected_url),await I({health_check_url:s.detected_url}),d.success(`Health check URL detected: ${s.detected_url}`)):d.error(s.message||"No health check found in compose file")}catch(t){console.error("Error detecting health check:",t),d.error("Failed to detect health check URL")}},As=async()=>{try{const s=await(await fetch(`/api/v1/containers/${a.id}/detect-release-source`)).json();s.success&&s.release_source?(ft(s.release_source),await I({release_source:s.release_source}),d.success(`Release source detected: ${s.release_source}`)):d(s.message||"Could not auto-detect release source. Please enter manually.")}catch(t){console.error("Error detecting release source:",t),d.error("Failed to detect release source")}},he=r.useCallback(async()=>{vt(!0);try{const t=await l.restarts.getState(a.id);Be(t),t&&E({max_attempts:t.max_attempts,backoff_strategy:t.backoff_strategy,base_delay_seconds:t.base_delay_seconds,max_delay_seconds:t.max_delay_seconds,success_window_seconds:t.success_window_seconds,health_check_enabled:t.health_check_enabled,health_check_timeout:t.health_check_timeout,rollback_on_health_fail:t.rollback_on_health_fail})}catch(t){console.error("Failed to load restart state:",t)}finally{vt(!1)}},[a.id]),tt=r.useCallback(async()=>{try{const t=await l.containers.getDependencies(a.id);Oe(t.dependencies),cs(t.dependents)}catch(t){console.error("Failed to load dependencies:",t)}},[a.id]),zt=r.useCallback(async()=>{try{const t=await l.containers.getAll();xs(t.filter(s=>s.id!==a.id))}catch(t){console.error("Failed to load containers:",t)}},[a.id]),Us=async()=>{const t=!re;try{if(t){const s=await l.restarts.enable(a.id,h);Be(s.state),yt(!0),d.success("Auto-restart enabled")}else await l.restarts.disable(a.id),yt(!1),d.success("Auto-restart disabled");o?.()}catch(s){console.error("Error toggling auto-restart:",s),d.error(s instanceof Error?s.message:"Failed to toggle auto-restart")}},Rs=async()=>{try{const t=await l.restarts.enable(a.id,h);Be(t.state),d.success("Restart configuration saved"),o?.()}catch(t){console.error("Error saving restart config:",t),d.error(t instanceof Error?t.message:"Failed to save configuration")}},Ps=async()=>{if(confirm("Are you sure you want to reset the restart failure count?"))try{await l.restarts.reset(a.id),await he(),d.success("Restart state reset")}catch(t){console.error("Error resetting restart state:",t),d.error(t instanceof Error?t.message:"Failed to reset state")}},$s=async()=>{const t=prompt("Pause auto-restart for how many hours?","24");if(!t)return;const s=parseInt(t)*3600;if(isNaN(s)||s<=0){d.error("Invalid duration");return}try{await l.restarts.pause(a.id,s),await he(),d.success(`Auto-restart paused for ${t} hours`)}catch(i){console.error("Error pausing restart:",i),d.error(i instanceof Error?i.message:"Failed to pause")}},Ms=async()=>{try{await l.restarts.resume(a.id),await he(),d.success("Auto-restart resumed")}catch(t){console.error("Error resuming restart:",t),d.error(t instanceof Error?t.message:"Failed to resume")}},Hs=async()=>{if(!we)return;const t=[...xe,we];try{await l.containers.updateDependencies(a.id,t),Oe(t),wt(""),d.success("Dependency added"),o?.()}catch(s){console.error("Error adding dependency:",s),d.error(s instanceof Error?s.message:"Failed to add dependency")}},Ts=async t=>{const s=xe.filter(i=>i!==t);try{await l.containers.updateDependencies(a.id,s),Oe(s),d.success("Dependency removed"),o?.()}catch(i){console.error("Error removing dependency:",i),d.error(i instanceof Error?i.message:"Failed to remove dependency")}},Es=async()=>{try{await l.containers.updateUpdateWindow(a.id,We||null),_t(We),d.success("Update window saved"),o?.()}catch(t){console.error("Error saving update window:",t),d.error(t instanceof Error?t.message:"Failed to save update window")}},Ls=async()=>{try{const t=!a.is_my_project;await l.containers.update(a.id,{is_my_project:t}),a.is_my_project=t,d.success(t?"Added to My Projects":"Removed from My Projects"),o?.()}catch(t){console.error("Error toggling My Project:",t),d.error(t instanceof Error?t.message:"Failed to update My Project status")}},H=r.useCallback(async()=>{Ct(!0);try{try{await l.containers.scanAppDependencies(a.id)}catch{console.log("App dependency scan skipped")}const t=await l.containers.getAppDependencies(a.id);ms(t)}catch(t){console.error("Error loading app dependencies:",t),d.error("Failed to load app dependencies")}finally{Ct(!1)}},[a.id]),O=r.useCallback(async()=>{Ce(!0);try{try{await l.containers.scanDockerfileDependencies(a.id)}catch{console.log("Dockerfile scan skipped: no Dockerfile found")}const t=await l.containers.getDockerfileDependencies(a.id);St(t)}catch(t){console.error("Error loading Dockerfile dependencies:",t),St(null)}finally{Ce(!1)}},[a.id]),W=r.useCallback(async()=>{Se(!0);try{try{await l.containers.scanHttpServers(a.id)}catch{console.log("HTTP server scan skipped")}const t=await l.containers.getHttpServers(a.id);Dt(t)}catch(t){console.error("Error loading HTTP servers:",t),Dt(null)}finally{Se(!1)}},[a.id]),st=(t,s)=>{At({dependency:t,type:s}),Ft(!0)},Is=async t=>{if(ue)try{const{dependency:s,type:i}=ue;i==="app"?(await l.dependencies.ignoreAppDependency(s.id,t),await H(),d.success(`Ignored update for ${s.name}`)):i==="dockerfile"?(await l.dependencies.ignoreDockerfile(s.id,t),await O(),d.success(`Ignored update for ${s.image_name}`)):i==="http_server"&&(await l.dependencies.ignoreHttpServer(s.id,t),await W(),d.success(`Ignored update for ${s.name}`))}catch(s){console.error("Failed to ignore dependency:",s),d.error("Failed to ignore update")}},at=async(t,s)=>{try{s==="app"?(await l.dependencies.unignoreAppDependency(t.id),await H(),d.success(`Unignored update for ${t.name}`)):s==="dockerfile"?(await l.dependencies.unignoreDockerfile(t.id),await O(),d.success(`Unignored update for ${t.image_name}`)):s==="http_server"&&(await l.dependencies.unignoreHttpServer(t.id),await W(),d.success(`Unignored update for ${t.name}`))}catch(i){console.error("Failed to unignore dependency:",i),d.error("Failed to unignore update")}},rt=(t,s)=>{Qe({dependency:t,type:s}),Ge(!0)},it=(t,s)=>{Rt({dependency:t,type:s}),Ut(!0)},zs=()=>{tt(),d.success("Dependency rolled back successfully")},Bs=async()=>{if(!G)throw new Error("No dependency to preview");const{dependency:t,type:s}=G;if(s==="app"){const i=t;if(console.log("Preview app dependency:",{id:i.id,name:i.name,latest_version:i.latest_version}),!i.id)throw new Error(`Dependency ${i.name} is missing ID field`);return await l.dependencies.previewAppDependencyUpdate(i.id,i.latest_version||"")}else if(s==="dockerfile"){const i=t;if(console.log("Preview dockerfile dependency:",{id:i.id,image:i.image_name,latest_tag:i.latest_tag}),!i.id)throw new Error(`Dependency ${i.image_name} is missing ID field`);return await l.dependencies.previewDockerfileUpdate(i.id,i.latest_tag||"")}else if(s==="http_server"){const i=t;if(console.log("Preview http server:",{id:i.id,name:i.name,latest_version:i.latest_version}),!i.id)throw new Error(`HTTP server ${i.name} is missing ID field`);return await l.dependencies.previewHttpServerUpdate(i.id,i.latest_version||"")}throw new Error("Invalid dependency type")},dt=async(t,s)=>{try{if(s==="app"){const i=t,u=i.latest_version||"";await l.dependencies.updateAppDependency(i.id,u),await H(),d.success(`Updated ${i.name} to ${u}`)}else if(s==="dockerfile"){const i=t,u=i.latest_tag||"";await l.dependencies.updateDockerfile(i.id,u),await O(),d.success(`Updated ${i.image_name} to ${u}`)}else if(s==="http_server"){const i=t,u=i.latest_version||"";await l.dependencies.updateHttpServer(i.id,u),await W(),d.success(`Updated ${i.name} to ${u}`)}}catch(i){console.error("Failed to update dependency:",i),d.error("Failed to update dependency")}},Os=async()=>{if(G)try{const{dependency:t,type:s}=G;if(s==="app"){const i=t,u=i.latest_version||"";await l.dependencies.updateAppDependency(i.id,u),await H(),d.success(`Updated ${i.name} to ${u}`)}else if(s==="dockerfile"){const i=t,u=i.latest_tag||"";await l.dependencies.updateDockerfile(i.id,u),await O(),d.success(`Updated ${i.image_name} to ${u}`)}else if(s==="http_server"){const i=t,u=i.latest_version||"";await l.dependencies.updateHttpServer(i.id,u),await W(),d.success(`Updated ${i.name} to ${u}`)}Ge(!1),Qe(null)}catch(t){throw console.error("Failed to update dependency:",t),d.error("Failed to update dependency"),t}},S=r.useCallback(()=>v==="dependencies"?Pt:v==="dev-dependencies"?$t:new Set,[v,Pt,$t]),Q=r.useCallback(t=>{v==="dependencies"&&bs(t),v==="dev-dependencies"&&gs(t)},[v]),Bt=r.useCallback(t=>(Y?.dependencies||[]).filter(s=>s.dependency_type===t&&s.update_available&&!s.ignored),[Y]),Ws=r.useCallback(t=>{const s=S(),i=new Set(s);i.has(t)?i.delete(t):i.add(t),Q(i)},[S,Q]),Vs=r.useCallback(()=>{const s=Bt(v==="dependencies"?"production":"development"),i=new Set(s.map(u=>u.id));Q(i)},[v,Bt,Q]),Ks=r.useCallback(()=>{Q(new Set)},[Q]),Xs=()=>{et(!0)},Ys=async()=>{et(!1),Mt(!0);try{const t=Array.from(S()),s=await l.dependencies.batchUpdateAppDependencies(t);Et(s),Ht(!0),s.summary.updated_count>0&&d.success(`Updated ${s.summary.updated_count} dependencies`),s.summary.failed_count>0&&d.error(`${s.summary.failed_count} updates failed`)}catch(t){console.error("Batch update failed:",t),d.error("Batch update failed")}finally{Mt(!1)}},qs=()=>{Ht(!1),Et(null),Q(new Set),H()},Gs=r.useCallback(()=>{const t=S();return(Y?.dependencies||[]).filter(s=>t.has(s.id))},[S,Y]);r.useEffect(()=>{x==="metrics"&&Lt(),x==="dependencies"&&(a.is_my_project&&H(),O(),W())},[x,a.id,a.is_my_project,Lt,H,O,W]),r.useEffect(()=>{g&&It()},[g,R,a.id,It]),r.useEffect(()=>{x==="history"&&pe()},[x,a.id,pe]),r.useEffect(()=>{x==="settings"&&(re&&he(),tt(),zt())},[x,a.id,re,he,tt,zt]);const nt=t=>t<60?`${t}s`:t<3600?`${Math.floor(t/60)}m`:t<86400?`${Math.floor(t/3600)}h`:`${Math.floor(t/86400)}d`,Qs=async t=>{if(confirm("Are you sure you want to rollback to the previous version? This will restart the container."))try{await l.history.rollback(t),d.success("Rollback initiated successfully"),await pe(),w()}catch(s){console.error("Rollback error:",s),d.error(s instanceof Error?s.message:"Failed to rollback")}},Zs=async t=>{if(!t.dependency_id||!t.dependency_type){d.error("Missing dependency information");return}try{t.dependency_type==="dockerfile"?(await l.dependencies.unignoreDockerfile(t.dependency_id),await O(),d.success(`Unignored ${t.dependency_name||"dependency"}`)):t.dependency_type==="http_server"?(await l.dependencies.unignoreHttpServer(t.dependency_id),await W(),d.success(`Unignored ${t.dependency_name||"dependency"}`)):t.dependency_type==="app_dependency"&&(await l.dependencies.unignoreAppDependency(t.dependency_id),await H(),d.success(`Unignored ${t.dependency_name||"dependency"}`)),await pe(),o&&o()}catch(s){console.error("Unignore error:",s),d.error("Failed to unignore dependency")}},F=t=>{if(t===0)return"0 B";const s=1024,i=["B","KB","MB","GB"],u=Math.floor(Math.log(t)/Math.log(s));return`${(t/Math.pow(s,u)).toFixed(2)} ${i[u]}`},Js=t=>{const s=t.toLowerCase();return s.includes("error")?"text-red-400":s.includes("warn")||s.includes("warning")?"text-yellow-400":s.includes("info")?"text-blue-400":s.includes("debug")?"text-tide-text-muted":"text-tide-text"},lt=t=>{if(!ce.trim())return t;const s=t.split(`
`),i=ce.toLowerCase();return s.filter(_=>_.toLowerCase().includes(i)).join(`
`)},ea=async()=>{try{const t=lt(j);await navigator.clipboard.writeText(t),d.success("Logs copied to clipboard")}catch(t){console.error("Failed to copy logs:",t),d.error("Failed to copy logs")}},ta=()=>{try{const t=lt(j),s=U(new Date,"yyyy-MM-dd-HHmmss"),i=`${a.name}-logs-${s}.txt`,u=new Blob([t],{type:"text/plain"}),_=URL.createObjectURL(u),T=document.createElement("a");T.href=_,T.download=i,document.body.appendChild(T),T.click(),document.body.removeChild(T),URL.revokeObjectURL(_),d.success(`Logs downloaded as ${i}`)}catch(t){console.error("Failed to download logs:",t),d.error("Failed to download logs")}},sa=()=>{if(C.length===0){d.error("No metrics data to export");return}try{const t=["Timestamp","CPU %","Memory Usage (bytes)","Memory Limit (bytes)","Memory %","Network RX (bytes)","Network TX (bytes)","Block Read (bytes)","Block Write (bytes)","PIDs"],s=C.map(A=>[A.timestamp,A.cpu_percent,A.memory_usage,A.memory_limit,A.memory_percent,A.network_rx,A.network_tx,A.block_read,A.block_write,A.pids]),i=[t.join(","),...s.map(A=>A.join(","))].join(`
`),u=U(new Date,"yyyy-MM-dd-HHmmss"),_=`${a.name}-metrics-${R}-${u}.csv`,T=new Blob([i],{type:"text/csv"}),n=URL.createObjectURL(T),Z=document.createElement("a");Z.href=n,Z.download=_,document.body.appendChild(Z),Z.click(),document.body.removeChild(Z),URL.revokeObjectURL(n),d.success(`Metrics exported as ${_}`)}catch(t){console.error("Failed to export metrics:",t),d.error("Failed to export metrics")}},Ot=async()=>{p(!0);try{const t=await l.containers.checkForUpdates(a.id);t.update?d.success(`Update found: ${t.update.to_tag}`):d.success("No updates available"),o&&o()}catch(t){d.error("Failed to check for updates"),console.error(t)}finally{p(!1)}},Wt=t=>{const s=Y?.dependencies.filter(n=>n.dependency_type===t)||[],i={critical:"bg-red-500/20 text-red-400 border-red-500/30",high:"bg-orange-500/20 text-orange-400 border-orange-500/30",medium:"bg-yellow-500/20 text-yellow-400 border-yellow-500/30",low:"bg-blue-500/20 text-blue-400 border-blue-500/30",info:"bg-gray-500/20 text-tide-text-muted border-gray-500/30"},u={npm:"ðŸ“¦",pypi:"ðŸ",composer:"ðŸ˜",cargo:"ðŸ¦€",go:"ðŸ¹"},_=s.filter(n=>n.update_available).length,T=s.filter(n=>n.security_advisories>0).length;return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-4",children:[e.jsxs("div",{className:"bg-tide-surface rounded-lg p-4 border border-tide-border",children:[e.jsx("p",{className:"text-sm text-tide-text-muted",children:"Total"}),e.jsx("p",{className:"text-2xl font-bold text-tide-text mt-1",children:s.length})]}),e.jsxs("div",{className:"bg-tide-surface rounded-lg p-4 border border-tide-border",children:[e.jsx("p",{className:"text-sm text-tide-text-muted",children:"Updates Available"}),e.jsx("p",{className:"text-2xl font-bold text-accent mt-1",children:_})]}),e.jsxs("div",{className:"bg-tide-surface rounded-lg p-4 border border-tide-border",children:[e.jsx("p",{className:"text-sm text-tide-text-muted",children:"Security Issues"}),e.jsx("p",{className:"text-2xl font-bold text-red-400 mt-1",children:T})]})]}),s.length>0&&e.jsxs("div",{className:"flex gap-2 mb-3",children:[e.jsxs("button",{onClick:()=>Ke("all"),className:`px-4 py-2 rounded-lg font-medium transition-colors ${me==="all"?"bg-primary text-tide-text":"bg-tide-surface text-tide-text hover:bg-tide-surface-light"}`,children:["All (",s.length,")"]}),e.jsxs("button",{onClick:()=>Ke("updates"),className:`px-4 py-2 rounded-lg font-medium transition-colors ${me==="updates"?"bg-primary text-tide-text":"bg-tide-surface text-tide-text hover:bg-tide-surface-light"}`,children:["Updates (",_,")"]}),e.jsxs("button",{onClick:()=>Ke("security"),className:`px-4 py-2 rounded-lg font-medium transition-colors ${me==="security"?"bg-primary text-tide-text":"bg-tide-surface text-tide-text hover:bg-tide-surface-light"}`,children:["Security (",T,")"]})]}),(v==="dependencies"||v==="dev-dependencies")&&_>0&&e.jsxs("div",{className:"flex items-center justify-between bg-tide-surface-light rounded-lg p-3 mb-3 border border-tide-border",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"checkbox",checked:S().size===_&&_>0,ref:n=>{n&&(n.indeterminate=S().size>0&&S().size<_)},onChange:n=>{n.target.checked?Vs():Ks()},className:"w-4 h-4 rounded border-tide-border accent-primary"}),e.jsx("span",{className:"text-sm text-tide-text",children:S().size>0?`${S().size} selected`:`Select all with updates (${_})`})]}),S().size>0&&e.jsx("button",{onClick:Xs,disabled:Je,className:"px-4 py-2 bg-primary hover:bg-primary/90 text-white rounded-lg font-medium transition-colors flex items-center gap-2 disabled:opacity-50",children:Je?e.jsxs(e.Fragment,{children:[e.jsx(N,{className:"animate-spin",size:16}),"Updating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(V,{size:16}),"Update Selected (",S().size,")"]})})]}),Ve?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(N,{className:"animate-spin mx-auto mb-4 text-primary",size:48}),e.jsx("p",{className:"text-tide-text-muted",children:"Loading dependencies..."})]}):s.length>0?e.jsx("div",{className:"space-y-2",children:s.filter(n=>!(me==="updates"&&!n.update_available||me==="security"&&n.security_advisories===0)).sort((n,Z)=>n.name.localeCompare(Z.name)).map(n=>e.jsxs("div",{className:"bg-tide-surface rounded-lg p-4 border border-tide-border flex items-center justify-between",children:[!n.ignored&&n.update_available&&(v==="dependencies"||v==="dev-dependencies")&&e.jsx("div",{className:"pr-3",children:e.jsx("input",{type:"checkbox",checked:S().has(n.id),onChange:()=>Ws(n.id),className:"w-4 h-4 rounded border-tide-border accent-primary"})}),e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-2xl",children:u[n.ecosystem]||"ðŸ“¦"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("p",{className:"text-tide-text font-medium",children:n.name})}),e.jsxs("p",{className:"text-sm text-tide-text-muted",children:[n.ecosystem," â€¢ Current: ",n.current_version,n.latest_version&&n.update_available&&e.jsxs("span",{className:"text-accent ml-2",children:["â†’ ",n.latest_version]})]})]})]})}),e.jsxs("div",{className:"flex items-center gap-2",children:[!n.ignored&&n.update_available&&e.jsxs("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${i[n.severity]||i.info}`,children:[n.severity==="critical"&&"Critical Update",n.severity==="high"&&"High Priority",n.severity==="medium"&&"Major Update",n.severity==="low"&&"Minor Update",n.severity==="info"&&"Patch Update"]}),!n.ignored&&!n.update_available&&n.last_checked&&e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-500/20 text-green-400 border border-green-500/30",children:"Up to date"}),n.ignored&&e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-500/20 text-gray-400 border border-gray-500/30",children:"Up to date"}),n.security_advisories>0&&e.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-500/20 text-red-400 border border-red-500/30",children:[e.jsx(ka,{size:12,className:"mr-1"}),n.security_advisories," ",n.security_advisories===1?"Advisory":"Advisories"]}),n.socket_score!==null&&e.jsxs("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${n.socket_score>=70?"bg-green-500/20 text-green-400 border border-green-500/30":n.socket_score>=40?"bg-yellow-500/20 text-yellow-400 border border-yellow-500/30":"bg-red-500/20 text-red-400 border border-red-500/30"}`,children:["Socket: ",n.socket_score]}),!n.ignored&&n.update_available&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>rt(n,"app"),className:"px-2.5 py-1.5 bg-tide-surface hover:bg-tide-surface-light text-tide-text rounded-lg font-medium transition-colors flex items-center gap-1.5 text-xs border border-tide-border",title:"Preview update changes",children:[e.jsx(ve,{size:14}),"Preview"]}),e.jsxs("button",{onClick:()=>dt(n,"app"),className:"px-2.5 py-1.5 bg-primary hover:bg-primary/90 text-white rounded-lg font-medium transition-colors flex items-center gap-1.5 text-xs border border-primary",title:"Update dependency immediately",children:[e.jsx(V,{size:14}),"Update"]}),e.jsxs("button",{onClick:()=>st(n,"app"),className:"px-2.5 py-1.5 bg-primary/20 hover:bg-primary/30 text-primary rounded-lg font-medium transition-colors flex items-center gap-1.5 text-xs border border-primary/30",title:"Ignore this update",children:[e.jsx(de,{size:14}),"Ignore"]})]}),n.ignored&&e.jsxs("button",{onClick:()=>at(n,"app"),className:"px-2.5 py-1.5 bg-tide-surface hover:bg-tide-surface-light text-tide-text rounded-lg font-medium transition-colors flex items-center gap-1.5 text-xs border border-tide-border",title:"Unignore this update",children:[e.jsx(Fe,{size:14}),"Unignore"]}),e.jsxs("button",{onClick:()=>it(n,"app"),className:"px-2.5 py-1.5 bg-orange-500/20 hover:bg-orange-500/30 text-orange-400 rounded-lg font-medium transition-colors flex items-center gap-1.5 text-xs border border-orange-500/30",title:"Rollback to a previous version",children:[e.jsx(ne,{size:14}),"Rollback"]})]})]},`${n.ecosystem}-${n.name}`))}):e.jsxs("div",{className:"text-center py-12 bg-tide-surface border border-tide-border rounded-lg",children:[e.jsx(Vt,{className:"mx-auto mb-4 text-gray-600",size:48}),e.jsxs("p",{className:"text-tide-text-muted",children:["No ",t," dependencies found"]}),e.jsxs("p",{className:"text-sm text-tide-text-muted mt-1",children:["No ",t," dependencies detected in your project"]})]}),Y?.last_scan&&e.jsxs("div",{className:"text-sm text-tide-text-muted text-center mt-4",children:["Last scanned: ",ee(new Date(Y.last_scan),{addSuffix:!0})]})]})};return e.jsxs("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0",children:[e.jsx("div",{className:"fixed inset-0 transition-opacity bg-tide-surface/75",onClick:w}),e.jsxs("div",{className:"inline-block overflow-hidden text-left align-bottom transition-all transform bg-tide-surface rounded-lg shadow-xl sm:my-8 sm:align-middle sm:max-w-6xl sm:w-full relative",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-tide-border",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-tide-text",children:a.name}),e.jsxs("p",{className:"text-sm text-tide-text-muted mt-1",children:[a.image,":",a.current_tag]})]}),e.jsx("button",{onClick:w,className:"text-tide-text-muted hover:text-tide-text transition-colors",children:e.jsx(K,{className:"w-6 h-6"})})]}),e.jsx("div",{className:"border-b border-tide-border px-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex space-x-1",children:[e.jsxs("button",{onClick:()=>y("overview"),className:`px-4 py-3 text-sm font-medium transition-colors border-b-2 flex items-center gap-2 ${x==="overview"?"border-primary text-primary":"border-transparent text-tide-text-muted hover:text-tide-text"}`,children:[e.jsx(na,{size:16}),"Overview"]}),e.jsxs("button",{onClick:()=>y("metrics"),className:`px-4 py-3 text-sm font-medium transition-colors border-b-2 flex items-center gap-2 ${x==="metrics"?"border-primary text-primary":"border-transparent text-tide-text-muted hover:text-tide-text"}`,children:[e.jsx(la,{size:16}),"Metrics"]}),e.jsxs("button",{onClick:()=>y("logs"),className:`px-4 py-3 text-sm font-medium transition-colors border-b-2 flex items-center gap-2 ${x==="logs"?"border-primary text-primary":"border-transparent text-tide-text-muted hover:text-tide-text"}`,children:[e.jsx(Re,{size:16}),"Logs"]}),e.jsxs("button",{onClick:()=>y("history"),className:`px-4 py-3 text-sm font-medium transition-colors border-b-2 flex items-center gap-2 ${x==="history"?"border-primary text-primary":"border-transparent text-tide-text-muted hover:text-tide-text"}`,children:[e.jsx(Qt,{size:16}),"History"]}),a.is_my_project&&e.jsxs("button",{onClick:()=>y("dependencies"),className:`px-4 py-3 text-sm font-medium transition-colors border-b-2 flex items-center gap-2 ${x==="dependencies"?"border-primary text-primary":"border-transparent text-tide-text-muted hover:text-tide-text"}`,children:[e.jsx(Vt,{size:16}),"Dependencies"]})]}),e.jsxs("button",{onClick:()=>y("settings"),className:`px-4 py-3 text-sm font-medium transition-colors border-b-2 flex items-center gap-2 ${x==="settings"?"border-primary text-primary":"border-transparent text-tide-text-muted hover:text-tide-text"}`,children:[e.jsx(ca,{size:16}),"Settings"]})]})}),e.jsx("div",{className:"p-6 max-h-[70vh] overflow-y-auto",children:e.jsxs(e.Fragment,{children:[x==="overview"&&e.jsxs("div",{className:"space-y-6",children:[a.update_available?e.jsxs("div",{className:"bg-tide-surface/50 rounded-lg p-4 border border-tide-border border-l-4 border-l-accent",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(te,{className:"w-8 h-8 text-accent"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-tide-text",children:"Update Available"}),e.jsxs("p",{className:"text-tide-text-muted text-sm mt-1",children:["A new version is available: ",a.latest_tag||"Unknown"]})]})]}),e.jsxs("div",{className:"mt-4 flex gap-2",children:[e.jsxs("button",{onClick:Ot,disabled:m,className:"px-4 py-2 bg-tide-surface-light hover:bg-gray-500 text-tide-text rounded-lg transition-colors flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(N,{className:`w-4 h-4 ${m?"animate-spin":""}`}),m?"Checking...":"Check for Updates"]}),e.jsxs("button",{onClick:async()=>{const t=prompt("Optional: Enter a reason for the restart");try{await l.restarts.manualRestart(a.id,t||void 0),d.success("Container restarted successfully"),o?.()}catch{d.error("Failed to restart container")}},className:"px-4 py-2 bg-accent hover:bg-accent-dark text-tide-text rounded-lg transition-colors flex items-center gap-2",children:[e.jsx(N,{className:"w-4 h-4"}),"Restart"]})]})]}):e.jsxs("div",{className:"bg-tide-surface/50 rounded-lg p-4 border border-tide-border border-l-4 border-l-green-500",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ue,{className:"w-8 h-8 text-green-500"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-tide-text",children:"Up to Date"}),e.jsx("p",{className:"text-tide-text-muted text-sm mt-1",children:"This container is running the latest version."})]})]}),e.jsxs("div",{className:"mt-4 flex gap-2",children:[e.jsxs("button",{onClick:Ot,disabled:m,className:"px-4 py-2 bg-tide-surface-light hover:bg-gray-500 text-tide-text rounded-lg transition-colors flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(N,{className:`w-4 h-4 ${m?"animate-spin":""}`}),m?"Checking...":"Check for Updates"]}),e.jsxs("button",{onClick:async()=>{const t=prompt("Optional: Enter a reason for the restart");try{await l.restarts.manualRestart(a.id,t||void 0),d.success("Container restarted successfully"),o?.()}catch{d.error("Failed to restart container")}},className:"px-4 py-2 bg-accent hover:bg-accent-dark text-tide-text rounded-lg transition-colors flex items-center gap-2",children:[e.jsx(N,{className:"w-4 h-4"}),"Restart"]})]})]}),e.jsxs("div",{className:"bg-tide-surface/50 rounded-lg p-4 border border-tide-border",children:[e.jsx("h3",{className:"text-lg font-semibold text-tide-text mb-4",children:"Information"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-tide-text-muted",children:"Registry"}),e.jsx("span",{className:"text-tide-text font-mono text-sm",children:a.registry})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-tide-text-muted",children:"Compose File"}),e.jsx("span",{className:"text-tide-text font-mono text-sm truncate max-w-xs",title:a.compose_file,children:a.compose_file})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-tide-text-muted",children:"Service Name"}),e.jsx("span",{className:"text-tide-text font-mono text-sm",children:a.service_name})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-tide-text-muted",children:"Last Checked"}),e.jsx("span",{className:"text-tide-text text-sm",children:a.last_checked?ee(new Date(a.last_checked),{addSuffix:!0}):"Never"})]})]})]})]}),x==="metrics"&&(P?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(N,{className:"w-8 h-8 text-primary animate-spin"})}):g?e.jsxs("div",{children:[e.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[e.jsxs("button",{onClick:()=>f(null),className:"text-primary hover:text-primary/80 transition-colors flex items-center gap-2",children:[e.jsx(K,{className:"w-4 h-4"}),"Back to Metrics"]}),e.jsx("div",{className:"flex gap-2",children:["1h","6h","24h","7d","30d"].map(t=>e.jsx("button",{onClick:()=>le(t),className:`px-3 py-1 rounded-lg text-sm transition-colors ${R===t?"bg-primary text-tide-text":"bg-tide-surface-light text-tide-text hover:bg-gray-500"}`,children:t},t))})]}),e.jsxs("div",{className:"bg-tide-surface/50 rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h3",{className:"text-xl font-semibold text-tide-text capitalize",children:[g," History"]}),e.jsxs("div",{className:"flex items-center gap-3",children:[(g==="cpu"||g==="memory")&&e.jsxs("button",{onClick:()=>ss(!X),className:`flex items-center gap-2 px-3 py-2 rounded-lg text-sm transition-colors ${X?"bg-primary text-tide-text":"bg-tide-surface-light text-tide-text hover:bg-gray-500"}`,children:[e.jsx(Kt,{className:"w-4 h-4"}),X?"Comparing":"Compare"]}),e.jsxs("button",{onClick:sa,disabled:C.length===0,className:"flex items-center gap-2 px-3 py-2 bg-tide-surface-light hover:bg-gray-500 text-tide-text rounded-lg text-sm transition-colors disabled:opacity-50",children:[e.jsx(oa,{className:"w-4 h-4"}),"Export CSV"]})]})]}),ae?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(N,{className:"w-8 h-8 text-primary animate-spin"})}):C.length===0?e.jsx("div",{className:"flex items-center justify-center h-64 text-tide-text-muted",children:e.jsx("p",{children:"No historical data available yet. Data will be collected every 5 minutes."})}):e.jsx("div",{className:"h-80",children:e.jsxs(Ca,{width:"100%",height:"100%",children:[g==="cpu"&&e.jsxs(be,{data:C,children:[e.jsx(ge,{strokeDasharray:"3 3",stroke:"#374151"}),e.jsx(fe,{dataKey:"timestamp",stroke:"#9CA3AF",tickFormatter:t=>U(new Date(t),"HH:mm")}),e.jsx(J,{yAxisId:"left",stroke:"#9CA3AF",label:{value:"CPU %",angle:-90,position:"insideLeft",style:{fill:"#9CA3AF"}}}),X&&e.jsx(J,{yAxisId:"right",orientation:"right",stroke:"#9CA3AF",tickFormatter:t=>F(t),label:{value:"Memory (MB)",angle:90,position:"insideRight",style:{fill:"#9CA3AF"}}}),e.jsx(ye,{contentStyle:{backgroundColor:"#1F2937",border:"1px solid #374151"},labelFormatter:t=>U(new Date(t),"PPpp")}),e.jsx(je,{}),e.jsx(z,{yAxisId:"left",type:"monotone",dataKey:"cpu_percent",stroke:"#3B82F6",name:"CPU %",strokeWidth:2}),X&&e.jsx(z,{yAxisId:"right",type:"monotone",dataKey:"memory_usage",stroke:"#10B981",name:"Memory Usage",strokeWidth:2})]}),g==="memory"&&e.jsxs(be,{data:C,children:[e.jsx(ge,{strokeDasharray:"3 3",stroke:"#374151"}),e.jsx(fe,{dataKey:"timestamp",stroke:"#9CA3AF",tickFormatter:t=>U(new Date(t),"HH:mm")}),e.jsx(J,{yAxisId:"left",stroke:"#9CA3AF",tickFormatter:t=>F(t),label:{value:"Memory (MB)",angle:-90,position:"insideLeft",style:{fill:"#9CA3AF"}}}),X&&e.jsx(J,{yAxisId:"right",orientation:"right",stroke:"#9CA3AF",label:{value:"CPU %",angle:90,position:"insideRight",style:{fill:"#9CA3AF"}}}),e.jsx(ye,{contentStyle:{backgroundColor:"#1F2937",border:"1px solid #374151"},labelFormatter:t=>U(new Date(t),"PPpp")}),e.jsx(je,{}),e.jsx(z,{yAxisId:"left",type:"monotone",dataKey:"memory_usage",stroke:"#10B981",name:"Memory Usage",strokeWidth:2}),X&&e.jsx(z,{yAxisId:"right",type:"monotone",dataKey:"cpu_percent",stroke:"#3B82F6",name:"CPU %",strokeWidth:2})]}),g==="network"&&e.jsxs(be,{data:C,children:[e.jsx(ge,{strokeDasharray:"3 3",stroke:"#374151"}),e.jsx(fe,{dataKey:"timestamp",stroke:"#9CA3AF",tickFormatter:t=>U(new Date(t),"HH:mm")}),e.jsx(J,{stroke:"#9CA3AF",tickFormatter:t=>F(t)}),e.jsx(ye,{contentStyle:{backgroundColor:"#1F2937",border:"1px solid #374151"},labelFormatter:t=>U(new Date(t),"PPpp"),formatter:(t,s)=>[F(t||0),s||""]}),e.jsx(je,{}),e.jsx(z,{type:"monotone",dataKey:"network_rx",stroke:"#8B5CF6",name:"RX"}),e.jsx(z,{type:"monotone",dataKey:"network_tx",stroke:"#EC4899",name:"TX"})]}),g==="disk"&&e.jsxs(be,{data:C,children:[e.jsx(ge,{strokeDasharray:"3 3",stroke:"#374151"}),e.jsx(fe,{dataKey:"timestamp",stroke:"#9CA3AF",tickFormatter:t=>U(new Date(t),"HH:mm")}),e.jsx(J,{stroke:"#9CA3AF",tickFormatter:t=>F(t)}),e.jsx(ye,{contentStyle:{backgroundColor:"#1F2937",border:"1px solid #374151"},labelFormatter:t=>U(new Date(t),"PPpp"),formatter:(t,s)=>[F(t||0),s||""]}),e.jsx(je,{}),e.jsx(z,{type:"monotone",dataKey:"block_read",stroke:"#F59E0B",name:"Read"}),e.jsx(z,{type:"monotone",dataKey:"block_write",stroke:"#EF4444",name:"Write"})]}),g==="pids"&&e.jsxs(be,{data:C,children:[e.jsx(ge,{strokeDasharray:"3 3",stroke:"#374151"}),e.jsx(fe,{dataKey:"timestamp",stroke:"#9CA3AF",tickFormatter:t=>U(new Date(t),"HH:mm")}),e.jsx(J,{stroke:"#9CA3AF"}),e.jsx(ye,{contentStyle:{backgroundColor:"#1F2937",border:"1px solid #374151"},labelFormatter:t=>U(new Date(t),"PPpp"),formatter:t=>[t||0,"Processes"]}),e.jsx(je,{}),e.jsx(z,{type:"monotone",dataKey:"pids",stroke:"#06B6D4",name:"PIDs"})]})]})})]})]}):e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{onClick:()=>f("cpu"),className:"bg-tide-surface/50 rounded-lg p-4 cursor-pointer hover:bg-tide-surface transition-colors border border-tide-border",children:[e.jsx("h3",{className:"text-lg font-semibold text-tide-text mb-4",children:"CPU Usage"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-tide-text-muted",children:"Current"}),e.jsx("span",{className:"text-tide-text font-mono text-sm",children:c?`${c.cpu_percent.toFixed(2)}%`:"N/A"})]}),e.jsx("div",{className:"w-full bg-tide-surface-light rounded-full h-2",children:e.jsx("div",{className:"bg-primary h-2 rounded-full transition-all",style:{width:`${c?Math.min(c.cpu_percent,100):0}%`}})})]})]}),e.jsxs("div",{onClick:()=>f("memory"),className:"bg-tide-surface/50 rounded-lg p-4 cursor-pointer hover:bg-tide-surface transition-colors border border-tide-border",children:[e.jsx("h3",{className:"text-lg font-semibold text-tide-text mb-4",children:"Memory Usage"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-tide-text-muted",children:"Current"}),e.jsx("span",{className:"text-tide-text font-mono text-sm",children:c?`${F(c.memory_usage)} / ${F(c.memory_limit)}`:"N/A"})]}),e.jsx("div",{className:"w-full bg-tide-surface-light rounded-full h-2",children:e.jsx("div",{className:"bg-accent h-2 rounded-full transition-all",style:{width:`${c?Math.min(c.memory_percent,100):0}%`}})})]})]}),e.jsxs("div",{onClick:()=>f("pids"),className:"bg-tide-surface/50 rounded-lg p-4 cursor-pointer hover:bg-tide-surface transition-colors border border-tide-border",children:[e.jsx("h3",{className:"text-lg font-semibold text-tide-text mb-4",children:"Processes"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-tide-text-muted",children:"PIDs"}),e.jsx("span",{className:"text-tide-text font-mono text-sm",children:c?c.pids:"N/A"})]}),e.jsx("div",{className:"text-tide-text-muted text-xs mt-2",children:"Active process count"})]})]}),e.jsxs("div",{onClick:()=>f("network"),className:"bg-tide-surface/50 rounded-lg p-4 cursor-pointer hover:bg-tide-surface transition-colors border border-tide-border",children:[e.jsx("h3",{className:"text-lg font-semibold text-tide-text mb-4",children:"Network I/O"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-tide-text-muted",children:"RX"}),e.jsx("span",{className:"text-tide-text font-mono text-sm",children:c?F(c.network_rx):"N/A"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-tide-text-muted",children:"TX"}),e.jsx("span",{className:"text-tide-text font-mono text-sm",children:c?F(c.network_tx):"N/A"})]})]})]}),e.jsxs("div",{onClick:()=>f("disk"),className:"bg-tide-surface/50 rounded-lg p-4 cursor-pointer hover:bg-tide-surface transition-colors border border-tide-border",children:[e.jsx("h3",{className:"text-lg font-semibold text-tide-text mb-4",children:"Block I/O"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-tide-text-muted",children:"Read"}),e.jsx("span",{className:"text-tide-text font-mono text-sm",children:c?F(c.block_read):"N/A"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-tide-text-muted",children:"Write"}),e.jsx("span",{className:"text-tide-text font-mono text-sm",children:c?F(c.block_write):"N/A"})]})]})]})]})),x==="logs"&&e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsxs("div",{className:"flex flex-col gap-3 mb-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold text-tide-text",children:"Container Logs"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("label",{className:"text-sm text-tide-text-muted",children:"Lines:"}),e.jsxs("select",{value:Me,onChange:t=>Jt(Number(t.target.value)),className:"bg-tide-surface text-tide-text text-sm rounded-lg px-3 py-1 border border-tide-border-light focus:outline-none focus:ring-2 focus:ring-primary",children:[e.jsx("option",{value:100,children:"100"}),e.jsx("option",{value:500,children:"500"}),e.jsx("option",{value:1e3,children:"1000"}),e.jsx("option",{value:1e4,children:"All"})]})]}),e.jsxs("button",{onClick:()=>Zt(!B),className:`flex items-center gap-2 px-3 py-1 rounded-lg text-sm transition-colors ${B?"bg-primary text-tide-text":"bg-tide-surface-light text-tide-text hover:bg-gray-500"}`,children:[e.jsx(N,{className:`w-4 h-4 ${B&&$e?"animate-spin":""}`}),B?"Live":"Paused"]}),e.jsx("button",{onClick:De,disabled:$e,className:"px-3 py-1 bg-tide-surface-light hover:bg-gray-500 text-tide-text rounded-lg text-sm transition-colors disabled:opacity-50",children:"Refresh"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(xa,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-tide-text-muted"}),e.jsx("input",{type:"text",placeholder:"Search logs...",value:ce,onChange:t=>es(t.target.value),className:"w-full pl-10 pr-3 py-2 bg-tide-surface border border-tide-border text-tide-text rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-primary"})]}),e.jsxs("button",{onClick:ea,disabled:!j,className:"flex items-center gap-2 px-3 py-2 bg-tide-surface-light hover:bg-gray-500 text-tide-text rounded-lg text-sm transition-colors disabled:opacity-50",title:"Copy to clipboard",children:[e.jsx(ma,{className:"w-4 h-4"}),"Copy"]}),e.jsxs("button",{onClick:ta,disabled:!j,className:"flex items-center gap-2 px-3 py-2 bg-tide-surface-light hover:bg-gray-500 text-tide-text rounded-lg text-sm transition-colors disabled:opacity-50",title:"Download as .txt file",children:[e.jsx(V,{className:"w-4 h-4"}),"Download"]}),e.jsxs("button",{onClick:()=>ts(!oe),className:`flex items-center gap-2 px-3 py-2 rounded-lg text-sm transition-colors ${oe?"bg-primary text-tide-text":"bg-tide-surface-light text-tide-text hover:bg-gray-500"}`,title:oe?"Auto-scroll enabled":"Auto-scroll disabled",children:[oe?e.jsx(ot,{className:"w-4 h-4"}):e.jsx(Gt,{className:"w-4 h-4"}),"Follow"]})]})]}),e.jsx("div",{className:"flex-1 bg-tide-surface rounded-lg p-4 overflow-auto font-mono text-xs",children:$e&&!j?e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsx(N,{className:"w-8 h-8 text-primary animate-spin"})}):j?e.jsx("div",{className:"whitespace-pre-wrap break-words",children:lt(j).split(`
`).map((t,s)=>e.jsx("div",{className:Js(t),children:t},s))}):e.jsx("div",{className:"flex items-center justify-center h-full text-tide-text-muted",children:"No logs available"})}),e.jsxs("div",{className:"mt-2 flex items-center justify-between text-xs text-tide-text-muted",children:[e.jsxs("span",{children:[B&&"Auto-refreshing every 2 seconds",!B&&"Auto-refresh paused",ce&&` â€¢ Filtering by: "${ce}"`]}),e.jsx("span",{children:oe&&"Auto-scroll enabled"})]})]}),x==="history"&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-tide-text",children:"Update History"}),e.jsxs("button",{onClick:pe,disabled:He,className:"px-3 py-1 bg-tide-surface-light hover:bg-gray-500 text-tide-text rounded-lg text-sm transition-colors disabled:opacity-50 flex items-center gap-2",children:[e.jsx(N,{className:`w-4 h-4 ${He?"animate-spin":""}`}),"Refresh"]})]}),He?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(N,{className:"w-8 h-8 text-primary animate-spin"})}):mt.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-tide-text-muted",children:[e.jsx(ua,{className:"w-12 h-12 mb-3 opacity-50"}),e.jsx("p",{children:"No update history available for this container"})]}):e.jsx("div",{className:"space-y-4",children:mt.map(t=>e.jsxs("div",{className:"bg-tide-surface/50 rounded-lg p-4 border border-tide-border border-l-4",style:{borderLeftColor:t.status==="completed"?"#10B981":t.status==="failed"?"#EF4444":t.status==="rolled_back"?"#F59E0B":"#6B7280"},children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[t.event_type==="dependency_ignore"&&e.jsx(pa,{className:"w-5 h-5 text-gray-400 flex-shrink-0"}),t.event_type==="dependency_unignore"&&e.jsx(ve,{className:"w-5 h-5 text-teal-400 flex-shrink-0"}),t.status==="completed"&&!t.event_type?.includes("dependency")&&e.jsx(Xt,{className:"w-5 h-5 text-green-500 flex-shrink-0"}),t.status==="failed"&&!t.event_type?.includes("dependency")&&e.jsx(ct,{className:"w-5 h-5 text-red-500 flex-shrink-0"}),t.status==="rolled_back"&&e.jsx(te,{className:"w-5 h-5 text-yellow-500 flex-shrink-0"}),e.jsxs("div",{children:[t.event_type==="dependency_ignore"||t.event_type==="dependency_unignore"?e.jsxs("div",{className:"text-tide-text font-medium",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-semibold",children:t.dependency_name}),e.jsx("span",{className:"font-mono text-xs text-tide-text-muted",children:t.from_tag}),e.jsx(Ae,{className:"w-3 h-3 text-tide-text-muted"}),e.jsx("span",{className:"font-mono text-xs text-primary",children:t.to_tag})]}),e.jsxs("p",{className:"text-xs text-tide-text-muted mt-1",children:[t.event_type==="dependency_ignore"?"Ignored":"Unignored"," â€¢ ",t.dependency_type==="dockerfile"&&"Dockerfile dependency",t.dependency_type==="http_server"&&"HTTP server",t.dependency_type==="app_dependency"&&"App dependency"]})]}):t.event_type==="dependency_update"?e.jsxs("div",{className:"text-tide-text font-medium",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-semibold",children:t.dependency_name}),e.jsx("span",{className:"font-mono text-xs text-tide-text-muted",children:t.from_tag}),e.jsx(Ae,{className:"w-3 h-3 text-tide-text-muted"}),e.jsx("span",{className:"font-mono text-xs text-primary",children:t.to_tag})]}),e.jsxs("p",{className:"text-xs text-tide-text-muted mt-1",children:[t.dependency_type==="dockerfile"&&"Dockerfile dependency",t.dependency_type==="http_server"&&"HTTP server",t.dependency_type==="app_dependency"&&"App dependency"]})]}):e.jsxs("div",{className:"flex items-center gap-2 text-tide-text font-medium",children:[e.jsx("span",{className:"font-mono text-sm",children:t.from_tag}),e.jsx(Ae,{className:"w-4 h-4 text-tide-text-muted"}),e.jsx("span",{className:"font-mono text-sm",children:t.to_tag})]}),e.jsx("p",{className:"text-xs text-tide-text-muted mt-1",children:ee(new Date(t.started_at),{addSuffix:!0})})]})]}),e.jsxs("div",{className:"flex flex-col items-end gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_a,{status:t.status,event_type:t.event_type||void 0}),t.event_type==="dependency_ignore"&&e.jsxs("button",{onClick:()=>Zs(t),className:"flex items-center gap-1.5 px-2.5 py-1 bg-teal-500/10 hover:bg-teal-500/20 text-teal-500 rounded-lg transition-colors text-xs",children:[e.jsx(N,{className:"w-3.5 h-3.5"}),"Unignore"]}),t.can_rollback&&(t.status==="completed"||t.status==="success")&&!t.rolled_back_at&&!t.event_type?.includes("dependency")&&e.jsxs("button",{onClick:()=>Qs(t.id),className:"flex items-center gap-1.5 px-2.5 py-1 bg-yellow-500/10 hover:bg-yellow-500/20 text-yellow-500 rounded-lg transition-colors text-xs",children:[e.jsx(ha,{className:"w-3.5 h-3.5"}),"Rollback"]})]}),t.duration_seconds!==null&&e.jsx("span",{className:"text-xs text-tide-text-muted",children:t.duration_seconds<60?`${t.duration_seconds}s`:`${Math.floor(t.duration_seconds/60)}m ${t.duration_seconds%60}s`})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm mt-3 pt-3 border-t border-tide-border-light",children:[t.reason_summary&&e.jsxs("div",{className:"col-span-2",children:[e.jsx("span",{className:"text-tide-text-muted",children:"Reason:"}),e.jsx("span",{className:"text-tide-text ml-2",children:t.reason_summary})]}),t.triggered_by&&e.jsxs("div",{children:[e.jsx("span",{className:"text-tide-text-muted",children:"Triggered by:"}),e.jsx("span",{className:"text-tide-text ml-2",children:t.triggered_by})]}),t.update_type&&e.jsxs("div",{children:[e.jsx("span",{className:"text-tide-text-muted",children:"Type:"}),e.jsx("span",{className:"text-tide-text ml-2",children:t.update_type})]}),t.cves_fixed&&t.cves_fixed.length>0&&e.jsxs("div",{className:"col-span-2",children:[e.jsx("span",{className:"text-tide-text-muted",children:"CVEs Fixed:"}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:t.cves_fixed.map(s=>e.jsx("span",{className:"px-2 py-0.5 bg-blue-500/20 text-blue-400 rounded text-xs font-mono",children:s},s))})]}),t.error_message&&e.jsxs("div",{className:"col-span-2",children:[e.jsx("span",{className:"text-tide-text-muted",children:"Error:"}),e.jsx("p",{className:"text-red-400 text-xs mt-1 font-mono bg-red-500/10 p-2 rounded",children:t.error_message})]}),t.rolled_back_at&&e.jsxs("div",{className:"col-span-2",children:[e.jsx("span",{className:"text-tide-text-muted",children:"Rolled back:"}),e.jsx("span",{className:"text-yellow-400 ml-2",children:ee(new Date(t.rolled_back_at),{addSuffix:!0})})]})]})]},t.id))})]}),x==="dependencies"&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex gap-2 mb-6 border-b border-tide-border",children:[e.jsxs("button",{onClick:()=>qe("infra"),className:`px-4 py-3 font-medium transition-colors relative ${v==="infra"?"text-primary":"text-tide-text-muted hover:text-tide-text"}`,children:["HTTP Server & Dockerfile",v==="infra"&&e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-primary"})]}),e.jsxs("button",{onClick:()=>qe("dependencies"),className:`px-4 py-3 font-medium transition-colors relative ${v==="dependencies"?"text-primary":"text-tide-text-muted hover:text-tide-text"}`,children:["Dependencies",v==="dependencies"&&e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-primary"})]}),e.jsxs("button",{onClick:()=>qe("dev-dependencies"),className:`px-4 py-3 font-medium transition-colors relative ${v==="dev-dependencies"?"text-primary":"text-tide-text-muted hover:text-tide-text"}`,children:["Dev Dependencies",v==="dev-dependencies"&&e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-primary"})]})]}),e.jsxs(e.Fragment,{children:[v==="infra"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"mb-4 flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold text-tide-text",children:"HTTP Servers"}),e.jsx("p",{className:"text-sm text-tide-text-muted mt-1",children:"Detected HTTP servers running in the container with version information."})]}),e.jsxs("button",{onClick:async()=>{Se(!0);try{await l.containers.scanHttpServers(a.id),await W(),d.success("HTTP servers rescanned successfully")}catch{d.error("Failed to rescan HTTP servers")}finally{Se(!1)}},disabled:Ye,className:"px-3 py-1.5 bg-primary hover:bg-primary-dark text-tide-text rounded-lg font-medium transition-colors disabled:opacity-50 flex items-center gap-2 text-sm",children:[e.jsx(N,{size:14,className:Ye?"animate-spin":""}),"Rescan"]})]}),Ye?e.jsxs("div",{className:"text-center py-12 bg-tide-surface border border-tide-border rounded-lg",children:[e.jsx(N,{className:"animate-spin mx-auto mb-4 text-primary",size:48}),e.jsx("p",{className:"text-tide-text-muted",children:"Scanning for HTTP servers..."})]}):q&&q.servers.length>0?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{className:"bg-tide-surface rounded-lg p-4 border border-tide-border",children:[e.jsx("p",{className:"text-sm text-tide-text-muted",children:"Total Servers"}),e.jsx("p",{className:"text-2xl font-bold text-tide-text mt-1",children:q.total})]}),e.jsxs("div",{className:"bg-tide-surface rounded-lg p-4 border border-tide-border",children:[e.jsx("p",{className:"text-sm text-tide-text-muted",children:"Updates Available"}),e.jsx("p",{className:"text-2xl font-bold text-accent mt-1",children:q.with_updates})]})]}),e.jsx("div",{className:"space-y-2",children:q.servers.map((t,s)=>{const i={critical:"bg-red-500/20 text-red-400 border-red-500/30",high:"bg-orange-500/20 text-orange-400 border-orange-500/30",medium:"bg-yellow-500/20 text-yellow-400 border-yellow-500/30",low:"bg-blue-500/20 text-blue-400 border-blue-500/30",info:"bg-gray-500/20 text-tide-text-muted border-gray-500/30"};return e.jsx("div",{className:"bg-tide-surface rounded-lg p-4 border border-tide-border",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Yt,{size:20,className:"text-primary"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-tide-text font-medium capitalize",children:t.name}),e.jsxs("p",{className:"text-sm text-tide-text-muted",children:[t.current_version?`v${t.current_version}`:"Version unknown",t.latest_version&&t.update_available&&e.jsxs("span",{className:"text-accent ml-2",children:["â†’ v",t.latest_version]})]}),e.jsxs("p",{className:"text-xs text-tide-text-muted mt-1",children:["Detected via ",t.detection_method==="version_command"?"version command":"process scan"]})]})]})}),e.jsxs("div",{className:"flex items-center gap-2",children:[!t.ignored&&t.update_available&&e.jsxs("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${i[t.severity]}`,children:[t.severity==="critical"&&"Critical Update",t.severity==="high"&&"High Priority",t.severity==="medium"&&"Major Update",t.severity==="low"&&"Minor Update",t.severity==="info"&&"Patch Update"]}),!t.ignored&&!t.update_available&&t.current_version&&e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-500/20 text-green-400 border border-green-500/30",children:"Up to date"}),t.ignored&&e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-500/20 text-gray-400 border border-gray-500/30",children:"Up to date"}),!t.ignored&&t.update_available&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>rt(t,"http_server"),className:"px-2.5 py-1.5 bg-tide-surface hover:bg-tide-surface-light text-tide-text rounded-lg font-medium transition-colors flex items-center gap-1.5 text-xs border border-tide-border",title:"Preview update changes",children:[e.jsx(ve,{size:14}),"Preview"]}),e.jsxs("button",{onClick:()=>dt(t,"http_server"),className:"px-2.5 py-1.5 bg-primary hover:bg-primary/90 text-white rounded-lg font-medium transition-colors flex items-center gap-1.5 text-xs border border-primary",title:"Update HTTP server immediately",children:[e.jsx(V,{size:14}),"Update"]}),e.jsxs("button",{onClick:()=>st(t,"http_server"),className:"px-2.5 py-1.5 bg-primary/20 hover:bg-primary/30 text-primary rounded-lg font-medium transition-colors flex items-center gap-1.5 text-xs border border-primary/30",title:"Ignore this update",children:[e.jsx(de,{size:14}),"Ignore"]})]}),t.ignored&&e.jsxs("button",{onClick:()=>at(t,"http_server"),className:"px-2.5 py-1.5 bg-tide-surface hover:bg-tide-surface-light text-tide-text rounded-lg font-medium transition-colors flex items-center gap-1.5 text-xs border border-tide-border",title:"Unignore this update",children:[e.jsx(Fe,{size:14}),"Unignore"]}),e.jsxs("button",{onClick:()=>it(t,"http_server"),className:"px-2.5 py-1.5 bg-orange-500/20 hover:bg-orange-500/30 text-orange-400 rounded-lg font-medium transition-colors flex items-center gap-1.5 text-xs border border-orange-500/30",title:"Rollback to a previous version",children:[e.jsx(ne,{size:14}),"Rollback"]})]})]})},`${t.name}-${s}`)})}),q.last_scan&&e.jsxs("div",{className:"text-sm text-tide-text-muted text-center mt-4",children:["Last scanned: ",ee(new Date(q.last_scan),{addSuffix:!0})]})]}):e.jsxs("div",{className:"text-center py-12 bg-tide-surface border border-tide-border rounded-lg",children:[e.jsx(Yt,{className:"mx-auto mb-4 text-gray-600",size:48}),e.jsx("p",{className:"text-tide-text-muted",children:"No HTTP servers detected"}),e.jsx("p",{className:"text-sm text-tide-text-muted mt-1",children:"Container may not be running or doesn't contain common HTTP servers"})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"mb-4 flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold text-tide-text",children:"Dockerfile Dependencies"}),e.jsx("p",{className:"text-sm text-tide-text-muted mt-1",children:"Base and build images used in your Dockerfile. Dependencies are scanned automatically when you open this tab."})]}),e.jsxs("button",{onClick:async()=>{Ce(!0);try{await l.containers.scanDockerfileDependencies(a.id),await O(),d.success("Dockerfile dependencies rescanned successfully")}catch{d.error("Failed to rescan Dockerfile dependencies")}finally{Ce(!1)}},disabled:Xe,className:"px-3 py-1.5 bg-primary hover:bg-primary-dark text-tide-text rounded-lg font-medium transition-colors disabled:opacity-50 flex items-center gap-2 text-sm",children:[e.jsx(N,{size:14,className:Xe?"animate-spin":""}),"Rescan"]})]}),L&&L.dependencies.length>0&&e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-tide-surface rounded-lg p-4 border border-tide-border",children:[e.jsx("p",{className:"text-sm text-tide-text-muted",children:"Total Images"}),e.jsx("p",{className:"text-2xl font-bold text-tide-text mt-1",children:L.total})]}),e.jsxs("div",{className:"bg-tide-surface rounded-lg p-4 border border-tide-border",children:[e.jsx("p",{className:"text-sm text-tide-text-muted",children:"Updates Available"}),e.jsx("p",{className:"text-2xl font-bold text-accent mt-1",children:L.with_updates})]})]}),Xe?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(N,{className:"animate-spin mx-auto mb-4 text-primary",size:48}),e.jsx("p",{className:"text-tide-text-muted",children:"Loading Dockerfile dependencies..."})]}):L&&L.dependencies.length>0?e.jsx("div",{className:"space-y-2",children:[...L.dependencies].sort((t,s)=>t.image_name.localeCompare(s.image_name)).map(t=>e.jsx("div",{className:"bg-tide-surface rounded-lg p-4 border border-tide-border",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ba,{size:20,className:"text-primary"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-tide-text font-medium",children:t.image_name}),e.jsxs("p",{className:"text-sm text-tide-text-muted",children:[t.dependency_type==="base_image"?"Base Image":"Build Image",t.stage_name&&` â€¢ Stage: ${t.stage_name}`," â€¢ ","Current: ",t.current_tag,t.latest_tag&&t.update_available&&e.jsxs("span",{className:"text-accent ml-2",children:["â†’ ",t.latest_tag]})]}),e.jsxs("p",{className:"text-xs text-tide-text-muted mt-1",children:[t.dockerfile_path,t.line_number&&` (line ${t.line_number})`]})]})]})}),e.jsxs("div",{className:"flex items-center gap-2",children:[!t.ignored&&t.update_available&&(()=>{const s={critical:"bg-red-500/20 text-red-400 border-red-500/30",high:"bg-orange-500/20 text-orange-400 border-orange-500/30",medium:"bg-yellow-500/20 text-yellow-400 border-yellow-500/30",low:"bg-blue-500/20 text-blue-400 border-blue-500/30",info:"bg-gray-500/20 text-tide-text-muted border-gray-500/30"};return e.jsxs("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${s[t.severity]||s.info}`,children:[t.severity==="critical"&&"Critical Update",t.severity==="high"&&"High Priority",t.severity==="medium"&&"Major Update",t.severity==="low"&&"Minor Update",t.severity==="info"&&"Patch Update"]})})(),!t.ignored&&!t.update_available&&t.last_checked&&e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-500/20 text-green-400 border border-green-500/30",children:"Up to date"}),t.ignored&&e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-500/20 text-gray-400 border border-gray-500/30",children:"Up to date"}),!t.ignored&&t.update_available&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>rt(t,"dockerfile"),className:"px-2.5 py-1.5 bg-tide-surface hover:bg-tide-surface-light text-tide-text rounded-lg font-medium transition-colors flex items-center gap-1.5 text-xs border border-tide-border",title:"Preview update changes",children:[e.jsx(ve,{size:14}),"Preview"]}),e.jsxs("button",{onClick:()=>dt(t,"dockerfile"),className:"px-2.5 py-1.5 bg-primary hover:bg-primary/90 text-white rounded-lg font-medium transition-colors flex items-center gap-1.5 text-xs border border-primary",title:"Update Dockerfile immediately",children:[e.jsx(V,{size:14}),"Update"]}),e.jsxs("button",{onClick:()=>st(t,"dockerfile"),className:"px-2.5 py-1.5 bg-primary/20 hover:bg-primary/30 text-primary rounded-lg font-medium transition-colors flex items-center gap-1.5 text-xs border border-primary/30",title:"Ignore this update",children:[e.jsx(de,{size:14}),"Ignore"]})]}),t.ignored&&e.jsxs("button",{onClick:()=>at(t,"dockerfile"),className:"px-2.5 py-1.5 bg-tide-surface hover:bg-tide-surface-light text-tide-text rounded-lg font-medium transition-colors flex items-center gap-1.5 text-xs border border-tide-border",title:"Unignore this update",children:[e.jsx(Fe,{size:14}),"Unignore"]}),e.jsxs("button",{onClick:()=>it(t,"dockerfile"),className:"px-2.5 py-1.5 bg-orange-500/20 hover:bg-orange-500/30 text-orange-400 rounded-lg font-medium transition-colors flex items-center gap-1.5 text-xs border border-orange-500/30",title:"Rollback to a previous version",children:[e.jsx(ne,{size:14}),"Rollback"]})]})]})},t.id))}):e.jsxs("div",{className:"text-center py-12 bg-tide-surface border border-tide-border rounded-lg",children:[e.jsx(Re,{className:"mx-auto mb-4 text-gray-600",size:48}),e.jsx("p",{className:"text-tide-text-muted",children:"No Dockerfile found"}),e.jsx("p",{className:"text-sm text-tide-text-muted mt-1",children:'Click "Scan Dockerfile" to detect base and build images if a Dockerfile exists'})]}),L?.last_scan&&e.jsxs("div",{className:"text-sm text-tide-text-muted text-center mt-4",children:["Last scanned: ",ee(new Date(L.last_scan),{addSuffix:!0})]})]})]}),v==="dependencies"&&e.jsxs("div",{children:[e.jsxs("div",{className:"mb-4 flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold text-tide-text",children:"Production Dependencies"}),e.jsx("p",{className:"text-sm text-tide-text-muted mt-1",children:"Track production dependencies used by your application and available updates."})]}),e.jsxs("button",{onClick:async()=>{_e(!0);try{await l.containers.scanAppDependencies(a.id),await H(),d.success("Dependencies rescanned successfully")}catch{d.error("Failed to rescan dependencies")}finally{_e(!1)}},disabled:ke||Ve,className:"px-3 py-1.5 bg-primary hover:bg-primary-dark text-tide-text rounded-lg font-medium transition-colors disabled:opacity-50 flex items-center gap-2 text-sm",children:[e.jsx(N,{size:14,className:ke?"animate-spin":""}),"Rescan"]})]}),Wt("production")]}),v==="dev-dependencies"&&e.jsxs("div",{children:[e.jsxs("div",{className:"mb-4 flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold text-tide-text",children:"Development Dependencies"}),e.jsx("p",{className:"text-sm text-tide-text-muted mt-1",children:"Track development dependencies used during build and test processes."})]}),e.jsxs("button",{onClick:async()=>{_e(!0);try{await l.containers.scanAppDependencies(a.id),await H(),d.success("Dependencies rescanned successfully")}catch{d.error("Failed to rescan dependencies")}finally{_e(!1)}},disabled:ke||Ve,className:"px-3 py-1.5 bg-primary hover:bg-primary-dark text-tide-text rounded-lg font-medium transition-colors disabled:opacity-50 flex items-center gap-2 text-sm",children:[e.jsx(N,{size:14,className:ke?"animate-spin":""}),"Rescan"]})]}),Wt("development")]})]})]}),x==="settings"&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-tide-text mb-6",children:"Container Settings"}),js&&e.jsx("div",{className:"bg-tide-surface/50 rounded-lg p-6 border border-tide-border-light mb-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ga,{size:20,className:a.is_my_project?"fill-primary text-primary":"text-tide-text-muted"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-base font-semibold text-tide-text",children:"My Project"}),e.jsx("p",{className:"text-sm text-tide-text-muted mt-1",children:"Mark this as your own project to group it separately and track application dependencies. Dev containers are auto-detected from your projects directory."})]})]}),e.jsx("button",{onClick:Ls,disabled:$,className:`px-4 py-2 rounded-lg font-medium transition-colors ${a.is_my_project?"bg-primary text-tide-text hover:bg-primary/80":"bg-tide-surface-light text-tide-text hover:bg-gray-500"} disabled:opacity-50`,children:a.is_my_project?"Remove from My Projects":"Add to My Projects"})]})}),e.jsxs("div",{className:"columns-1 xl:columns-2 gap-6 space-y-6 xl:space-y-0",style:{columnGap:"1.5rem"},children:[e.jsxs("div",{className:"bg-tide-surface/50 rounded-lg p-6 break-inside-avoid mb-6 border border-tide-border",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center bg-gray-500/10 border border-gray-500/20",children:e.jsx(Fe,{className:"w-5 h-5 text-tide-text-muted"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-base font-semibold text-tide-text",children:"Auto-Restart"}),e.jsx("p",{className:"text-sm text-tide-text-muted",children:re?M?.is_paused?"Enabled (Paused)":"Enabled":"Disabled"})]})]}),e.jsx("button",{onClick:Us,disabled:$,className:"px-4 py-2 bg-primary text-tide-text rounded-lg hover:bg-primary/80 transition-colors disabled:opacity-50",children:re?"Disable":"Enable"})]}),re&&!ls&&M&&e.jsxs("div",{className:"mt-4 space-y-4 pt-4 border-t border-tide-border-light",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium text-tide-text mb-3",children:"Current State"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"bg-tide-surface/50 rounded-lg p-3",children:[e.jsx("div",{className:"text-xs text-tide-text-muted mb-1",children:"Consecutive Failures"}),e.jsx("div",{className:`text-lg font-semibold ${M.consecutive_failures>0?"text-red-400":"text-green-400"}`,children:M.consecutive_failures})]}),e.jsxs("div",{className:"bg-tide-surface/50 rounded-lg p-3",children:[e.jsx("div",{className:"text-xs text-tide-text-muted mb-1",children:"Total Restarts"}),e.jsx("div",{className:"text-lg font-semibold text-tide-text",children:M.total_restarts})]}),e.jsxs("div",{className:"bg-tide-surface/50 rounded-lg p-3",children:[e.jsx("div",{className:"text-xs text-tide-text-muted mb-1",children:"Current Backoff"}),e.jsx("div",{className:"text-lg font-semibold text-tide-text",children:nt(M.current_backoff_seconds)})]}),e.jsxs("div",{className:"bg-tide-surface/50 rounded-lg p-3",children:[e.jsx("div",{className:"text-xs text-tide-text-muted mb-1",children:"Max Retries"}),e.jsx("div",{className:`text-lg font-semibold ${M.max_retries_reached?"text-red-400":"text-tide-text"}`,children:M.max_retries_reached?"Reached":"Not Reached"})]})]})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium text-tide-text mb-3",children:"Configuration"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-tide-text-muted mb-1",children:"Backoff Strategy"}),e.jsxs("select",{value:h.backoff_strategy,onChange:t=>E({...h,backoff_strategy:t.target.value}),className:"w-full px-3 py-2 bg-tide-surface border border-tide-border rounded-lg text-tide-text text-sm focus:outline-none focus:ring-2 focus:ring-primary",children:[e.jsx("option",{value:"exponential",children:"Exponential"}),e.jsx("option",{value:"linear",children:"Linear"}),e.jsx("option",{value:"fixed",children:"Fixed"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs text-tide-text-muted mb-1",children:["Max Attempts (",h.max_attempts,")"]}),e.jsx("input",{type:"range",min:"1",max:"100",value:h.max_attempts,onChange:t=>E({...h,max_attempts:parseInt(t.target.value)}),className:"w-full accent-teal-500"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs text-tide-text-muted mb-1",children:["Base Delay (",h.base_delay_seconds,"s)"]}),e.jsx("input",{type:"range",min:"1",max:"60",value:h.base_delay_seconds,onChange:t=>E({...h,base_delay_seconds:parseFloat(t.target.value)}),className:"w-full accent-teal-500"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs text-tide-text-muted mb-1",children:["Max Delay (",nt(h.max_delay_seconds),")"]}),e.jsx("input",{type:"range",min:"60",max:"3600",value:h.max_delay_seconds,onChange:t=>E({...h,max_delay_seconds:parseFloat(t.target.value)}),className:"w-full accent-teal-500"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs text-tide-text-muted mb-1",children:["Success Window (",nt(h.success_window_seconds),")"]}),e.jsx("input",{type:"range",min:"60",max:"1800",value:h.success_window_seconds,onChange:t=>E({...h,success_window_seconds:parseInt(t.target.value)}),className:"w-full accent-teal-500"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-tide-text",children:"Health Check Enabled"}),e.jsx("button",{onClick:()=>E({...h,health_check_enabled:!h.health_check_enabled}),className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${h.health_check_enabled?"bg-primary":"bg-tide-surface-light"}`,children:e.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${h.health_check_enabled?"translate-x-6":"translate-x-1"}`})})]}),h.health_check_enabled&&e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs text-tide-text-muted mb-1",children:["Health Check Timeout (",h.health_check_timeout,"s)"]}),e.jsx("input",{type:"number",min:"10",max:"300",value:h.health_check_timeout,onChange:t=>E({...h,health_check_timeout:parseInt(t.target.value)}),className:"w-full px-3 py-2 bg-tide-surface border border-tide-border rounded-lg text-tide-text text-sm"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-tide-text",children:"Rollback on Health Fail"}),e.jsx("button",{onClick:()=>E({...h,rollback_on_health_fail:!h.rollback_on_health_fail}),className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${h.rollback_on_health_fail?"bg-primary":"bg-tide-surface-light"}`,children:e.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${h.rollback_on_health_fail?"translate-x-6":"translate-x-1"}`})})]}),e.jsx("button",{onClick:Rs,className:"w-full px-4 py-2 bg-primary text-tide-text rounded-lg hover:bg-primary/80 transition-colors",children:"Save Configuration"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:Ps,disabled:M.consecutive_failures===0,className:"flex-1 px-3 py-2 bg-tide-surface text-tide-text rounded-lg hover:bg-tide-surface-light transition-colors disabled:opacity-50 text-sm flex items-center justify-center gap-2",children:[e.jsx(N,{className:"w-4 h-4"}),"Reset State"]}),M.is_paused?e.jsxs("button",{onClick:Ms,className:"flex-1 px-3 py-2 bg-green-600 text-tide-text rounded-lg hover:bg-green-700 transition-colors text-sm flex items-center justify-center gap-2",children:[e.jsx(fa,{className:"w-4 h-4"}),"Resume"]}):e.jsxs("button",{onClick:$s,className:"flex-1 px-3 py-2 bg-yellow-600 text-tide-text rounded-lg hover:bg-yellow-700 transition-colors text-sm flex items-center justify-center gap-2",children:[e.jsx(ya,{className:"w-4 h-4"}),"Pause"]})]})]})]}),e.jsxs("div",{className:"bg-tide-surface/50 rounded-lg p-6",children:[e.jsx("h4",{className:"text-base font-semibold text-tide-text mb-3",children:"Update Policy"}),e.jsx("p",{className:"text-sm text-tide-text-muted mb-4",children:"Choose how updates should be handled for this container."}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:[{value:"patch-only",label:"Patch Only",desc:"Auto-apply patch updates (1.2.3 â†’ 1.2.4)",icon:Xt},{value:"minor-and-patch",label:"Minor + Patch",desc:"Auto-apply minor/patch (no breaking)",icon:Kt},{value:"auto",label:"Auto (âš ï¸ All)",desc:"ALL updates (including breaking)",icon:te},{value:"security",label:"Security Only",desc:"Auto-apply security updates",icon:ja},{value:"manual",label:"Manual",desc:"Require manual approval",icon:va},{value:"disabled",label:"Disabled",desc:"No automatic checks",icon:de}].map(t=>e.jsxs("button",{onClick:()=>Ns(t.value),disabled:$,className:`p-4 rounded-lg border-2 transition-all text-left ${Te===t.value?"border-primary bg-primary/10":"border-tide-border bg-tide-surface hover:border-tide-border-light"}`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(t.icon,{className:`w-5 h-5 ${Te===t.value?"text-primary":"text-tide-text-muted"}`}),e.jsx("span",{className:`font-medium ${Te===t.value,"text-tide-text"}`,children:t.label})]}),e.jsx("p",{className:"text-xs text-tide-text-muted",children:t.desc})]},t.value))})]}),e.jsxs("div",{className:"bg-tide-surface/50 rounded-lg p-6",children:[e.jsx("h4",{className:"text-base font-semibold text-tide-text mb-3",children:"Version Scope"}),e.jsx("p",{className:"text-sm text-tide-text-muted mb-4",children:"Control which version changes are allowed during updates."}),e.jsx("div",{className:"grid grid-cols-3 gap-3",children:[{value:"patch",label:"Patch",desc:"Only patch updates (1.2.3 â†’ 1.2.4)"},{value:"minor",label:"Minor",desc:"Minor + patch (1.2.x â†’ 1.3.x)"},{value:"major",label:"Major",desc:"All updates (1.x.x â†’ 2.x.x)"}].map(t=>e.jsxs("button",{onClick:()=>ws(t.value),disabled:$,className:`p-4 rounded-lg border-2 transition-all text-left ${Ee===t.value?"border-primary bg-primary/10":"border-tide-border bg-tide-surface hover:border-tide-border-light"}`,children:[e.jsx("div",{className:"mb-2",children:e.jsx("span",{className:`font-medium ${Ee===t.value,"text-tide-text"}`,children:t.label})}),e.jsx("p",{className:"text-xs text-tide-text-muted",children:t.desc})]},t.value))})]}),e.jsxs("div",{className:"bg-tide-surface/50 rounded-lg p-6",children:[e.jsx("h4",{className:"text-base font-semibold text-tide-text mb-3",children:"Pre-release Versions"}),e.jsx("p",{className:"text-sm text-tide-text-muted mb-4",children:"Control whether to include pre-release tags when checking for updates."}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-tide-text",children:"Include Pre-releases"}),e.jsx("p",{className:"text-xs text-tide-text-muted mt-1",children:Ne?"Including pre-releases":"Stable releases only"})]}),e.jsx("button",{onClick:ks,disabled:$,className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${Ne?"bg-primary":"bg-tide-surface-light"}`,children:e.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${Ne?"translate-x-6":"translate-x-1"}`})})]})]}),e.jsxs("div",{className:"bg-tide-surface/50 rounded-lg p-6",children:[e.jsx("h4",{className:"text-base font-semibold text-tide-text mb-3",children:"Vulnerability Scanning"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-tide-text",children:"VulnForge Integration"}),e.jsx("p",{className:"text-xs text-tide-text-muted mt-1",children:"Scan for security vulnerabilities"})]}),e.jsx("div",{className:`px-3 py-1.5 rounded ${ht?"bg-green-500/10 text-green-500":"bg-gray-500/10 text-tide-text-muted"}`,children:ht?"Enabled":"Disabled"})]})]}),e.jsxs("div",{className:"bg-tide-surface/50 rounded-lg p-6 break-inside-avoid mb-6 border border-tide-border",children:[e.jsx("h4",{className:"text-base font-semibold text-tide-text mb-3",children:"Health Check"}),e.jsx("p",{className:"text-sm text-tide-text-muted mb-3",children:"Control how TideWatch validates this container after updates."}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs uppercase tracking-wide text-tide-text-muted mb-1 block",children:"Health Check URL"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{placeholder:"http://container:port/health",className:"flex-1 px-3 py-2 bg-tide-surface border border-tide-border text-tide-text placeholder-gray-500 rounded-lg",type:"text",value:Le,onChange:t=>bt(t.target.value)}),e.jsx("button",{onClick:Fs,className:"px-3 py-2 bg-tide-surface hover:bg-tide-surface-light text-tide-text rounded-lg flex items-center gap-1",title:"Auto-fill from compose labels",children:e.jsx(qt,{className:"w-4 h-4"})}),e.jsx("button",{onClick:Cs,disabled:$,className:"px-4 py-2 bg-tide-surface-light hover:bg-gray-500 text-tide-text rounded-lg disabled:opacity-50",children:"Save"})]}),e.jsx("p",{className:"text-xs text-tide-text-muted mt-1",children:"HTTP endpoint to check container health after updates."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs uppercase tracking-wide text-tide-text-muted mb-1 block",children:"Method"}),e.jsxs("select",{value:ds,onChange:t=>_s(t.target.value),disabled:$,className:"w-full px-3 py-2 bg-tide-surface border border-tide-border text-tide-text rounded-lg focus:outline-none focus:ring-2 focus:ring-primary disabled:opacity-50",children:[e.jsx("option",{value:"auto",children:"Auto (HTTP if URL, otherwise Docker)"}),e.jsx("option",{value:"http",children:"HTTP only (always hit the URL)"}),e.jsx("option",{value:"docker",children:"Docker inspect only"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs uppercase tracking-wide text-tide-text-muted mb-1 block",children:"Auth Token"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{placeholder:"apikey=XYZ or token:Bearer ...",className:"flex-1 px-3 py-2 bg-tide-surface border border-tide-border text-tide-text placeholder-gray-500 rounded-lg",type:"password",value:Ie,onChange:t=>gt(t.target.value)}),e.jsx("button",{onClick:Ss,disabled:!Ie||$,className:"px-4 py-2 bg-tide-surface-light hover:bg-gray-500 text-tide-text rounded-lg disabled:opacity-50 disabled:cursor-not-allowed",children:"Save"})]}),e.jsx("p",{className:"text-xs text-tide-text-muted mt-1",children:a.health_check_has_auth?"Auth token configured":"No auth token stored"})]})]})]}),e.jsxs("div",{className:"bg-tide-surface/50 rounded-lg p-6 break-inside-avoid mb-6 border border-tide-border",children:[e.jsx("h4",{className:"text-base font-semibold text-tide-text mb-3",children:"Release Source"}),e.jsx("p",{className:"text-sm text-tide-text-muted mb-3",children:"Provide a GitHub repo or changelog URL for release notes."}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{placeholder:"github:user/repo or https://example.com/changelog",className:"flex-1 px-3 py-2 bg-tide-surface border border-tide-border text-tide-text placeholder-gray-500 rounded-lg",type:"text",value:ze,onChange:t=>ft(t.target.value)}),e.jsx("button",{onClick:As,className:"px-3 py-2 bg-tide-surface hover:bg-tide-surface-light text-tide-text rounded-lg flex items-center gap-1",title:"Auto-detect from image name",children:e.jsx(qt,{className:"w-4 h-4"})}),e.jsx("button",{onClick:Ds,disabled:$,className:"px-4 py-2 bg-tide-surface-light hover:bg-gray-500 text-tide-text rounded-lg disabled:opacity-50",children:"Save"})]}),e.jsx("p",{className:"text-xs text-tide-text-muted mt-2",children:"Examples: github:linuxserver/docker-sonarr, https://lscr.io/changelog/sonarr"})]}),e.jsxs("div",{className:"bg-tide-surface/50 rounded-lg p-6 break-inside-avoid mb-6 border border-tide-border",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center bg-gray-500/10 border border-gray-500/20",children:e.jsx(Na,{className:"w-5 h-5 text-tide-text-muted"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-base font-semibold text-tide-text",children:"Dependency Management"}),e.jsx("p",{className:"text-sm text-tide-text-muted",children:"Define update order based on container dependencies"})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-xs uppercase tracking-wide text-tide-text-muted mb-2",children:"This container depends on:"}),xe.length>0?e.jsx("div",{className:"flex flex-wrap gap-2 mb-3",children:xe.map(t=>e.jsxs("span",{className:"px-3 py-1 bg-primary/20 text-primary rounded-lg text-sm flex items-center gap-2",children:[t,e.jsx("button",{onClick:()=>Ts(t),className:"hover:text-red-400 transition-colors",children:e.jsx(K,{className:"w-3 h-3"})})]},t))}):e.jsx("p",{className:"text-tide-text-muted text-sm mb-3",children:"No dependencies configured. This container can update independently."})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-xs uppercase tracking-wide text-tide-text-muted mb-2",children:"Add Dependency"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("select",{value:we,onChange:t=>wt(t.target.value),className:"flex-1 px-3 py-2 bg-tide-surface border border-tide-border text-tide-text rounded-lg focus:outline-none focus:ring-2 focus:ring-primary",children:[e.jsx("option",{value:"",children:"Select container..."}),os.filter(t=>!xe.includes(t.name)).map(t=>e.jsx("option",{value:t.name,children:t.name},t.id))]}),e.jsx("button",{onClick:Hs,disabled:!we,className:"px-4 py-2 bg-primary hover:bg-primary/80 text-tide-text rounded-lg transition-colors disabled:opacity-50",children:"Add"})]}),e.jsx("p",{className:"text-xs text-tide-text-muted mt-2",children:"Dependencies will be updated before this container"})]}),e.jsxs("div",{className:"pt-4 border-t border-tide-border-light",children:[e.jsx("label",{className:"block text-xs uppercase tracking-wide text-tide-text-muted mb-2",children:"Containers that depend on this one:"}),Nt.length>0?e.jsx("div",{className:"flex flex-wrap gap-2",children:Nt.map(t=>e.jsx("span",{className:"px-3 py-1 bg-tide-surface-light/50 text-tide-text rounded-lg text-sm",children:t},t))}):e.jsx("p",{className:"text-tide-text-muted text-sm",children:"No containers depend on this one"})]})]}),e.jsxs("div",{className:"bg-tide-surface/50 rounded-lg p-6 break-inside-avoid mb-6 border border-tide-border",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center bg-gray-500/10 border border-gray-500/20",children:e.jsx(wa,{className:"w-5 h-5 text-tide-text-muted"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-base font-semibold text-tide-text",children:"Update Window"}),e.jsx("p",{className:"text-sm text-tide-text-muted",children:"Restrict updates to specific time periods"})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-xs uppercase tracking-wide text-tide-text-muted mb-2",children:"Allowed Update Window"}),kt?e.jsxs("div",{className:"bg-tide-surface border border-tide-border rounded-lg p-3 mb-2 flex items-center justify-between",children:[e.jsx("span",{className:"text-tide-text font-mono text-sm",children:kt}),e.jsx("button",{onClick:()=>{_t(""),ie("")},className:"text-red-400 hover:text-red-300 text-sm transition-colors",children:"Clear"})]}):e.jsx("p",{className:"text-tide-text-muted text-sm mb-2",children:"No restrictions - updates allowed anytime"})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"block text-xs uppercase tracking-wide text-tide-text-muted mb-1",children:"Set Update Window"}),e.jsx("input",{type:"text",placeholder:"HH:MM-HH:MM or Days:HH:MM-HH:MM",className:"w-full px-3 py-2 bg-tide-surface border border-tide-border text-tide-text placeholder-gray-500 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary",value:We,onChange:t=>ie(t.target.value)})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-xs uppercase tracking-wide text-tide-text-muted mb-2",children:"Quick Presets"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("button",{onClick:()=>ie("02:00-06:00"),className:"px-3 py-2 bg-tide-surface hover:bg-tide-surface border border-tide-border text-tide-text rounded-lg text-sm text-left transition-colors",children:[e.jsx("div",{className:"font-medium",children:"Night Window"}),e.jsx("div",{className:"text-xs text-tide-text-muted",children:"02:00-06:00 daily"})]}),e.jsxs("button",{onClick:()=>ie("Sat,Sun:00:00-23:59"),className:"px-3 py-2 bg-tide-surface hover:bg-tide-surface border border-tide-border text-tide-text rounded-lg text-sm text-left transition-colors",children:[e.jsx("div",{className:"font-medium",children:"Weekends Only"}),e.jsx("div",{className:"text-xs text-tide-text-muted",children:"Sat,Sun anytime"})]}),e.jsxs("button",{onClick:()=>ie("Mon-Fri:22:00-06:00"),className:"px-3 py-2 bg-tide-surface hover:bg-tide-surface border border-tide-border text-tide-text rounded-lg text-sm text-left transition-colors",children:[e.jsx("div",{className:"font-medium",children:"Weeknights"}),e.jsx("div",{className:"text-xs text-tide-text-muted",children:"Mon-Fri 22:00-06:00"})]}),e.jsxs("button",{onClick:()=>ie("Sat,Sun:02:00-10:00"),className:"px-3 py-2 bg-tide-surface hover:bg-tide-surface border border-tide-border text-tide-text rounded-lg text-sm text-left transition-colors",children:[e.jsx("div",{className:"font-medium",children:"Weekend Mornings"}),e.jsx("div",{className:"text-xs text-tide-text-muted",children:"Sat,Sun 02:00-10:00"})]})]})]}),e.jsx("button",{onClick:Es,disabled:$,className:"w-full px-4 py-2 bg-primary hover:bg-primary/80 text-tide-text rounded-lg transition-colors disabled:opacity-50",children:"Save Update Window"}),e.jsxs("div",{className:"mt-3 text-xs text-tide-text-muted",children:[e.jsx("p",{className:"font-medium mb-1",children:"Format Examples:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 ml-2",children:[e.jsx("li",{children:"02:00-06:00 (daily window)"}),e.jsx("li",{children:"Sat,Sun:00:00-23:59 (weekends)"}),e.jsx("li",{children:"Mon-Fri:22:00-06:00 (crosses midnight)"})]})]})]})]})]})]})})]})]}),us&&ue&&e.jsx(Sa,{dependency:ue.dependency,dependencyType:ue.type,onClose:()=>{Ft(!1),At(null)},onConfirm:Is}),ps&&G&&e.jsx(Da,{dependency:G.dependency,dependencyType:G.type,onClose:()=>{Ge(!1),Qe(null)},onConfirmUpdate:Os,onPreview:Bs}),fs&&e.jsx(Fa,{dependencies:Gs(),onClose:()=>et(!1),onConfirm:Ys,isUpdating:Je}),ys&&Tt&&e.jsx(Aa,{results:Tt,onClose:qs}),hs&&Ze&&e.jsx(Ua,{dependency:Ze.dependency,dependencyType:Ze.type,onClose:()=>{Ut(!1),Rt(null)},onRollbackComplete:zs})]})}export{La as default};
