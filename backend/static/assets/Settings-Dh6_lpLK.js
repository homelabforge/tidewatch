import{j as e,b as es,c as ts,a as p}from"./index-Co59pYVW.js";import{r as n}from"./router-vendor-h5EZ-JED.js";import{D as ss,X as S,G as q,J as rt,K as dt,M as ct,N as ot,O as xt,Q as mt,V as as,R as w,h as ls,r as K,s as Y,Y as is,i as D,I as A,q as ye,t as r,Z as be,z as W,_ as pe,$ as Ue,a0 as fe,d as H,a1 as lt,a2 as it,a3 as nt,U as Le,u as ns,a4 as ge,a5 as rs,a6 as ds,a7 as cs,F as os,a8 as xs,a9 as ms,aa as us,v as hs,E as je,b as Ne,C as L,S as bs}from"./ui-vendor-TZ6_hWVS.js";import{a as V}from"./utils-vendor-DnsfCnls.js";import"./react-vendor-C6WxKkic.js";function N({content:i,className:j=""}){const[u,h]=n.useState(!1),l=n.useRef(null),c=n.useRef(null);return n.useEffect(()=>{if(!u)return;const d=f=>{l.current&&!l.current.contains(f.target)&&c.current&&!c.current.contains(f.target)&&h(!1)},M=f=>{f.key==="Escape"&&h(!1)};return document.addEventListener("mousedown",d),document.addEventListener("keydown",M),()=>{document.removeEventListener("mousedown",d),document.removeEventListener("keydown",M)}},[u]),e.jsxs("div",{className:`relative inline-flex items-center ${j}`,children:[e.jsx("button",{ref:c,type:"button",onClick:()=>h(!u),className:"p-0.5 rounded-full hover:bg-tide-surface-light transition-colors focus:outline-none focus:ring-2 focus:ring-teal-500/50","aria-label":"Help","aria-expanded":u,children:e.jsx(ss,{className:"w-5 h-5 text-teal-500"})}),u&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-40","aria-hidden":"true"}),e.jsxs("div",{ref:l,role:"dialog","aria-modal":"true",className:"absolute z-50 w-72 top-full mt-2 right-0 bg-tide-surface border border-tide-border rounded-lg shadow-xl",children:[e.jsxs("div",{className:"flex items-center justify-between px-3 py-2 border-b border-tide-border",children:[e.jsx("span",{className:"text-sm font-medium text-teal-500",children:"Help"}),e.jsx("button",{onClick:()=>h(!1),className:"p-1 rounded hover:bg-tide-surface-light transition-colors","aria-label":"Close",children:e.jsx(S,{className:"w-4 h-4 text-tide-text-muted"})})]}),e.jsx("div",{className:"px-3 py-3",children:e.jsx("p",{className:"text-sm text-tide-text leading-relaxed",children:i})})]})]})]})}const ps=[{id:"ntfy",label:"ntfy",icon:q},{id:"gotify",label:"Gotify",icon:rt},{id:"pushover",label:"Pushover",icon:dt},{id:"slack",label:"Slack",icon:ct},{id:"discord",label:"Discord",icon:ot},{id:"telegram",label:"Telegram",icon:xt},{id:"email",label:"Email",icon:mt}];function fs({activeSubTab:i,onSubTabChange:j,enabledServices:u}){return e.jsx("div",{className:"flex flex-wrap gap-2 p-1 bg-tide-surface/50 rounded-lg border border-tide-border",children:ps.map(h=>{const l=h.icon,c=i===h.id,d=u[h.id];return e.jsxs("button",{onClick:()=>j(h.id),className:`flex items-center gap-2 px-3 py-2 rounded-md text-sm font-medium transition-colors ${c?"bg-teal-500/20 text-teal-400 border border-teal-500/30":"text-tide-text-muted hover:text-tide-text hover:bg-tide-surface"}`,children:[e.jsx(l,{className:"w-4 h-4"}),e.jsx("span",{children:h.label}),d&&e.jsx("span",{className:"w-2 h-2 rounded-full bg-green-400",title:"Enabled"})]},h.id)})})}const gs=[{id:"updates",label:"Updates",description:"Container update notifications",icon:as,enabledKey:"notify_updates_enabled",events:[{key:"notify_updates_available",label:"Update Available",description:"When a new version is detected"},{key:"notify_updates_applied_success",label:"Update Applied",description:"When an update completes successfully"},{key:"notify_updates_applied_failed",label:"Update Failed",description:"When an update fails to apply"},{key:"notify_updates_rollback",label:"Rollback",description:"When a rollback is performed"}]},{id:"restarts",label:"Restarts",description:"Container restart notifications",icon:w,enabledKey:"notify_restarts_enabled",events:[{key:"notify_restarts_scheduled",label:"Restart Scheduled",description:"When a restart is scheduled"},{key:"notify_restarts_success",label:"Restart Success",description:"When a restart completes"},{key:"notify_restarts_failure",label:"Restart Failed",description:"When a restart attempt fails"},{key:"notify_restarts_max_retries",label:"Max Retries Reached",description:"When max restart attempts exceeded"}]},{id:"system",label:"System",description:"System-level notifications",icon:ls,enabledKey:"notify_system_enabled",events:[{key:"notify_system_check_complete",label:"Check Complete",description:"When scheduled check finishes"},{key:"notify_system_dockerfile_updates",label:"Dockerfile Updates",description:"When Dockerfile dependency updates found"}]}];function js({settings:i,onSettingChange:j,onTextChange:u,saving:h,hasEnabledService:l}){const[c,d]=n.useState(new Set(["updates"])),[M,f]=n.useState(!1),I=y=>{d(Z=>{const s=new Set(Z);return s.has(y)?s.delete(y):s.add(y),s})};return l?e.jsxs("div",{className:"bg-tide-surface rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(q,{className:"w-6 h-6 text-teal-500"}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-tide-text",children:"Event Notifications"}),e.jsx("p",{className:"text-sm text-tide-text-muted mt-0.5",children:"Configure which events trigger notifications"})]})]}),e.jsx("div",{className:"space-y-3",children:gs.map(y=>{const Z=y.icon,s=c.has(y.id),E=!!i[y.enabledKey];return e.jsxs("div",{className:"border border-tide-border rounded-lg overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 bg-tide-surface/50",children:[e.jsxs("button",{onClick:()=>I(y.id),className:"flex items-center gap-3 flex-1 text-left",children:[e.jsx(Z,{className:`w-5 h-5 ${E?"text-teal-400":"text-tide-text-muted"}`}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-tide-text",children:y.label}),e.jsx("p",{className:"text-xs text-tide-text-muted",children:y.description})]}),s?e.jsx(K,{className:"w-4 h-4 text-tide-text-muted ml-2"}):e.jsx(Y,{className:"w-4 h-4 text-tide-text-muted ml-2"})]}),e.jsx("button",{type:"button",onClick:()=>j(y.enabledKey,!E),disabled:h,className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none ${E?"bg-teal-500":"bg-red-500"}`,children:e.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${E?"translate-x-6":"translate-x-1"}`})})]}),s&&E&&e.jsx("div",{className:"p-3 pt-0 space-y-2",children:y.events.map(v=>{const J=!!i[v.key];return e.jsxs("div",{className:"flex items-center justify-between p-2 rounded-lg bg-tide-surface/30 hover:bg-tide-surface/50 transition-colors",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("span",{className:"text-sm text-tide-text",children:v.label}),e.jsx("p",{className:"text-xs text-tide-text-muted truncate",children:v.description})]}),e.jsx("button",{type:"button",onClick:()=>j(v.key,!J),disabled:h,className:`relative inline-flex h-5 w-9 items-center rounded-full transition-colors focus:outline-none flex-shrink-0 ml-3 ${J?"bg-teal-500":"bg-gray-600"}`,children:e.jsx("span",{className:`inline-block h-3 w-3 transform rounded-full bg-white transition-transform ${J?"translate-x-5":"translate-x-1"}`})})]},v.key)})}),!s&&E&&e.jsx("div",{className:"px-3 pb-2",children:e.jsxs("p",{className:"text-xs text-tide-text-muted",children:[y.events.filter(v=>!!i[v.key]).length," of ",y.events.length," events enabled"]})})]},y.id)})}),e.jsxs("div",{className:"mt-4 border border-tide-border rounded-lg overflow-hidden",children:[e.jsxs("button",{onClick:()=>f(!M),className:"flex items-center gap-3 w-full p-3 bg-tide-surface/50 text-left",children:[e.jsx(is,{className:"w-5 h-5 text-tide-text-muted"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("span",{className:"text-sm font-medium text-tide-text",children:"Advanced"}),e.jsx("p",{className:"text-xs text-tide-text-muted",children:"Retry settings for high-priority notifications"})]}),M?e.jsx(K,{className:"w-4 h-4 text-tide-text-muted"}):e.jsx(Y,{className:"w-4 h-4 text-tide-text-muted"})]}),M&&e.jsxs("div",{className:"p-3 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("label",{className:"text-sm text-tide-text",children:"Retry Attempts"}),e.jsx("p",{className:"text-xs text-tide-text-muted",children:"Max retries for urgent/high priority events"})]}),e.jsx("input",{type:"number",min:"1",max:"10",value:String(i.notification_retry_attempts??"3"),onChange:y=>u("notification_retry_attempts",y.target.value),disabled:h,className:"w-20 px-2 py-1 text-sm bg-tide-bg border border-tide-border rounded text-tide-text focus:outline-none focus:border-teal-500"})]}),e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("label",{className:"text-sm text-tide-text",children:"Retry Delay (seconds)"}),e.jsx("p",{className:"text-xs text-tide-text-muted",children:"Base delay between retry attempts"})]}),e.jsx("input",{type:"number",min:"0.5",max:"30",step:"0.5",value:String(i.notification_retry_delay??"2.0"),onChange:y=>u("notification_retry_delay",y.target.value),disabled:h,className:"w-20 px-2 py-1 text-sm bg-tide-bg border border-tide-border rounded text-tide-text focus:outline-none focus:border-teal-500"})]}),e.jsx("p",{className:"text-xs text-tide-text-muted italic",children:"Retries only apply to urgent/high priority events (failures, max retries reached)"})]})]})]}):e.jsxs("div",{className:"bg-tide-surface/50 border border-tide-border rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(q,{className:"w-6 h-6 text-tide-text-muted"}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-tide-text",children:"Event Notifications"}),e.jsx("p",{className:"text-sm text-tide-text-muted mt-0.5",children:"Configure which events trigger notifications"})]})]}),e.jsx("div",{className:"p-4 bg-yellow-500/10 rounded-lg border border-yellow-500/30",children:e.jsx("p",{className:"text-sm text-tide-text",children:"Enable at least one notification service above to configure event notifications."})})]})}function Ns({settings:i,onSettingChange:j,onTextChange:u,onTest:h,testing:l,saving:c}){return e.jsxs("div",{className:"bg-tide-surface rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(q,{className:"w-6 h-6 text-teal-500"}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-tide-text",children:"ntfy Configuration"}),e.jsx("p",{className:"text-sm text-tide-text-muted mt-0.5",children:"Lightweight push notifications"})]})]}),e.jsx(N,{content:"ntfy is a simple pub-sub notification service. Self-hosted or use ntfy.sh. Supports Android, iOS, and web clients."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-tide-text",children:"Enable ntfy"}),e.jsx("p",{className:"text-xs text-tide-text-muted mt-1",children:"Send notifications via ntfy"})]}),e.jsx("button",{type:"button",onClick:()=>j("ntfy_enabled",!i.ntfy_enabled),disabled:c,className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none ${i.ntfy_enabled?"bg-teal-500":"bg-red-500"}`,children:e.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${i.ntfy_enabled?"translate-x-6":"translate-x-1"}`})})]}),e.jsx("div",{className:"space-y-2",children:e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-sm font-medium text-tide-text",children:"Server URL"}),e.jsx("p",{className:"text-xs text-tide-text-muted mb-2",children:"ntfy server (e.g., https://ntfy.sh)"}),e.jsx("input",{placeholder:"https://ntfy.sh",className:"w-full px-3 py-2 bg-tide-surface border border-tide-border rounded-lg text-tide-text focus:outline-none focus:ring-2 focus:ring-teal-500",type:"text",value:String(i.ntfy_server||""),onChange:d=>u("ntfy_server",d.target.value),disabled:c})]})}),e.jsx("div",{className:"space-y-2",children:e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-sm font-medium text-tide-text",children:"Topic"}),e.jsx("p",{className:"text-xs text-tide-text-muted mb-2",children:"Unique topic name for your notifications"}),e.jsx("input",{placeholder:"my-tidewatch-notifications",className:"w-full px-3 py-2 bg-tide-surface border border-tide-border rounded-lg text-tide-text focus:outline-none focus:ring-2 focus:ring-teal-500",type:"text",value:String(i.ntfy_topic||""),onChange:d=>u("ntfy_topic",d.target.value),disabled:c})]})}),e.jsx("div",{className:"space-y-2",children:e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-sm font-medium text-tide-text",children:"API Token (Optional)"}),e.jsx("p",{className:"text-xs text-tide-text-muted mb-2",children:"For authenticated ntfy servers"}),e.jsx("input",{placeholder:"tk_...",className:"w-full px-3 py-2 bg-tide-surface border border-tide-border rounded-lg text-tide-text focus:outline-none focus:ring-2 focus:ring-teal-500",type:"password",value:String(i.ntfy_token||""),onChange:d=>u("ntfy_token",d.target.value),disabled:c})]})}),e.jsxs("button",{type:"button",onClick:h,disabled:l||!i.ntfy_enabled,className:"px-4 py-2 bg-tide-surface hover:bg-tide-surface-light text-tide-text rounded-lg text-sm flex items-center gap-2 transition-colors disabled:opacity-50 border border-tide-border",children:[l?e.jsx(w,{className:"w-4 h-4 animate-spin"}):e.jsx(D,{className:"w-4 h-4"}),l?"Testing...":"Test Connection"]}),e.jsx("div",{className:"pt-4 border-t border-tide-border",children:e.jsx("div",{className:"p-3 bg-blue-500/10 rounded-lg border border-blue-500/30",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(A,{className:"w-4 h-4 text-blue-400 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"text-xs text-tide-text-muted",children:[e.jsx("p",{className:"font-medium text-tide-text mb-1",children:"Security Note"}),e.jsx("p",{children:"Use a unique, hard-to-guess topic name. Anyone with the topic name can receive your notifications."})]})]})})})]})]})}function ys({settings:i,onSettingChange:j,onTextChange:u,onTest:h,testing:l,saving:c}){return e.jsxs("div",{className:"bg-tide-surface rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(rt,{className:"w-6 h-6 text-teal-500"}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-tide-text",children:"Gotify Configuration"}),e.jsx("p",{className:"text-sm text-tide-text-muted mt-0.5",children:"Self-hosted notification server"})]})]}),e.jsx(N,{content:"Gotify is a self-hosted push notification server. Requires your own Gotify instance. Get app token from Gotify admin panel."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-tide-text",children:"Enable Gotify"}),e.jsx("p",{className:"text-xs text-tide-text-muted mt-1",children:"Send notifications via Gotify"})]}),e.jsx("button",{type:"button",onClick:()=>j("gotify_enabled",!i.gotify_enabled),disabled:c,className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none ${i.gotify_enabled?"bg-teal-500":"bg-red-500"}`,children:e.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${i.gotify_enabled?"translate-x-6":"translate-x-1"}`})})]}),e.jsx("div",{className:"space-y-2",children:e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-sm font-medium text-tide-text",children:"Server URL"}),e.jsx("p",{className:"text-xs text-tide-text-muted mb-2",children:"Your Gotify server URL"}),e.jsx("input",{placeholder:"https://gotify.example.com",className:"w-full px-3 py-2 bg-tide-surface border border-tide-border rounded-lg text-tide-text focus:outline-none focus:ring-2 focus:ring-teal-500",type:"text",value:String(i.gotify_server||""),onChange:d=>u("gotify_server",d.target.value),disabled:c})]})}),e.jsx("div",{className:"space-y-2",children:e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-sm font-medium text-tide-text",children:"App Token"}),e.jsx("p",{className:"text-xs text-tide-text-muted mb-2",children:"Application token from Gotify"}),e.jsx("input",{placeholder:"A...",className:"w-full px-3 py-2 bg-tide-surface border border-tide-border rounded-lg text-tide-text focus:outline-none focus:ring-2 focus:ring-teal-500",type:"password",value:String(i.gotify_token||""),onChange:d=>u("gotify_token",d.target.value),disabled:c})]})}),e.jsxs("button",{type:"button",onClick:h,disabled:l||!i.gotify_enabled,className:"px-4 py-2 bg-tide-surface hover:bg-tide-surface-light text-tide-text rounded-lg text-sm flex items-center gap-2 transition-colors disabled:opacity-50 border border-tide-border",children:[l?e.jsx(w,{className:"w-4 h-4 animate-spin"}):e.jsx(D,{className:"w-4 h-4"}),l?"Testing...":"Test Connection"]}),e.jsx("div",{className:"pt-4 border-t border-tide-border",children:e.jsx("div",{className:"p-3 bg-blue-500/10 rounded-lg border border-blue-500/30",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(A,{className:"w-4 h-4 text-blue-400 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"text-xs text-tide-text-muted",children:[e.jsx("p",{className:"font-medium text-tide-text mb-1",children:"Getting Started"}),e.jsx("p",{children:"Create an application in your Gotify admin panel and copy the app token. Supports Android client."})]})]})})})]})]})}function vs({settings:i,onSettingChange:j,onTextChange:u,onTest:h,testing:l,saving:c}){return e.jsxs("div",{className:"bg-tide-surface rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(dt,{className:"w-6 h-6 text-teal-500"}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-tide-text",children:"Pushover Configuration"}),e.jsx("p",{className:"text-sm text-tide-text-muted mt-0.5",children:"Cross-platform push notifications"})]})]}),e.jsx(N,{content:"Pushover is a paid service ($5 one-time) for reliable push notifications. Works on iOS, Android, and desktop."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-tide-text",children:"Enable Pushover"}),e.jsx("p",{className:"text-xs text-tide-text-muted mt-1",children:"Send notifications via Pushover"})]}),e.jsx("button",{type:"button",onClick:()=>j("pushover_enabled",!i.pushover_enabled),disabled:c,className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none ${i.pushover_enabled?"bg-teal-500":"bg-red-500"}`,children:e.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${i.pushover_enabled?"translate-x-6":"translate-x-1"}`})})]}),e.jsx("div",{className:"space-y-2",children:e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-sm font-medium text-tide-text",children:"User Key"}),e.jsx("p",{className:"text-xs text-tide-text-muted mb-2",children:"Your Pushover user key"}),e.jsx("input",{placeholder:"u...",className:"w-full px-3 py-2 bg-tide-surface border border-tide-border rounded-lg text-tide-text focus:outline-none focus:ring-2 focus:ring-teal-500",type:"password",value:String(i.pushover_user_key||""),onChange:d=>u("pushover_user_key",d.target.value),disabled:c})]})}),e.jsx("div",{className:"space-y-2",children:e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-sm font-medium text-tide-text",children:"API Token"}),e.jsx("p",{className:"text-xs text-tide-text-muted mb-2",children:"Application API token from Pushover"}),e.jsx("input",{placeholder:"a...",className:"w-full px-3 py-2 bg-tide-surface border border-tide-border rounded-lg text-tide-text focus:outline-none focus:ring-2 focus:ring-teal-500",type:"password",value:String(i.pushover_api_token||""),onChange:d=>u("pushover_api_token",d.target.value),disabled:c})]})}),e.jsxs("button",{type:"button",onClick:h,disabled:l||!i.pushover_enabled,className:"px-4 py-2 bg-tide-surface hover:bg-tide-surface-light text-tide-text rounded-lg text-sm flex items-center gap-2 transition-colors disabled:opacity-50 border border-tide-border",children:[l?e.jsx(w,{className:"w-4 h-4 animate-spin"}):e.jsx(D,{className:"w-4 h-4"}),l?"Testing...":"Test Connection"]}),e.jsx("div",{className:"pt-4 border-t border-tide-border",children:e.jsx("div",{className:"p-3 bg-blue-500/10 rounded-lg border border-blue-500/30",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(A,{className:"w-4 h-4 text-blue-400 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"text-xs text-tide-text-muted",children:[e.jsx("p",{className:"font-medium text-tide-text mb-1",children:"Getting Started"}),e.jsx("p",{className:"mb-2",children:"Register at pushover.net and create an application to get your API token."}),e.jsxs("a",{href:"https://pushover.net",target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-1 text-teal-400 hover:text-teal-300",children:[e.jsx(ye,{className:"w-3 h-3"}),"pushover.net"]})]})]})})})]})]})}function ws({settings:i,onSettingChange:j,onTextChange:u,onTest:h,testing:l,saving:c}){return e.jsxs("div",{className:"bg-tide-surface rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ct,{className:"w-6 h-6 text-teal-500"}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-tide-text",children:"Slack Configuration"}),e.jsx("p",{className:"text-sm text-tide-text-muted mt-0.5",children:"Team collaboration notifications"})]})]}),e.jsx(N,{content:"Send notifications to a Slack channel via webhook. Create an Incoming Webhook in your Slack app settings."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-tide-text",children:"Enable Slack"}),e.jsx("p",{className:"text-xs text-tide-text-muted mt-1",children:"Send notifications to Slack"})]}),e.jsx("button",{type:"button",onClick:()=>j("slack_enabled",!i.slack_enabled),disabled:c,className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none ${i.slack_enabled?"bg-teal-500":"bg-red-500"}`,children:e.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${i.slack_enabled?"translate-x-6":"translate-x-1"}`})})]}),e.jsx("div",{className:"space-y-2",children:e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-sm font-medium text-tide-text",children:"Webhook URL"}),e.jsx("p",{className:"text-xs text-tide-text-muted mb-2",children:"Slack Incoming Webhook URL"}),e.jsx("input",{placeholder:"https://hooks.slack.com/services/T.../B.../...",className:"w-full px-3 py-2 bg-tide-surface border border-tide-border rounded-lg text-tide-text focus:outline-none focus:ring-2 focus:ring-teal-500",type:"password",value:String(i.slack_webhook_url||""),onChange:d=>u("slack_webhook_url",d.target.value),disabled:c})]})}),e.jsxs("button",{type:"button",onClick:h,disabled:l||!i.slack_enabled,className:"px-4 py-2 bg-tide-surface hover:bg-tide-surface-light text-tide-text rounded-lg text-sm flex items-center gap-2 transition-colors disabled:opacity-50 border border-tide-border",children:[l?e.jsx(w,{className:"w-4 h-4 animate-spin"}):e.jsx(D,{className:"w-4 h-4"}),l?"Testing...":"Test Connection"]}),e.jsx("div",{className:"pt-4 border-t border-tide-border",children:e.jsx("div",{className:"p-3 bg-blue-500/10 rounded-lg border border-blue-500/30",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(A,{className:"w-4 h-4 text-blue-400 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"text-xs text-tide-text-muted",children:[e.jsx("p",{className:"font-medium text-tide-text mb-1",children:"Setting Up"}),e.jsx("p",{className:"mb-2",children:"Create an Incoming Webhook in your Slack workspace settings and paste the URL here."}),e.jsxs("a",{href:"https://api.slack.com/messaging/webhooks",target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-1 text-teal-400 hover:text-teal-300",children:[e.jsx(ye,{className:"w-3 h-3"}),"Slack Webhooks Guide"]})]})]})})})]})]})}function ks({settings:i,onSettingChange:j,onTextChange:u,onTest:h,testing:l,saving:c}){return e.jsxs("div",{className:"bg-tide-surface rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ot,{className:"w-6 h-6 text-teal-500"}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-tide-text",children:"Discord Configuration"}),e.jsx("p",{className:"text-sm text-tide-text-muted mt-0.5",children:"Gaming & community notifications"})]})]}),e.jsx(N,{content:"Send notifications to a Discord channel via webhook. Create a webhook in your channel's integration settings."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-tide-text",children:"Enable Discord"}),e.jsx("p",{className:"text-xs text-tide-text-muted mt-1",children:"Send notifications to Discord"})]}),e.jsx("button",{type:"button",onClick:()=>j("discord_enabled",!i.discord_enabled),disabled:c,className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none ${i.discord_enabled?"bg-teal-500":"bg-red-500"}`,children:e.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${i.discord_enabled?"translate-x-6":"translate-x-1"}`})})]}),e.jsx("div",{className:"space-y-2",children:e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-sm font-medium text-tide-text",children:"Webhook URL"}),e.jsx("p",{className:"text-xs text-tide-text-muted mb-2",children:"Discord channel webhook URL"}),e.jsx("input",{placeholder:"https://discord.com/api/webhooks/...",className:"w-full px-3 py-2 bg-tide-surface border border-tide-border rounded-lg text-tide-text focus:outline-none focus:ring-2 focus:ring-teal-500",type:"password",value:String(i.discord_webhook_url||""),onChange:d=>u("discord_webhook_url",d.target.value),disabled:c})]})}),e.jsxs("button",{type:"button",onClick:h,disabled:l||!i.discord_enabled,className:"px-4 py-2 bg-tide-surface hover:bg-tide-surface-light text-tide-text rounded-lg text-sm flex items-center gap-2 transition-colors disabled:opacity-50 border border-tide-border",children:[l?e.jsx(w,{className:"w-4 h-4 animate-spin"}):e.jsx(D,{className:"w-4 h-4"}),l?"Testing...":"Test Connection"]}),e.jsx("div",{className:"pt-4 border-t border-tide-border",children:e.jsx("div",{className:"p-3 bg-blue-500/10 rounded-lg border border-blue-500/30",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(A,{className:"w-4 h-4 text-blue-400 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"text-xs text-tide-text-muted",children:[e.jsx("p",{className:"font-medium text-tide-text mb-1",children:"Setting Up"}),e.jsxs("p",{className:"mb-2",children:["Go to Channel Settings ",">"," Integrations ",">"," Webhooks and create a new webhook."]}),e.jsxs("a",{href:"https://support.discord.com/hc/en-us/articles/228383668-Intro-to-Webhooks",target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-1 text-teal-400 hover:text-teal-300",children:[e.jsx(ye,{className:"w-3 h-3"}),"Discord Webhooks Guide"]})]})]})})})]})]})}function _s({settings:i,onSettingChange:j,onTextChange:u,onTest:h,testing:l,saving:c}){return e.jsxs("div",{className:"bg-tide-surface rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(xt,{className:"w-6 h-6 text-teal-500"}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-tide-text",children:"Telegram Configuration"}),e.jsx("p",{className:"text-sm text-tide-text-muted mt-0.5",children:"Secure messaging notifications"})]})]}),e.jsx(N,{content:"Send notifications via Telegram bot. Create a bot with @BotFather and get your chat ID."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-tide-text",children:"Enable Telegram"}),e.jsx("p",{className:"text-xs text-tide-text-muted mt-1",children:"Send notifications via Telegram"})]}),e.jsx("button",{type:"button",onClick:()=>j("telegram_enabled",!i.telegram_enabled),disabled:c,className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none ${i.telegram_enabled?"bg-teal-500":"bg-red-500"}`,children:e.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${i.telegram_enabled?"translate-x-6":"translate-x-1"}`})})]}),e.jsx("div",{className:"space-y-2",children:e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-sm font-medium text-tide-text",children:"Bot Token"}),e.jsx("p",{className:"text-xs text-tide-text-muted mb-2",children:"Token from @BotFather"}),e.jsx("input",{placeholder:"123456789:ABC...",className:"w-full px-3 py-2 bg-tide-surface border border-tide-border rounded-lg text-tide-text focus:outline-none focus:ring-2 focus:ring-teal-500",type:"password",value:String(i.telegram_bot_token||""),onChange:d=>u("telegram_bot_token",d.target.value),disabled:c})]})}),e.jsx("div",{className:"space-y-2",children:e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-sm font-medium text-tide-text",children:"Chat ID"}),e.jsx("p",{className:"text-xs text-tide-text-muted mb-2",children:"Your chat or group ID"}),e.jsx("input",{placeholder:"-100...",className:"w-full px-3 py-2 bg-tide-surface border border-tide-border rounded-lg text-tide-text focus:outline-none focus:ring-2 focus:ring-teal-500",type:"text",value:String(i.telegram_chat_id||""),onChange:d=>u("telegram_chat_id",d.target.value),disabled:c})]})}),e.jsxs("button",{type:"button",onClick:h,disabled:l||!i.telegram_enabled,className:"px-4 py-2 bg-tide-surface hover:bg-tide-surface-light text-tide-text rounded-lg text-sm flex items-center gap-2 transition-colors disabled:opacity-50 border border-tide-border",children:[l?e.jsx(w,{className:"w-4 h-4 animate-spin"}):e.jsx(D,{className:"w-4 h-4"}),l?"Testing...":"Test Connection"]}),e.jsx("div",{className:"pt-4 border-t border-tide-border",children:e.jsx("div",{className:"p-3 bg-blue-500/10 rounded-lg border border-blue-500/30",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(A,{className:"w-4 h-4 text-blue-400 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"text-xs text-tide-text-muted",children:[e.jsx("p",{className:"font-medium text-tide-text mb-1",children:"Getting Started"}),e.jsx("p",{className:"mb-2",children:"1. Message @BotFather to create a bot and get token"}),e.jsx("p",{className:"mb-2",children:"2. Message @userinfobot to get your chat ID"}),e.jsxs("a",{href:"https://core.telegram.org/bots#how-do-i-create-a-bot",target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-1 text-teal-400 hover:text-teal-300",children:[e.jsx(ye,{className:"w-3 h-3"}),"Telegram Bot Guide"]})]})]})})})]})]})}function Cs({settings:i,onSettingChange:j,onTextChange:u,onTest:h,testing:l,saving:c}){return e.jsxs("div",{className:"bg-tide-surface rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(mt,{className:"w-6 h-6 text-teal-500"}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-tide-text",children:"Email Configuration"}),e.jsx("p",{className:"text-sm text-tide-text-muted mt-0.5",children:"SMTP email notifications"})]})]}),e.jsx(N,{content:"Send notifications via email using SMTP. Works with any SMTP server including Gmail, Outlook, or self-hosted."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-tide-text",children:"Enable Email"}),e.jsx("p",{className:"text-xs text-tide-text-muted mt-1",children:"Send notifications via email"})]}),e.jsx("button",{type:"button",onClick:()=>j("email_enabled",!i.email_enabled),disabled:c,className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none ${i.email_enabled?"bg-teal-500":"bg-red-500"}`,children:e.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${i.email_enabled?"translate-x-6":"translate-x-1"}`})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx("div",{className:"space-y-2",children:e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-sm font-medium text-tide-text",children:"SMTP Host"}),e.jsx("p",{className:"text-xs text-tide-text-muted mb-2",children:"SMTP server hostname"}),e.jsx("input",{placeholder:"smtp.gmail.com",className:"w-full px-3 py-2 bg-tide-surface border border-tide-border rounded-lg text-tide-text focus:outline-none focus:ring-2 focus:ring-teal-500",type:"text",value:String(i.email_smtp_host||""),onChange:d=>u("email_smtp_host",d.target.value),disabled:c})]})}),e.jsx("div",{className:"space-y-2",children:e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-sm font-medium text-tide-text",children:"SMTP Port"}),e.jsx("p",{className:"text-xs text-tide-text-muted mb-2",children:"Usually 587 (TLS) or 465 (SSL)"}),e.jsx("input",{placeholder:"587",className:"w-full px-3 py-2 bg-tide-surface border border-tide-border rounded-lg text-tide-text focus:outline-none focus:ring-2 focus:ring-teal-500",type:"number",value:String(i.email_smtp_port||"587"),onChange:d=>u("email_smtp_port",d.target.value),disabled:c})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx("div",{className:"space-y-2",children:e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-sm font-medium text-tide-text",children:"Username"}),e.jsx("p",{className:"text-xs text-tide-text-muted mb-2",children:"SMTP username"}),e.jsx("input",{placeholder:"user@example.com",className:"w-full px-3 py-2 bg-tide-surface border border-tide-border rounded-lg text-tide-text focus:outline-none focus:ring-2 focus:ring-teal-500",type:"text",value:String(i.email_smtp_user||""),onChange:d=>u("email_smtp_user",d.target.value),disabled:c})]})}),e.jsx("div",{className:"space-y-2",children:e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-sm font-medium text-tide-text",children:"Password"}),e.jsx("p",{className:"text-xs text-tide-text-muted mb-2",children:"SMTP password or app password"}),e.jsx("input",{placeholder:"********",className:"w-full px-3 py-2 bg-tide-surface border border-tide-border rounded-lg text-tide-text focus:outline-none focus:ring-2 focus:ring-teal-500",type:"password",value:String(i.email_smtp_password||""),onChange:d=>u("email_smtp_password",d.target.value),disabled:c})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx("div",{className:"space-y-2",children:e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-sm font-medium text-tide-text",children:"From Address"}),e.jsx("p",{className:"text-xs text-tide-text-muted mb-2",children:"Sender email address"}),e.jsx("input",{placeholder:"tidewatch@example.com",className:"w-full px-3 py-2 bg-tide-surface border border-tide-border rounded-lg text-tide-text focus:outline-none focus:ring-2 focus:ring-teal-500",type:"email",value:String(i.email_from||""),onChange:d=>u("email_from",d.target.value),disabled:c})]})}),e.jsx("div",{className:"space-y-2",children:e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-sm font-medium text-tide-text",children:"To Address"}),e.jsx("p",{className:"text-xs text-tide-text-muted mb-2",children:"Recipient email address"}),e.jsx("input",{placeholder:"admin@example.com",className:"w-full px-3 py-2 bg-tide-surface border border-tide-border rounded-lg text-tide-text focus:outline-none focus:ring-2 focus:ring-teal-500",type:"email",value:String(i.email_to||""),onChange:d=>u("email_to",d.target.value),disabled:c})]})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-tide-text",children:"Use TLS"}),e.jsx("p",{className:"text-xs text-tide-text-muted mt-1",children:"Enable STARTTLS encryption"})]}),e.jsx("button",{type:"button",onClick:()=>j("email_smtp_tls",!i.email_smtp_tls),disabled:c,className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none ${i.email_smtp_tls!==!1?"bg-teal-500":"bg-gray-600"}`,children:e.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${i.email_smtp_tls!==!1?"translate-x-6":"translate-x-1"}`})})]}),e.jsxs("button",{type:"button",onClick:h,disabled:l||!i.email_enabled,className:"px-4 py-2 bg-tide-surface hover:bg-tide-surface-light text-tide-text rounded-lg text-sm flex items-center gap-2 transition-colors disabled:opacity-50 border border-tide-border",children:[l?e.jsx(w,{className:"w-4 h-4 animate-spin"}):e.jsx(D,{className:"w-4 h-4"}),l?"Testing...":"Send Test Email"]}),e.jsx("div",{className:"pt-4 border-t border-tide-border",children:e.jsx("div",{className:"p-3 bg-blue-500/10 rounded-lg border border-blue-500/30",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(A,{className:"w-4 h-4 text-blue-400 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"text-xs text-tide-text-muted",children:[e.jsx("p",{className:"font-medium text-tide-text mb-1",children:"Gmail Users"}),e.jsx("p",{children:"Use an App Password instead of your regular password. Enable 2FA and generate one at Google Account settings."})]})]})})})]})]})}function Es(){const[i,j]=n.useState("system"),[u,h]=n.useState(!0),[l,c]=n.useState(!1),{theme:d,setTheme:M}=es(),{user:f,authMode:I,updateProfile:y,changePassword:Z}=ts(),[s,E]=n.useState({}),[v,J]=n.useState([]),[Q,ut]=n.useState(new Set),[ve,Ge]=n.useState(!1),[we,ht]=n.useState(!1),[ke,bt]=n.useState(!1),[pt,ft]=n.useState(!1),[gt,jt]=n.useState(!1),[Nt,yt]=n.useState(!1),[vt,wt]=n.useState(!1),[kt,_t]=n.useState(!1),[Ct,St]=n.useState(!1),[At,Tt]=n.useState(!1),[F,Dt]=n.useState("ntfy"),[C,Pt]=n.useState(null),[Et,ze]=n.useState(!1),[_e,We]=n.useState(!1),[X,He]=n.useState(!1),Ce=n.useRef(null),[$t,ee]=n.useState(!1),[Mt,te]=n.useState(!1),[T,R]=n.useState(null),[B,Ot]=n.useState(null),[Ft,Ve]=n.useState(!1),[Ke,Ye]=n.useState(!1),[qe,Se]=n.useState(""),[Ze,Ae]=n.useState(""),[Je,Qe]=n.useState(!1),[Te,se]=n.useState(""),[_,ae]=n.useState(""),[G,le]=n.useState(""),[Xe,et]=n.useState(!1),[De,ie]=n.useState(!1),[Pe,ne]=n.useState(!1),[Ee,re]=n.useState(!1),[k,U]=n.useState({enabled:!1,issuer_url:"",client_id:"",client_secret:"",provider_name:"",scopes:"openid email profile",redirect_uri:""}),[O,tt]=n.useState(!1),[$e,st]=n.useState(!1),[Me,Rt]=n.useState(!1),[Oe,de]=n.useState(!1),[It,ce]=n.useState(!1),[Bt,Fe]=n.useState(!1),[Ut,Re]=n.useState(!1),[Lt,Ie]=n.useState(!1),Be=n.useRef({});n.useEffect(()=>{Oe&&f&&(Se(f.email||""),Ae(f.full_name||""))},[Oe,f]);const oe=t=>{if(t===0)return"0 B";const o=1024,x=["B","KB","MB","GB"],a=Math.floor(Math.log(t)/Math.log(o));return`${(t/Math.pow(o,a)).toFixed(2)} ${x[a]}`},Gt=[{id:"system",label:"System",icon:be},{id:"updates",label:"Updates",icon:W},{id:"docker",label:"Docker",icon:pe},{id:"integrations",label:"Integrations",icon:Ue},{id:"notifications",label:"Notifications",icon:q},{id:"backup",label:"Backup & Maintenance",icon:fe}];n.useEffect(()=>{xe()},[]),n.useEffect(()=>{i==="backup"&&z()},[i]),n.useEffect(()=>{i==="updates"&&at()},[i]);const xe=async()=>{try{h(!0);const t=await p.settings.getAll();J([]);const o={};t.forEach(x=>{let a=x.value;a==="true"?a=!0:a==="false"?a=!1:!isNaN(Number(a))&&a!==""&&(a=Number(a)),o[x.key]=a}),E(o)}catch(t){console.error("Failed to load settings:",t),r.error("Failed to load settings")}finally{h(!1)}},me=t=>{ut(o=>{const x=new Set(o);return x.has(t)?x.delete(t):x.add(t),x})},ue=t=>({system:be,docker:pe,updates:W,cleanup:ge,registry:pe,integrations:Ue,notifications:q,backup:fe})[t]||bs,he=t=>({system:"System Configuration",docker:"Docker Settings",updates:"Update Management",cleanup:"Cleanup & Maintenance",registry:"Registry Authentication",integrations:"Integrations",notifications:"Notifications",backup:"Backup Settings"})[t]||t.charAt(0).toUpperCase()+t.slice(1),m=async(t,o,x=!0)=>{try{c(!0);const a=String(o);await p.settings.update(t,a),x&&E(b=>({...b,[t]:o})),r.success("Setting updated successfully")}catch(a){console.error(`Failed to update ${t}:`,a),r.error("Failed to update setting"),await xe()}finally{c(!1)}},g=(t,o)=>{E(x=>({...x,[t]:o})),Be.current[t]&&clearTimeout(Be.current[t]),Be.current[t]=setTimeout(async()=>{if(await m(t,o,!1),t==="check_schedule")try{await p.updates.reloadScheduler(),r.success("Scheduler reloaded with new schedule"),await at()}catch(x){console.error("Failed to reload scheduler:",x),r.error("Failed to reload scheduler")}},1e3)},z=async()=>{try{ze(!0);const t=await p.backup.list();Pt(t)}catch(t){console.error("Failed to load backups:",t),r.error("Failed to load backups")}finally{ze(!1)}},at=async()=>{try{Ve(!0);const t=await p.updates.getSchedulerStatus();Ot(t.scheduler)}catch(t){console.error("Failed to load scheduler status:",t)}finally{Ve(!1)}},zt=async()=>{if(confirm("Are you sure you want to reset ALL settings to defaults? This action cannot be undone."))try{const t=await p.settings.reset();r.success(t.message||"Settings reset to defaults"),await xe()}catch(t){console.error("Failed to reset settings:",t),r.error("Failed to reset settings")}},Wt=async()=>{try{tt(!0),await p.auth.oidc.updateConfig(k),r.success("OIDC configuration saved successfully")}catch(t){console.error("Failed to save OIDC config:",t),r.error("Failed to save OIDC configuration")}finally{tt(!1)}},Ht=async()=>{try{st(!0);const t=await p.auth.oidc.testConnection(k);t.success?r.success("OIDC connection successful!"):r.error(`OIDC connection failed: ${t.errors.join(", ")}`)}catch(t){console.error("Failed to test OIDC:",t),r.error("Failed to test OIDC connection")}finally{st(!1)}};n.useEffect(()=>{i==="system"&&f&&(Se(f.email),Ae(f.full_name||""))},[i,f]),n.useEffect(()=>{i==="system"&&I!=="none"&&p.auth.oidc.getConfig().then(t=>{U(t)}).catch(t=>{console.error("Failed to load OIDC config:",t)})},[i,I]);const Vt=async()=>{try{We(!0);const t=await p.backup.create();r.success(t.message),await z()}catch(t){console.error("Failed to create backup:",t),r.error("Failed to create backup")}finally{We(!1)}},Kt=async t=>{const o=t.target.files?.[0];if(o)try{He(!0),await p.backup.upload(o),r.success("Backup uploaded successfully"),await z()}catch(x){console.error("Failed to upload backup:",x),r.error("Failed to upload backup")}finally{He(!1),Ce.current&&(Ce.current.value="")}},Yt=t=>{const o=p.backup.download(t),x=document.createElement("a");x.href=o,x.download=t,document.body.appendChild(x),x.click(),document.body.removeChild(x),r.success("Backup download started")},qt=t=>{R(t),te(!0)},Zt=t=>{if(t.is_safety){r.error("Safety backups cannot be deleted");return}R(t),ee(!0)},Jt=async()=>{if(T)try{const t=await p.backup.restore(T.filename);r.success(t.message),await xe(),await z(),te(!1),R(null)}catch(t){console.error("Failed to restore backup:",t),r.error("Failed to restore backup")}},Qt=async()=>{if(T)try{const t=await p.backup.delete(T.filename);r.success(t.message),await z(),ee(!1),R(null)}catch(t){console.error("Failed to delete backup:",t),r.error("Failed to delete backup")}},$=async t=>{const o={docker:Ge,dockerhub:Ge,ghcr:ht,vulnforge:bt,ntfy:ft,gotify:jt,pushover:yt,slack:wt,discord:_t,telegram:St,email:Tt}[t],x={docker:p.settings.testDocker,dockerhub:p.settings.testDockerHub,ghcr:p.settings.testGHCR,vulnforge:p.settings.testVulnForge,ntfy:p.settings.testNtfy,gotify:p.settings.testGotify,pushover:p.settings.testPushover,slack:p.settings.testSlack,discord:p.settings.testDiscord,telegram:p.settings.testTelegram,email:p.settings.testEmail}[t];try{o(!0);const a=await x();a.success?r.success(a.message,{description:a.details?Object.entries(a.details).map(([b,P])=>`${b}: ${P}`).join(", "):void 0}):r.error(a.message,{description:a.details?Object.entries(a.details).map(([b,P])=>`${b}: ${P}`).join(", "):void 0})}catch(a){console.error(`Failed to test ${t} connection:`,a),r.error(`Failed to test ${t} connection`)}finally{o(!1)}},Xt=async()=>{try{Ye(!0);const t=await p.containers.scanMyProjects();if(t.success){const{added:o,updated:x,skipped:a,errors:b}=t.results;r.success("Project scan completed",{description:`Added: ${o}, Updated: ${x}, Skipped: ${a}${b?`, Errors: ${b.length}`:""}`})}else r.error("Failed to scan projects")}catch(t){console.error("Failed to scan my projects:",t),r.error("Failed to scan my projects")}finally{Ye(!1)}};return u?e.jsx("div",{className:"min-h-screen bg-tide-bg flex items-center justify-center",children:e.jsx(w,{className:"animate-spin text-primary",size:48})}):e.jsxs("div",{className:"min-h-screen bg-tide-bg",children:[e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-tide-text mb-2",children:"Settings"}),e.jsx("p",{className:"text-tide-text-muted",children:"Configure TideWatch to match your needs"})]}),e.jsx("div",{className:"border-b border-tide-border mb-6",children:e.jsx("nav",{className:"-mb-px flex space-x-8",children:Gt.map(t=>{const o=t.icon,x=i===t.id;return e.jsxs("button",{onClick:()=>j(t.id),className:`flex items-center gap-2 px-1 py-4 border-b-2 font-medium text-sm transition-colors ${x?"border-primary text-primary":"border-transparent text-tide-text-muted hover:text-tide-text hover:border-tide-border"}`,children:[e.jsx(o,{size:18}),t.label]},t.id)})})}),e.jsxs("div",{className:"bg-tide-surface-light rounded-lg p-6 mt-6",children:[v.length>0&&e.jsx("div",{className:"mb-6 pb-6 border-b border-tide-border",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-tide-text mb-1",children:"Settings Organization"}),e.jsx("p",{className:"text-xs text-tide-text-muted",children:"Settings are grouped by category. Click to expand/collapse sections."})]}),e.jsx("div",{className:"text-xs text-teal-400 bg-teal-500/10 px-3 py-1 rounded-full border border-teal-500/30",children:"EXPERIMENTAL"})]})}),i==="system"&&e.jsxs("div",{className:"space-y-6",children:[v.length>0&&e.jsx("div",{className:"space-y-4",children:v.filter(t=>t.category==="system"||t.category==="docker").map(t=>{const o=ue(t.category),x=Q.has(t.category);return e.jsxs("div",{className:"bg-tide-surface/50 rounded-lg border border-tide-border",children:[e.jsxs("button",{onClick:()=>me(t.category),className:"w-full flex items-center justify-between p-4 hover:bg-tide-surface/70 transition-colors rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(o,{className:"w-5 h-5 text-teal-400"}),e.jsxs("div",{className:"text-left",children:[e.jsx("h3",{className:"text-sm font-semibold text-tide-text",children:he(t.category)}),e.jsxs("p",{className:"text-xs text-tide-text-muted mt-0.5",children:[t.settings.length," ",t.settings.length===1?"setting":"settings"]})]})]}),x?e.jsx(Y,{className:"w-5 h-5 text-tide-text-muted"}):e.jsx(K,{className:"w-5 h-5 text-tide-text-muted"})]}),!x&&e.jsx("div",{className:"p-4 pt-0 space-y-4",children:t.settings.map(a=>e.jsx("div",{className:"bg-tide-surface/50 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-sm font-medium text-tide-text",children:a.key.split("_").map(b=>b.charAt(0).toUpperCase()+b.slice(1)).join(" ")}),a.description&&e.jsx("p",{className:"text-xs text-tide-text-muted mt-1",children:a.description})]}),e.jsxs("div",{className:"flex-shrink-0",children:[typeof s[a.key]=="boolean"&&e.jsx("button",{type:"button",onClick:()=>m(a.key,!s[a.key]),disabled:l,className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none ${s[a.key]?"bg-teal-500":"bg-red-500"}`,children:e.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${s[a.key]?"translate-x-6":"translate-x-1"}`})}),typeof s[a.key]!="boolean"&&e.jsx("input",{type:typeof s[a.key]=="number"?"number":"text",value:String(s[a.key]||""),onChange:b=>{const P=typeof s[a.key]=="number"?parseInt(b.target.value)||0:b.target.value;g(a.key,String(P))},disabled:l,className:"w-48 bg-tide-surface text-tide-text text-sm rounded px-3 py-1.5 border border-tide-border-light focus:border-teal-500 focus:outline-none"})]})]})},a.key))})]},t.category)})}),v.length===0&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"border border-red-500/30 bg-red-500/5 rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-start gap-3 mb-4",children:[e.jsx(H,{className:"w-6 h-6 text-red-500 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h2",{className:"text-xl font-semibold text-red-500 mb-1",children:"Danger Zone"}),e.jsx("p",{className:"text-sm text-tide-text-muted",children:"Destructive actions that cannot be undone"})]})]}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"flex items-center justify-between p-4 bg-tide-surface/50 rounded-lg border border-tide-border",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-tide-text mb-1",children:"Reset All Settings"}),e.jsx("p",{className:"text-xs text-tide-text-muted",children:"Restore all configuration settings to their default values"})]}),e.jsxs("button",{onClick:zt,className:"px-4 py-2 bg-red-600 hover:bg-red-700 text-tide-text rounded-lg text-sm font-medium transition-colors flex items-center gap-2",children:[e.jsx(W,{className:"w-4 h-4"}),"Reset to Defaults"]})]})})]}),e.jsxs("div",{className:"columns-1 md:columns-2 gap-4 space-y-4",children:[e.jsxs("div",{className:"bg-tide-surface rounded-lg p-6 break-inside-avoid",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[d==="dark"?e.jsx(lt,{className:"w-6 h-6 text-teal-500"}):e.jsx(it,{className:"w-6 h-6 text-teal-500"}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-tide-text",children:"Theme"}),e.jsx("p",{className:"text-sm text-tide-text-muted mt-0.5",children:"Choose your preferred interface theme"})]})]}),e.jsx(N,{content:"Select your preferred visual theme. Dark mode is easier on the eyes in low-light conditions, while Light mode provides better visibility in bright environments. Your preference is saved automatically."})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{onClick:()=>M("dark"),className:`flex-1 flex items-center justify-center gap-2 px-4 py-3 rounded-lg border-2 transition-all ${d==="dark"?"border-primary bg-primary/10 text-primary":"border-tide-border-light bg-tide-surface text-tide-text hover:border-tide-border-light"}`,children:[e.jsx(lt,{className:"w-5 h-5"}),e.jsx("span",{className:"font-medium",children:"Dark"})]}),e.jsxs("button",{onClick:()=>M("light"),className:`flex-1 flex items-center justify-center gap-2 px-4 py-3 rounded-lg border-2 transition-all ${d==="light"?"border-primary bg-primary/10 text-primary":"border-tide-border-light bg-tide-surface text-tide-text hover:border-tide-border-light"}`,children:[e.jsx(it,{className:"w-5 h-5"}),e.jsx("span",{className:"font-medium",children:"Light"})]})]})]}),e.jsxs("div",{className:"bg-tide-surface rounded-lg p-6 break-inside-avoid",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(nt,{className:"w-6 h-6 text-teal-500"}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-tide-text",children:"Authentication"}),e.jsx("p",{className:"text-sm text-tide-text-muted mt-0.5",children:I==="none"?"Authentication is disabled":I==="local"?"Local username/password authentication":"SSO/OIDC authentication"})]})]}),e.jsx(N,{content:"Control authentication settings. When disabled, all API endpoints are publicly accessible. Enable local auth for username/password or OIDC for Single Sign-On integration."})]}),I==="none"?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2 px-4 py-3 bg-yellow-500/10 border border-yellow-500/20 rounded-lg",children:[e.jsx(A,{className:"w-5 h-5 text-yellow-500 flex-shrink-0"}),e.jsx("p",{className:"text-sm text-yellow-500",children:"All API endpoints are publicly accessible. Enable authentication below to secure your instance."})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"block text-sm font-medium text-tide-text",children:"Choose Authentication Method"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("button",{onClick:()=>Fe(!0),className:"w-full px-4 py-3 bg-tide-bg hover:bg-tide-surface-light text-left border border-tide-border rounded-lg transition-colors group",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex-shrink-0 w-10 h-10 bg-teal-500/10 rounded-lg flex items-center justify-center group-hover:bg-teal-500/20 transition-colors",children:e.jsx(Le,{className:"w-5 h-5 text-teal-500"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium text-tide-text",children:"Local Authentication"}),e.jsx("div",{className:"text-sm text-tide-text-muted",children:"Username and password login"})]})]})}),e.jsx("button",{onClick:()=>Re(!0),className:"w-full px-4 py-3 bg-tide-bg hover:bg-tide-surface-light text-left border border-tide-border rounded-lg transition-colors group",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex-shrink-0 w-10 h-10 bg-teal-500/10 rounded-lg flex items-center justify-center group-hover:bg-teal-500/20 transition-colors",children:e.jsx(H,{className:"w-5 h-5 text-teal-500"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium text-tide-text",children:"OIDC/SSO Authentication"}),e.jsx("div",{className:"text-sm text-tide-text-muted",children:"Single Sign-On with OAuth2/OpenID Connect"})]})]})})]})]})]}):e.jsxs("div",{className:"space-y-4",children:[f&&e.jsxs("div",{className:"flex items-center gap-3 px-4 py-3 bg-tide-bg rounded-lg",children:[e.jsx(Le,{className:"w-5 h-5 text-teal-500"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-tide-text",children:f.username}),e.jsx("p",{className:"text-xs text-tide-text-muted",children:f.email})]}),e.jsx("span",{className:"px-2 py-1 bg-teal-500/10 text-teal-500 rounded text-xs font-medium",children:f.auth_method==="oidc"?`SSO (${f.oidc_provider})`:"Local"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx("button",{onClick:()=>de(!0),className:"px-4 py-2 bg-tide-bg hover:bg-tide-surface-light text-tide-text border border-tide-border rounded-lg font-medium transition-colors text-sm",children:"Edit Profile"}),f?.auth_method==="local"&&e.jsx("button",{onClick:()=>ce(!0),className:"px-4 py-2 bg-tide-bg hover:bg-tide-surface-light text-tide-text border border-tide-border rounded-lg font-medium transition-colors text-sm",children:"Change Password"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("button",{onClick:()=>Ie(!0),className:"px-4 py-2 bg-tide-bg hover:bg-tide-surface-light text-tide-text border border-tide-border rounded-lg font-medium transition-colors text-sm flex items-center justify-center gap-2",children:[e.jsx(H,{className:"w-4 h-4"}),"OIDC/SSO"]}),e.jsx("button",{onClick:async()=>{if(confirm("Are you sure you want to disable authentication? All API endpoints will become publicly accessible."))try{await p.settings.update("auth_mode","none"),r.success("Authentication disabled. Refreshing..."),setTimeout(()=>window.location.reload(),1e3)}catch{r.error("Failed to disable authentication")}},className:"px-4 py-2 bg-red-500/10 hover:bg-red-500/20 text-red-500 border border-red-500/30 rounded-lg font-medium transition-colors text-sm",children:"Disable Auth"})]})]})]}),e.jsxs("div",{className:"bg-tide-surface rounded-lg p-6 break-inside-avoid",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(be,{className:"w-6 h-6 text-teal-500"}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-tide-text",children:"Timezone"}),e.jsx("p",{className:"text-sm text-tide-text-muted mt-0.5",children:"Set system timezone for schedules and timestamps"})]})]}),e.jsx(N,{content:"Affects log timestamps and scheduled task times. Use the dropdown for common timezones or enter a custom IANA identifier (e.g., America/Phoenix). Changes apply immediately to new timestamps."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-tide-text mb-2",children:"Timezone"}),e.jsxs("select",{value:String(s.timezone||"UTC"),onChange:t=>m("timezone",t.target.value),className:"w-full bg-tide-surface text-tide-text rounded px-3 py-2 border border-tide-border-light focus:border-blue-500 focus:outline-none",children:[e.jsx("option",{value:"UTC",children:"UTC"}),e.jsx("option",{value:"America/New_York",children:"America/New_York (EST/EDT)"}),e.jsx("option",{value:"America/Chicago",children:"America/Chicago (CST/CDT)"}),e.jsx("option",{value:"America/Denver",children:"America/Denver (MST/MDT)"}),e.jsx("option",{value:"America/Los_Angeles",children:"America/Los_Angeles (PST/PDT)"}),e.jsx("option",{value:"Europe/London",children:"Europe/London"}),e.jsx("option",{value:"Europe/Paris",children:"Europe/Paris"}),e.jsx("option",{value:"Asia/Tokyo",children:"Asia/Tokyo"}),e.jsx("option",{value:"Asia/Shanghai",children:"Asia/Shanghai"}),e.jsx("option",{value:"Australia/Sydney",children:"Australia/Sydney"})]}),e.jsx("p",{className:"text-xs text-tide-text-muted mt-1",children:"Used for displaying times and scheduling updates"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-tide-text mb-2",children:"Custom Timezone (IANA format)"}),e.jsx("input",{type:"text",placeholder:"e.g., America/Phoenix",value:String(s.timezone||""),onChange:t=>m("timezone",t.target.value),className:"w-full bg-tide-surface text-tide-text rounded px-3 py-2 border border-tide-border-light focus:border-blue-500 focus:outline-none"}),e.jsx("p",{className:"text-xs text-tide-text-muted mt-1",children:"Override with any IANA timezone identifier"})]})]})]})]})]})]}),i==="updates"&&e.jsxs("div",{className:"space-y-6",children:[!Ft&&B&&e.jsx("div",{className:"bg-tide-surface/50 border border-tide-border rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(w,{className:`w-5 h-5 ${B.running?"text-green-500":"text-tide-text-muted"}`}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-tide-text",children:"Update Scheduler"}),e.jsx("p",{className:"text-xs text-tide-text-muted",children:"Background update checking service"})]})]}),e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-xs text-tide-text-muted",children:"Status"}),e.jsx("p",{className:"text-sm font-medium text-tide-text",children:B.running?e.jsx("span",{className:"text-green-500",children:" Running"}):e.jsx("span",{className:"text-tide-text-muted",children:" Paused"})})]}),!!B.next_run&&e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-xs text-tide-text-muted",children:"Next Run"}),e.jsx("p",{className:"text-sm font-medium text-tide-text",children:V(new Date(String(B.next_run)),{addSuffix:!0})})]}),!!B.last_check&&e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-xs text-tide-text-muted",children:"Last Check"}),e.jsx("p",{className:"text-sm font-medium text-tide-text",children:V(new Date(String(B.last_check)),{addSuffix:!0})})]})]})]})}),v.length>0&&e.jsx("div",{className:"space-y-4",children:v.filter(t=>t.category==="updates"||t.category==="cleanup").map(t=>{const o=ue(t.category),x=Q.has(t.category);return e.jsxs("div",{className:"bg-tide-surface/50 rounded-lg border border-tide-border",children:[e.jsxs("button",{onClick:()=>me(t.category),className:"w-full flex items-center justify-between p-4 hover:bg-tide-surface/70 transition-colors rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(o,{className:"w-5 h-5 text-teal-400"}),e.jsxs("div",{className:"text-left",children:[e.jsx("h3",{className:"text-sm font-semibold text-tide-text",children:he(t.category)}),e.jsxs("p",{className:"text-xs text-tide-text-muted mt-0.5",children:[t.settings.length," ",t.settings.length===1?"setting":"settings"]})]})]}),x?e.jsx(Y,{className:"w-5 h-5 text-tide-text-muted"}):e.jsx(K,{className:"w-5 h-5 text-tide-text-muted"})]}),!x&&e.jsx("div",{className:"p-4 pt-0 space-y-4",children:t.settings.map(a=>e.jsx("div",{className:"bg-tide-surface/50 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-sm font-medium text-tide-text",children:a.key.split("_").map(b=>b.charAt(0).toUpperCase()+b.slice(1)).join(" ")}),a.description&&e.jsx("p",{className:"text-xs text-tide-text-muted mt-1",children:a.description})]}),e.jsxs("div",{className:"flex-shrink-0",children:[typeof s[a.key]=="boolean"&&e.jsx("button",{type:"button",onClick:()=>m(a.key,!s[a.key]),disabled:l,className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none ${s[a.key]?"bg-teal-500":"bg-red-500"}`,children:e.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${s[a.key]?"translate-x-6":"translate-x-1"}`})}),typeof s[a.key]!="boolean"&&e.jsx("input",{type:typeof s[a.key]=="number"?"number":"text",value:String(s[a.key]||""),onChange:b=>{const P=typeof s[a.key]=="number"?parseInt(b.target.value)||0:b.target.value;g(a.key,String(P))},disabled:l,className:"w-48 bg-tide-surface text-tide-text text-sm rounded px-3 py-1.5 border border-tide-border-light focus:border-teal-500 focus:outline-none"})]})]})},a.key))})]},t.category)})}),v.length===0&&e.jsxs("div",{className:"columns-1 xl:columns-2 gap-6",style:{columnGap:"1.5rem"},children:[e.jsxs("div",{className:"bg-tide-surface rounded-lg p-6 break-inside-avoid mb-6 border border-tide-border",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(W,{className:"w-6 h-6 text-teal-500"}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-tide-text",children:"Update Checks"}),e.jsx("p",{className:"text-sm text-tide-text-muted mt-0.5",children:"Configure how often to check for updates"})]})]}),e.jsx(N,{content:"Controls automatic update checking. The schedule uses cron syntax (e.g., '0 */6 * * *' checks every 6 hours). Disable to manually trigger checks only."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-tide-text",children:"Check Enabled"}),e.jsx("p",{className:"text-xs text-tide-text-muted mt-1",children:"Automatically check for container image updates"})]}),e.jsx("button",{type:"button",onClick:()=>m("check_enabled",!s.check_enabled),disabled:l,className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none ${s.check_enabled?"bg-teal-500":"bg-red-500"}`,children:e.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${s.check_enabled?"translate-x-6":"translate-x-1"}`})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-tide-text mb-2",children:"Check Schedule"}),e.jsx("input",{type:"text",value:String(s.check_schedule||""),onChange:t=>g("check_schedule",t.target.value),disabled:l,className:"w-full bg-tide-surface text-tide-text rounded px-3 py-2 border border-tide-border-light focus:border-blue-500 focus:outline-none",placeholder:"0 */6 * * *"}),e.jsx("p",{className:"text-xs text-tide-text-muted mt-1",children:"Cron expression for update checks"})]})]})]}),e.jsxs("div",{className:"bg-tide-surface rounded-lg p-6 break-inside-avoid mb-6 border border-tide-border",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(D,{className:"w-6 h-6 text-green-500"}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-tide-text",children:"Automatic Updates"}),e.jsx("p",{className:"text-sm text-tide-text-muted mt-0.5",children:"Configure automatic update behavior"})]})]}),e.jsx(N,{content:"When enabled, approved updates are applied automatically. Max concurrent limits how many containers update simultaneously to reduce system load and allow rollback if issues occur."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-tide-text",children:"Auto Update Enabled"}),e.jsx("p",{className:"text-xs text-tide-text-muted mt-1",children:"Automatically apply approved updates"})]}),e.jsx("button",{type:"button",onClick:()=>m("auto_update_enabled",!s.auto_update_enabled),disabled:l,className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none ${s.auto_update_enabled?"bg-teal-500":"bg-red-500"}`,children:e.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${s.auto_update_enabled?"translate-x-6":"translate-x-1"}`})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("label",{className:"block text-sm font-medium text-tide-text",children:"Max Concurrent Updates"}),e.jsx("span",{className:"text-sm text-tide-text-muted",children:String(s.auto_update_max_concurrent||3)})]}),e.jsx("input",{type:"range",min:"1",max:"10",value:String(Number(s.auto_update_max_concurrent||3)),onChange:t=>m("auto_update_max_concurrent",parseInt(t.target.value)),disabled:l,className:"w-full h-2 bg-tide-bg rounded-lg appearance-none cursor-pointer accent-teal-500"}),e.jsx("p",{className:"text-xs text-tide-text-muted mt-1",children:"Maximum number of updates to auto-apply per run (rate limiting)"})]})]})]}),e.jsxs("div",{className:"bg-tide-surface rounded-lg p-6 break-inside-avoid mb-6 border border-tide-border",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(W,{className:"w-6 h-6 text-orange-500"}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-tide-text",children:"Retry Configuration"}),e.jsx("p",{className:"text-sm text-tide-text-muted mt-0.5",children:"Configure automatic retry behavior for failed updates"})]})]}),e.jsx(N,{content:"Failed updates retry automatically with exponential backoff. The multiplier controls delay increase between attempts (e.g., 3x: 5min  15min  45min). Set max attempts to 0 to disable retries."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("label",{className:"block text-sm font-medium text-tide-text",children:"Max Retry Attempts"}),e.jsx("span",{className:"text-sm text-tide-text-muted",children:String(s.update_retry_max_attempts||4)})]}),e.jsx("input",{type:"range",min:"0",max:"10",value:String(Number(s.update_retry_max_attempts||4)),onChange:t=>m("update_retry_max_attempts",parseInt(t.target.value)),disabled:l,className:"w-full h-2 bg-tide-bg rounded-lg appearance-none cursor-pointer accent-teal-500"}),e.jsx("p",{className:"text-xs text-tide-text-muted mt-1",children:"Maximum number of automatic retry attempts (0-10)"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("label",{className:"block text-sm font-medium text-tide-text",children:"Backoff Multiplier"}),e.jsx("span",{className:"text-sm text-tide-text-muted",children:String(s.update_retry_backoff_multiplier||3)})]}),e.jsx("input",{type:"range",min:"1",max:"10",step:"0.5",value:String(Number(s.update_retry_backoff_multiplier||3)),onChange:t=>m("update_retry_backoff_multiplier",parseFloat(t.target.value)),disabled:l,className:"w-full h-2 bg-tide-bg rounded-lg appearance-none cursor-pointer accent-teal-500"}),e.jsx("p",{className:"text-xs text-tide-text-muted mt-1",children:"Exponential backoff multiplier for retry delays (1.0-5min, 15min, 1hr, 4hr)"})]})]})]}),e.jsxs("div",{className:"bg-tide-surface rounded-lg p-6 break-inside-avoid mb-6 border border-tide-border",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ns,{className:"w-6 h-6 text-teal-500"}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-tide-text",children:"Default Update Window"}),e.jsx("p",{className:"text-sm text-tide-text-muted mt-0.5",children:"Configure default time restrictions for updates"})]})]}),e.jsx(N,{content:"Restrict updates to specific times. Format: 'HH:MM-HH:MM' for daily windows or 'Day-Day:HH:MM-HH:MM' for specific days. Strict mode blocks all updates outside the window; Advisory mode only warns."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-tide-text mb-2",children:"Default Window"}),e.jsx("input",{type:"text",value:String(s.default_update_window||""),onChange:t=>g("default_update_window",t.target.value),disabled:l,className:"w-full bg-tide-surface text-tide-text rounded px-3 py-2 border border-tide-border-light focus:border-purple-500 focus:outline-none",placeholder:'Time range (e.g., "02:00-06:00")'}),e.jsx("p",{className:"text-xs text-tide-text-muted mt-1",children:'Time range when updates are allowed (e.g., "02:00-06:00" or "Sat-Sun:00:00-23:59")'})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-tide-text mb-2",children:"Window Enforcement"}),e.jsxs("select",{value:String(s.update_window_enforcement||"strict"),onChange:t=>m("update_window_enforcement",t.target.value),disabled:l,className:"w-full bg-tide-surface text-tide-text rounded px-3 py-2 border border-tide-border-light focus:border-purple-500 focus:outline-none",children:[e.jsx("option",{value:"strict",children:"Strict (never update outside window)"}),e.jsx("option",{value:"advisory",children:"Advisory (warn but allow)"})]}),e.jsx("p",{className:"text-xs text-tide-text-muted mt-1",children:"How strictly to enforce update windows"})]})]})]}),e.jsxs("div",{className:"bg-tide-surface rounded-lg p-6 break-inside-avoid mb-6 border border-tide-border",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(fe,{className:"w-6 h-6 text-orange-500"}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-tide-text",children:"Stale Container Detection"}),e.jsx("p",{className:"text-sm text-tide-text-muted mt-0.5",children:"Automatically detect inactive containers"})]})]}),e.jsx(N,{content:"Identifies containers that have been removed from compose files but still exist. The threshold sets how long before marking as stale. Excludes dev containers to avoid flagging temporary development instances."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-tide-text",children:"Enable Stale Detection"}),e.jsx("p",{className:"text-xs text-tide-text-muted mt-1",children:"Detect containers removed from compose files"})]}),e.jsx("button",{type:"button",onClick:()=>m("stale_detection_enabled",!s.stale_detection_enabled),disabled:l,className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none ${s.stale_detection_enabled?"bg-teal-500":"bg-red-500"}`,children:e.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${s.stale_detection_enabled?"translate-x-6":"translate-x-1"}`})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("label",{className:"block text-sm font-medium text-tide-text",children:"Stale Threshold (Days)"}),e.jsx("span",{className:"text-sm text-tide-text-muted",children:String(s.stale_detection_threshold_days||7)})]}),e.jsx("input",{type:"range",min:"1",max:"90",value:String(Number(s.stale_detection_threshold_days||7)),onChange:t=>m("stale_detection_threshold_days",parseInt(t.target.value)),disabled:l,className:"w-full h-2 bg-tide-bg rounded-lg appearance-none cursor-pointer accent-teal-500"}),e.jsx("p",{className:"text-xs text-tide-text-muted mt-1",children:"Days before container is marked stale"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-tide-text",children:"Exclude Dev Containers"}),e.jsx("p",{className:"text-xs text-tide-text-muted mt-1",children:"Skip containers ending in -dev from stale detection"})]}),e.jsx("button",{type:"button",onClick:()=>m("stale_detection_exclude_dev",!s.stale_detection_exclude_dev),disabled:l,className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none ${s.stale_detection_exclude_dev?"bg-teal-500":"bg-red-500"}`,children:e.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${s.stale_detection_exclude_dev?"translate-x-6":"translate-x-1"}`})})]})]})]}),e.jsxs("div",{className:"bg-tide-surface rounded-lg p-6 break-inside-avoid mb-6 border border-tide-border",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ge,{className:"w-6 h-6 text-teal-500"}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-tide-text",children:"Cleanup Policy"}),e.jsx("p",{className:"text-sm text-tide-text-muted mt-0.5",children:"Manage old container images"})]})]}),e.jsx(N,{content:"Controls Docker resource cleanup. Dangling removes only untagged images; Moderate adds exited containers; Aggressive includes unused images older than threshold. Exclude patterns protect matching containers/images from cleanup."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-tide-text",children:"Auto-Remove Old Images"}),e.jsx("p",{className:"text-xs text-tide-text-muted mt-1",children:"Remove old images after successful update"})]}),e.jsx("button",{type:"button",onClick:()=>m("cleanup_old_images",!s.cleanup_old_images),disabled:l,className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none ${s.cleanup_old_images?"bg-teal-500":"bg-red-500"}`,children:e.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${s.cleanup_old_images?"translate-x-6":"translate-x-1"}`})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("label",{className:"block text-sm font-medium text-tide-text",children:"Cleanup After Days"}),e.jsx("span",{className:"text-sm text-tide-text-muted",children:String(s.cleanup_after_days||7)})]}),e.jsx("input",{type:"range",min:"0",max:"90",value:String(Number(s.cleanup_after_days||7)),onChange:t=>m("cleanup_after_days",parseInt(t.target.value)),disabled:l,className:"w-full h-2 bg-tide-bg rounded-lg appearance-none cursor-pointer accent-teal-500"}),e.jsx("p",{className:"text-xs text-tide-text-muted mt-1",children:"Days to keep old images before cleanup in aggressive mode"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-tide-text mb-2",children:"Cleanup Mode"}),e.jsxs("select",{value:String(s.cleanup_mode||"dangling"),onChange:t=>m("cleanup_mode",t.target.value),disabled:l,className:"w-full px-3 py-2 bg-tide-bg border border-tide-border rounded-lg text-tide-text focus:outline-none focus:ring-2 focus:ring-teal-500",children:[e.jsx("option",{value:"dangling",children:"Dangling - Untagged images only"}),e.jsx("option",{value:"moderate",children:"Moderate - + Exited containers"}),e.jsx("option",{value:"aggressive",children:"Aggressive - + Old unused images"})]}),e.jsx("p",{className:"text-xs text-tide-text-muted mt-1",children:"How aggressively to clean up Docker resources"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-tide-text",children:"Cleanup Containers"}),e.jsx("p",{className:"text-xs text-tide-text-muted mt-1",children:"Also remove exited/dead containers during cleanup"})]}),e.jsx("button",{type:"button",onClick:()=>m("cleanup_containers",s.cleanup_containers===!1?!0:!s.cleanup_containers),disabled:l,className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none ${s.cleanup_containers!==!1?"bg-teal-500":"bg-red-500"}`,children:e.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${s.cleanup_containers!==!1?"translate-x-6":"translate-x-1"}`})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-tide-text mb-2",children:"Cleanup Schedule"}),e.jsx("input",{type:"text",value:String(s.cleanup_schedule||"0 4 * * *"),onChange:t=>m("cleanup_schedule",t.target.value),disabled:l,placeholder:"0 4 * * *",className:"w-full px-3 py-2 bg-tide-bg border border-tide-border rounded-lg text-tide-text focus:outline-none focus:ring-2 focus:ring-teal-500 font-mono text-sm"}),e.jsx("p",{className:"text-xs text-tide-text-muted mt-1",children:"Cron schedule for automatic cleanup (default: 4 AM daily)"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-tide-text mb-2",children:"Exclude Patterns"}),e.jsx("input",{type:"text",value:String(s.cleanup_exclude_patterns||"-dev,rollback"),onChange:t=>m("cleanup_exclude_patterns",t.target.value),disabled:l,placeholder:"-dev,rollback",className:"w-full px-3 py-2 bg-tide-bg border border-tide-border rounded-lg text-tide-text focus:outline-none focus:ring-2 focus:ring-teal-500"}),e.jsx("p",{className:"text-xs text-tide-text-muted mt-1",children:"Comma-separated patterns to exclude (e.g., -dev,rollback)"})]}),e.jsxs("div",{className:"pt-2 border-t border-tide-border",children:[e.jsxs("button",{type:"button",onClick:async()=>{try{const o=await(await fetch("/api/v1/cleanup/run-now",{method:"POST"})).json();o.success?r.success(o.message||`Removed ${o.images_removed||0} images and ${o.containers_removed||0} containers, reclaimed ${o.space_reclaimed_formatted||"0 B"}`,{duration:5e3}):r.error("Cleanup failed: "+(o.message||"Unknown error"))}catch(t){r.error("Failed to run cleanup: "+(t instanceof Error?t.message:"Unknown error"))}},disabled:l,className:"w-full px-4 py-2 bg-teal-600 hover:bg-teal-700 text-white rounded-lg transition-colors flex items-center justify-center gap-2",children:[e.jsx(ge,{className:"w-4 h-4"}),"Run Cleanup Now"]}),e.jsx("p",{className:"text-xs text-tide-text-muted mt-2 text-center",children:"Trigger immediate cleanup using current settings"})]})]})]})]})]}),i==="docker"&&e.jsxs("div",{className:"space-y-6",children:[v.length>0&&e.jsx("div",{className:"space-y-4",children:v.filter(t=>t.category==="docker"||t.category==="registry").map(t=>{const o=ue(t.category),x=Q.has(t.category);return e.jsxs("div",{className:"bg-tide-surface/50 rounded-lg border border-tide-border",children:[e.jsxs("button",{onClick:()=>me(t.category),className:"w-full flex items-center justify-between p-4 hover:bg-tide-surface/70 transition-colors rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(o,{className:"w-5 h-5 text-teal-400"}),e.jsxs("div",{className:"text-left",children:[e.jsx("h3",{className:"text-sm font-semibold text-tide-text",children:he(t.category)}),e.jsxs("p",{className:"text-xs text-tide-text-muted mt-0.5",children:[t.settings.length," ",t.settings.length===1?"setting":"settings"]})]})]}),x?e.jsx(Y,{className:"w-5 h-5 text-tide-text-muted"}):e.jsx(K,{className:"w-5 h-5 text-tide-text-muted"})]}),!x&&e.jsx("div",{className:"p-4 pt-0 space-y-4",children:t.settings.map(a=>e.jsx("div",{className:"bg-tide-surface/50 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("label",{className:"block text-sm font-medium text-tide-text",children:[a.key.split("_").map(b=>b.charAt(0).toUpperCase()+b.slice(1)).join(" "),a.encrypted&&e.jsx("span",{className:"text-xs text-tide-text-muted bg-tide-surface px-1.5 py-0.5 rounded ml-2",children:"Encrypted"})]}),a.description&&e.jsx("p",{className:"text-xs text-tide-text-muted mt-1",children:a.description})]}),e.jsxs("div",{className:"flex-shrink-0",children:[typeof s[a.key]=="boolean"&&e.jsx("button",{type:"button",onClick:()=>m(a.key,!s[a.key]),disabled:l,className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none ${s[a.key]?"bg-teal-500":"bg-red-500"}`,children:e.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${s[a.key]?"translate-x-6":"translate-x-1"}`})}),typeof s[a.key]!="boolean"&&e.jsx("input",{type:a.encrypted?"password":typeof s[a.key]=="number"?"number":"text",value:String(s[a.key]||""),onChange:b=>{const P=typeof s[a.key]=="number"?parseInt(b.target.value)||0:b.target.value;g(a.key,String(P))},disabled:l,className:"w-48 bg-tide-surface text-tide-text text-sm rounded px-3 py-1.5 border border-tide-border-light focus:border-teal-500 focus:outline-none"})]})]})},a.key))})]},t.category)})}),v.length===0&&e.jsxs("div",{className:"columns-1 xl:columns-2 gap-6",style:{columnGap:"1.5rem"},children:[e.jsxs("div",{className:"bg-tide-surface rounded-lg p-6 break-inside-avoid mb-6 border border-tide-border",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(be,{className:"w-6 h-6 text-teal-500"}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-tide-text",children:"Registry Authentication"}),e.jsx("p",{className:"text-sm text-tide-text-muted mt-0.5",children:"Configure registry credentials"})]})]}),e.jsx(N,{content:"Registry credentials are optional but recommended to avoid rate limits. Docker Hub tokens can be created at hub.docker.com/settings/security. GitHub PATs need read:packages scope for GHCR access. Credentials are stored encrypted in the database."})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-tide-text mb-3",children:"Docker Hub"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-tide-text mb-2",children:"Username"}),e.jsx("input",{type:"text",value:String(s.dockerhub_username||""),onChange:t=>g("dockerhub_username",t.target.value),disabled:l,className:"w-full bg-tide-surface text-tide-text rounded px-3 py-2 border border-tide-border-light focus:border-blue-500 focus:outline-none"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("label",{className:"block text-sm font-medium text-tide-text mb-2 flex items-center gap-2",children:["Token",e.jsx("span",{className:"text-xs text-tide-text-muted bg-tide-surface px-1.5 py-0.5 rounded",children:"Encrypted"})]}),e.jsx("input",{type:"password",value:String(s.dockerhub_token||""),onChange:t=>g("dockerhub_token",t.target.value),disabled:l,className:"w-full bg-tide-surface text-tide-text rounded px-3 py-2 border border-tide-border-light focus:border-blue-500 focus:outline-none"})]}),e.jsxs("button",{type:"button",onClick:()=>$("dockerhub"),disabled:ve||l,className:"mt-7 px-4 py-2 bg-tide-surface hover:bg-tide-surface-light text-tide-text rounded-lg text-sm flex items-center gap-2 transition-colors disabled:opacity-50 border border-tide-border",children:[ve?e.jsx(w,{className:"w-4 h-4 animate-spin"}):e.jsx(D,{className:"w-4 h-4"}),ve?"Testing...":"Test Connection"]})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-tide-text mb-3",children:"GitHub (GHCR)"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-tide-text mb-2",children:"Username"}),e.jsx("input",{type:"text",value:String(s.ghcr_username||""),onChange:t=>g("ghcr_username",t.target.value),disabled:l,className:"w-full bg-tide-surface text-tide-text rounded px-3 py-2 border border-tide-border-light focus:border-blue-500 focus:outline-none"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("label",{className:"block text-sm font-medium text-tide-text mb-2 flex items-center gap-2",children:["Token",e.jsx("span",{className:"text-xs text-tide-text-muted bg-tide-surface px-1.5 py-0.5 rounded",children:"Encrypted"})]}),e.jsx("input",{type:"password",value:String(s.ghcr_token||""),onChange:t=>g("ghcr_token",t.target.value),disabled:l,className:"w-full bg-tide-surface text-tide-text rounded px-3 py-2 border border-tide-border-light focus:border-blue-500 focus:outline-none"})]}),e.jsxs("button",{type:"button",onClick:()=>$("ghcr"),disabled:we||l,className:"mt-7 px-4 py-2 bg-tide-surface hover:bg-tide-surface-light text-tide-text rounded-lg text-sm flex items-center gap-2 transition-colors disabled:opacity-50 border border-tide-border",children:[we?e.jsx(w,{className:"w-4 h-4 animate-spin"}):e.jsx(D,{className:"w-4 h-4"}),we?"Testing...":"Test Connection"]})]})]})]})]})]}),e.jsxs("div",{className:"bg-tide-surface rounded-lg p-6 break-inside-avoid mb-6 border border-tide-border",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(pe,{className:"w-6 h-6 text-teal-500"}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-tide-text",children:"Docker Configuration"}),e.jsx("p",{className:"text-sm text-tide-text-muted mt-0.5",children:"Configure Docker daemon connection"})]})]}),e.jsx(N,{content:"Docker socket enables TideWatch to monitor and update containers. Compose directory should contain all your docker-compose.yml files. The compose command template supports placeholders: {compose_file}, {env_file}, {service}."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-tide-text mb-2",children:"Compose Directory"}),e.jsx("input",{type:"text",value:String(s.compose_directory||""),onChange:t=>g("compose_directory",t.target.value),disabled:l,placeholder:"/compose",className:"w-full bg-tide-surface text-tide-text rounded px-3 py-2 border border-tide-border-light focus:border-blue-500 focus:outline-none"}),e.jsx("p",{className:"text-xs text-tide-text-muted mt-1",children:"Directory containing docker-compose files"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-tide-text mb-2",children:"Docker Compose Command"}),e.jsx("input",{type:"text",value:String(s.docker_compose_command||""),onChange:t=>g("docker_compose_command",t.target.value),disabled:l,placeholder:"docker compose -p homelab -f /compose/base.yml -f /compose/backup.yml",className:"w-full bg-tide-surface text-tide-text rounded px-3 py-2 border border-tide-border-light focus:border-blue-500 focus:outline-none"}),e.jsxs("p",{className:"text-xs text-tide-text-muted mt-1",children:["Docker compose command template. Use ","{compose_file}",", ","{env_file}",", ","{service}"," placeholders"]})]})]})]}),e.jsxs("div",{className:"bg-tide-surface rounded-lg p-6 break-inside-avoid mb-6 border border-tide-border",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(rs,{className:"w-6 h-6 text-yellow-500"}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-tide-text",children:"My Projects Configuration"}),e.jsx("p",{className:"text-sm text-tide-text-muted mt-0.5",children:"Manage dev containers and dependency tracking"})]})]}),e.jsx(N,{content:"My Projects groups dev containers separately on the Dashboard. Auto-scan discovers containers from {projects_directory}/*/compose.yaml files. Dependencies tab scans package.json, pyproject.toml, etc. You can also manually mark any container as 'My Project' in its Settings tab."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-tide-text",children:"Enable My Projects"}),e.jsx("p",{className:"text-xs text-tide-text-muted mt-1",children:"Show My Project toggle and Dependencies tab for dev containers"})]}),e.jsx("button",{type:"button",onClick:()=>m("my_projects_enabled",!s.my_projects_enabled),disabled:l,className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none ${s.my_projects_enabled?"bg-teal-500":"bg-red-500"}`,children:e.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${s.my_projects_enabled?"translate-x-6":"translate-x-1"}`})})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-tide-text mb-2 flex items-center gap-2",children:[e.jsx(ds,{className:"w-4 h-4"}),"Projects Directory"]}),e.jsx("input",{type:"text",value:String(s.projects_directory||""),onChange:t=>g("projects_directory",t.target.value),disabled:l||!s.my_projects_enabled,placeholder:"/projects",className:"w-full bg-tide-surface text-tide-text rounded px-3 py-2 border border-tide-border-light focus:border-blue-500 focus:outline-none disabled:opacity-50"}),e.jsx("p",{className:"text-xs text-tide-text-muted mt-1",children:"Directory containing project source code (mounted into Tidewatch)"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-tide-text",children:"Auto-Scan Projects"}),e.jsx("p",{className:"text-xs text-tide-text-muted mt-1",children:"Automatically discover dev containers on startup"})]}),e.jsx("button",{type:"button",onClick:()=>m("my_projects_auto_scan",!s.my_projects_auto_scan),disabled:l||!s.my_projects_enabled,className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none disabled:opacity-50 ${s.my_projects_auto_scan?"bg-teal-500":"bg-red-500"}`,children:e.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${s.my_projects_auto_scan?"translate-x-6":"translate-x-1"}`})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-tide-text mb-2",children:"My Projects Docker Compose Command"}),e.jsx("input",{type:"text",value:String(s.my_projects_compose_command||""),onChange:t=>g("my_projects_compose_command",t.target.value),disabled:l||!s.my_projects_enabled,placeholder:"docker compose",className:"w-full bg-tide-surface text-tide-text rounded px-3 py-2 border border-tide-border-light focus:border-blue-500 focus:outline-none disabled:opacity-50"}),e.jsxs("p",{className:"text-xs text-tide-text-muted mt-1",children:["Simple Docker Compose command for dev containers (use ","{compose_file}",", ","{service}"," placeholders)"]})]}),e.jsxs("div",{className:"pt-2",children:[e.jsx("button",{type:"button",onClick:Xt,disabled:Ke||!s.my_projects_enabled,className:"w-full px-4 py-2 bg-teal-600 hover:bg-teal-700 text-tide-text rounded-lg font-medium flex items-center justify-center gap-2 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:Ke?e.jsxs(e.Fragment,{children:[e.jsx(w,{className:"w-4 h-4 animate-spin"}),"Scanning Projects..."]}):e.jsxs(e.Fragment,{children:[e.jsx(cs,{className:"w-4 h-4"}),"Scan Projects Now"]})}),e.jsxs("p",{className:"text-xs text-tide-text-muted mt-2 text-center",children:["Manually scan ",String(s.projects_directory||"/projects")," for dev containers"]})]})]})]}),e.jsxs("div",{className:"bg-tide-surface rounded-lg p-6 break-inside-avoid mb-6 border border-tide-border",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(os,{className:"w-6 h-6 text-primary"}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-tide-text",children:"Dockerfile Dependency Tracking"}),e.jsx("p",{className:"text-sm text-tide-text-muted mt-0.5",children:"Automatically track base and build images in Dockerfiles"})]})]}),e.jsx(N,{content:"Scans FROM statements in Dockerfiles to track base and build images, including multi-stage builds. Checks for updated image tags on schedule. View Dockerfile dependencies in the Dependencies tab (My Projects). Notifications sent when updates are available."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-tide-text",children:"Auto-Scan Dockerfiles"}),e.jsx("p",{className:"text-xs text-tide-text-muted mt-1",children:"Automatically scan Dockerfiles when containers are added"})]}),e.jsx("button",{type:"button",onClick:()=>m("dockerfile_auto_scan",!s.dockerfile_auto_scan),disabled:l,className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none ${s.dockerfile_auto_scan?"bg-teal-500":"bg-red-500"}`,children:e.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${s.dockerfile_auto_scan?"translate-x-6":"translate-x-1"}`})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-tide-text mb-2",children:"Update Check Schedule"}),e.jsxs("select",{value:String(s.dockerfile_scan_schedule||"daily"),onChange:t=>m("dockerfile_scan_schedule",t.target.value),disabled:l,className:"w-full bg-tide-surface text-tide-text rounded px-3 py-2 border border-tide-border-light focus:border-blue-500 focus:outline-none disabled:opacity-50",children:[e.jsx("option",{value:"disabled",children:"Disabled"}),e.jsx("option",{value:"daily",children:"Daily (3 AM)"}),e.jsx("option",{value:"weekly",children:"Weekly (Sunday 3 AM)"})]}),e.jsx("p",{className:"text-xs text-tide-text-muted mt-1",children:"How often to check for updated base/build images"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-tide-text mb-2",children:"Manual Update Check"}),e.jsxs("button",{onClick:async()=>{try{const t=await p.containers.checkAllDockerfileUpdates();r.success(`Checked ${t.total_scanned} Dockerfiles, found ${t.updates_found} updates`)}catch{r.error("Failed to check Dockerfile updates")}},className:"px-4 py-2 bg-primary hover:bg-primary-dark text-tide-text rounded-lg font-medium transition-colors flex items-center gap-2",children:[e.jsx(w,{size:16}),"Check All Dockerfile Updates"]}),e.jsx("p",{className:"text-xs text-tide-text-muted mt-1",children:"Manually trigger an update check for all tracked Dockerfiles"})]})]})]})]})]}),i==="integrations"&&e.jsxs("div",{className:"space-y-6",children:[v.length>0&&e.jsx("div",{className:"space-y-4",children:v.filter(t=>t.category==="integrations").map(t=>{const o=ue(t.category),x=Q.has(t.category);return e.jsxs("div",{className:"bg-tide-surface/50 rounded-lg border border-tide-border",children:[e.jsxs("button",{onClick:()=>me(t.category),className:"w-full flex items-center justify-between p-4 hover:bg-tide-surface/70 transition-colors rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(o,{className:"w-5 h-5 text-teal-400"}),e.jsxs("div",{className:"text-left",children:[e.jsx("h3",{className:"text-sm font-semibold text-tide-text",children:he(t.category)}),e.jsxs("p",{className:"text-xs text-tide-text-muted mt-0.5",children:[t.settings.length," ",t.settings.length===1?"setting":"settings"]})]})]}),x?e.jsx(Y,{className:"w-5 h-5 text-tide-text-muted"}):e.jsx(K,{className:"w-5 h-5 text-tide-text-muted"})]}),!x&&e.jsx("div",{className:"p-4 pt-0 space-y-4",children:t.settings.map(a=>e.jsx("div",{className:"bg-tide-surface/50 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("label",{className:"block text-sm font-medium text-tide-text",children:[a.key.split("_").map(b=>b.charAt(0).toUpperCase()+b.slice(1)).join(" "),a.encrypted&&e.jsx("span",{className:"text-xs text-tide-text-muted bg-tide-surface px-1.5 py-0.5 rounded ml-2",children:"Encrypted"})]}),a.description&&e.jsx("p",{className:"text-xs text-tide-text-muted mt-1",children:a.description})]}),e.jsxs("div",{className:"flex-shrink-0",children:[typeof s[a.key]=="boolean"&&e.jsx("button",{type:"button",onClick:()=>m(a.key,!s[a.key]),disabled:l,className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none ${s[a.key]?"bg-teal-500":"bg-red-500"}`,children:e.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${s[a.key]?"translate-x-6":"translate-x-1"}`})}),typeof s[a.key]!="boolean"&&e.jsx("input",{type:a.encrypted?"password":typeof s[a.key]=="number"?"number":"text",value:String(s[a.key]||""),onChange:b=>{const P=typeof s[a.key]=="number"?parseInt(b.target.value)||0:b.target.value;g(a.key,String(P))},disabled:l,className:"w-48 bg-tide-surface text-tide-text text-sm rounded px-3 py-1.5 border border-tide-border-light focus:border-teal-500 focus:outline-none"})]})]})},a.key))})]},t.category)})}),v.length===0&&e.jsx("div",{className:"columns-1 xl:columns-2 gap-6",style:{columnGap:"1.5rem"},children:e.jsxs("div",{className:"bg-tide-surface rounded-lg p-6 break-inside-avoid mb-6 border border-tide-border",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ue,{className:"w-6 h-6 text-teal-500"}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-tide-text",children:"VulnForge Integration"}),e.jsx("p",{className:"text-sm text-tide-text-muted mt-0.5",children:"Vulnerability scanning with authentication"})]})]}),e.jsx(N,{content:"VulnForge URL should point to your VulnForge instance (e.g., http://vulnforge:8787). API key authentication is required for external access. Use 'None' for internal/trusted network access only. Test connection after changing authentication settings."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-tide-text",children:"Enable Integration"}),e.jsx("p",{className:"text-xs text-tide-text-muted mt-1",children:"Enable VulnForge vulnerability scanning"})]}),e.jsx("button",{type:"button",onClick:()=>m("vulnforge_enabled",!s.vulnforge_enabled),disabled:l,className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none ${s.vulnforge_enabled?"bg-teal-500":"bg-red-500"}`,children:e.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${s.vulnforge_enabled?"translate-x-6":"translate-x-1"}`})})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-sm font-medium text-tide-text mb-2",children:"VulnForge URL"}),e.jsx("input",{type:"text",value:String(s.vulnforge_url||""),onChange:t=>g("vulnforge_url",t.target.value),disabled:l,placeholder:"http://vulnforge:8787",className:"w-full bg-tide-surface text-tide-text rounded px-3 py-2 border border-tide-border-light focus:border-blue-500 focus:outline-none"}),e.jsx("p",{className:"text-xs text-tide-text-muted mt-1",children:"URL to VulnForge instance"})]}),e.jsxs("button",{type:"button",onClick:()=>$("vulnforge"),disabled:ke,className:"mt-7 px-4 py-2 bg-tide-surface hover:bg-tide-surface-light text-tide-text rounded-lg text-sm flex items-center gap-2 transition-colors disabled:opacity-50 border border-tide-border",children:[ke?e.jsx(w,{className:"w-4 h-4 animate-spin"}):e.jsx(D,{className:"w-4 h-4"}),ke?"Testing...":"Test Connection"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-tide-text mb-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(A,{className:"w-4 h-4 text-teal-500"}),"Authentication"]})}),e.jsx("p",{className:"text-xs text-tide-text-muted mb-3",children:"Select authentication method"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 mb-4",children:[e.jsx("button",{type:"button",onClick:()=>m("vulnforge_auth_type","none"),disabled:l,className:`px-4 py-2 rounded text-sm font-medium transition-colors ${(s.vulnforge_auth_type||"none")==="none"?"bg-teal-500 text-tide-text":"bg-tide-surface text-tide-text hover:bg-tide-surface-light"}`,children:"None"}),e.jsx("button",{type:"button",onClick:()=>m("vulnforge_auth_type","api_key"),disabled:l,className:`px-4 py-2 rounded text-sm font-medium transition-colors ${s.vulnforge_auth_type==="api_key"?"bg-teal-500 text-tide-text":"bg-tide-surface text-tide-text hover:bg-tide-surface-light"}`,children:"API Key"})]}),(s.vulnforge_auth_type||"none")==="none"&&e.jsx("div",{className:"bg-teal-500/10 border border-teal-500/30 rounded p-3",children:e.jsx("p",{className:"text-xs text-teal-400",children:"No authentication configured. VulnForge will be accessed without credentials."})}),s.vulnforge_auth_type==="api_key"&&e.jsxs("div",{className:"mt-3",children:[e.jsx("label",{className:"block text-sm font-medium text-tide-text mb-2",children:"API Key"}),e.jsx("input",{type:"password",value:String(s.vulnforge_api_key||""),onChange:t=>g("vulnforge_api_key",t.target.value),disabled:l,className:"w-full bg-tide-surface text-tide-text rounded px-3 py-2 border border-tide-border-light focus:border-blue-500 focus:outline-none"})]})]}),e.jsxs("div",{className:"pt-4 border-t border-tide-border flex items-center gap-2",children:[e.jsx(A,{className:"w-4 h-4 text-teal-500"}),e.jsx("span",{className:"text-sm text-tide-text",children:"Learn more:"}),e.jsx(N,{content:"VulnForge scans container images for security vulnerabilities. Provides CVE tracking and vulnerability data comparisons. Enables security-driven update policies. Integration is optional but highly recommended for production use. Works with Docker Hub, GHCR, and custom registries."}),e.jsx("span",{className:"text-sm text-tide-text-muted",children:"About VulnForge"})]})]})]})})]}),i==="notifications"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx(fs,{activeSubTab:F,onSubTabChange:Dt,enabledServices:{ntfy:!!s.ntfy_enabled,gotify:!!s.gotify_enabled,pushover:!!s.pushover_enabled,slack:!!s.slack_enabled,discord:!!s.discord_enabled,telegram:!!s.telegram_enabled,email:!!s.email_enabled}}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[F==="ntfy"&&e.jsx(Ns,{settings:s,onSettingChange:m,onTextChange:g,onTest:()=>$("ntfy"),testing:pt,saving:l}),F==="gotify"&&e.jsx(ys,{settings:s,onSettingChange:m,onTextChange:g,onTest:()=>$("gotify"),testing:gt,saving:l}),F==="pushover"&&e.jsx(vs,{settings:s,onSettingChange:m,onTextChange:g,onTest:()=>$("pushover"),testing:Nt,saving:l}),F==="slack"&&e.jsx(ws,{settings:s,onSettingChange:m,onTextChange:g,onTest:()=>$("slack"),testing:vt,saving:l}),F==="discord"&&e.jsx(ks,{settings:s,onSettingChange:m,onTextChange:g,onTest:()=>$("discord"),testing:kt,saving:l}),F==="telegram"&&e.jsx(_s,{settings:s,onSettingChange:m,onTextChange:g,onTest:()=>$("telegram"),testing:Ct,saving:l}),F==="email"&&e.jsx(Cs,{settings:s,onSettingChange:m,onTextChange:g,onTest:()=>$("email"),testing:At,saving:l})]}),e.jsx(js,{settings:s,onSettingChange:m,onTextChange:g,saving:l,hasEnabledService:!!s.ntfy_enabled||!!s.gotify_enabled||!!s.pushover_enabled||!!s.slack_enabled||!!s.discord_enabled||!!s.telegram_enabled||!!s.email_enabled})]})]}),i==="backup"&&e.jsx("div",{className:"space-y-6",children:Et?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(w,{className:"w-8 h-8 animate-spin text-primary"})}):C?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-tide-surface rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(fe,{className:"w-6 h-6 text-primary"}),e.jsx("h2",{className:"text-xl font-semibold text-tide-text",children:"Database"})]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx("span",{className:"text-tide-text-muted",children:"Path:"}),e.jsx("span",{className:"font-mono text-tide-text text-right ml-4 break-all",children:C.stats.database_path})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-tide-text-muted",children:"Size:"}),e.jsxs("span",{className:"font-mono text-tide-text",children:[(C.stats.database_size/1024/1024).toFixed(2)," MB"]})]}),e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx("span",{className:"text-tide-text-muted",children:"Last Modified:"}),e.jsx("span",{className:"font-mono text-tide-text text-right ml-4",children:new Date(C.stats.database_modified).toLocaleString()})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-tide-text-muted",children:"Status:"}),e.jsx("span",{className:`font-mono ${C.stats.database_exists?"text-green-400":"text-red-400"}`,children:C.stats.database_exists?"Exists":"Missing"})]})]})]}),e.jsxs("div",{className:"bg-tide-surface rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(ge,{className:"w-6 h-6 text-primary"}),e.jsx("h2",{className:"text-xl font-semibold text-tide-text",children:"Backups"})]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-tide-text-muted",children:"Total Backups:"}),e.jsx("span",{className:"font-mono text-tide-text",children:C.stats.total_backups})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-tide-text-muted",children:"Total Size:"}),e.jsxs("span",{className:"font-mono text-tide-text",children:[(C.stats.total_size/1024/1024).toFixed(2)," MB"]})]}),e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx("span",{className:"text-tide-text-muted",children:"Directory:"}),e.jsx("span",{className:"font-mono text-tide-text text-right ml-4 break-all",children:C.stats.backup_directory})]})]})]})]}),e.jsxs("div",{className:"bg-tide-surface rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-xl font-semibold text-tide-text",children:"Backup Management"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("label",{className:`px-4 py-2 bg-tide-surface hover:bg-tide-surface-light text-tide-text rounded-lg text-sm flex items-center gap-2 transition-colors cursor-pointer border border-tide-border ${X?"opacity-50 cursor-not-allowed":""}`,children:[X?e.jsx(w,{className:"w-5 h-5 animate-spin"}):e.jsx(xs,{className:"w-5 h-5"}),X?"Uploading...":"Upload",e.jsx("input",{ref:Ce,accept:".json",className:"hidden",type:"file",onChange:Kt,disabled:X})]}),e.jsxs("button",{onClick:Vt,disabled:_e,className:"px-4 py-2 bg-primary hover:bg-primary/80 text-tide-text rounded-lg text-sm flex items-center gap-2 transition-colors disabled:opacity-50",children:[_e?e.jsx(w,{className:"w-5 h-5 animate-spin"}):e.jsx(ms,{className:"w-5 h-5"}),_e?"Creating...":"Create Backup"]})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-tide-surface/50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-tide-text-muted uppercase tracking-wider",children:"Filename"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-tide-text-muted uppercase tracking-wider",children:"Size"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-tide-text-muted uppercase tracking-wider",children:"Created"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-tide-text-muted uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-800",children:C.backups.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:"px-4 py-8 text-center text-tide-text-muted",children:"No backups found. Create your first backup to get started."})}):C.backups.map(t=>e.jsxs("tr",{className:"hover:bg-tide-surface/30 cursor-pointer transition-colors",children:[e.jsx("td",{className:"px-4 py-4 text-sm",children:e.jsxs("div",{className:"flex items-center gap-2",children:[t.is_safety&&e.jsx("span",{title:"Safety Backup",className:"flex-shrink-0",children:e.jsx(H,{className:"w-4 h-4 text-blue-400"})}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-mono text-tide-text",children:t.filename}),t.is_safety&&e.jsx("span",{className:"text-xs text-blue-400 mt-0.5",children:"Protected Safety Backup"})]})]})}),e.jsx("td",{className:"px-4 py-4 text-sm",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-mono text-tide-text",children:oe(t.size_bytes)}),e.jsxs("span",{className:"text-xs text-tide-text-muted mt-0.5",children:[t.size_mb.toFixed(2)," MB"]})]})}),e.jsx("td",{className:"px-4 py-4 text-sm",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-tide-text",children:V(new Date(t.created),{addSuffix:!0})}),e.jsx("span",{className:"text-xs text-tide-text-muted mt-0.5",children:new Date(t.created).toLocaleString()})]})}),e.jsx("td",{className:"px-4 py-4 text-sm text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx("button",{onClick:()=>Yt(t.filename),className:"p-2 text-primary hover:bg-primary/10 rounded transition-colors",title:"Download backup",children:e.jsx(us,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>qt(t),className:"p-2 text-orange-500 hover:bg-orange-500/10 rounded transition-colors",title:"Restore from backup",children:e.jsx(W,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>Zt(t),disabled:t.is_safety,className:"p-2 text-red-500 hover:bg-red-500/10 rounded transition-colors disabled:opacity-50 disabled:cursor-not-allowed",title:t.is_safety?"Safety backups cannot be deleted":"Delete backup",children:e.jsx(hs,{className:"w-4 h-4"})})]})})]},t.filename))})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-tide-surface/50 border border-tide-border rounded-lg p-4",children:[e.jsxs("h3",{className:"text-sm font-semibold text-tide-text mb-3 flex items-center gap-2",children:[e.jsx(A,{className:"w-4 h-4 text-blue-400"}),"Configuration Tips"]}),e.jsxs("ul",{className:"text-xs text-tide-text-muted space-y-1.5",children:[e.jsx("li",{children:" Create backups before major configuration changes"}),e.jsx("li",{children:" Backups include all settings and container metadata"}),e.jsx("li",{children:" Download backups to external storage for disaster recovery"}),e.jsx("li",{children:" Restoring creates a safety backup of current settings first"}),e.jsx("li",{children:" Regular backups help prevent data loss from misconfigurations"})]})]}),e.jsxs("div",{className:"bg-tide-surface/50 border border-tide-border rounded-lg p-4",children:[e.jsxs("h3",{className:"text-sm font-semibold text-tide-text mb-3 flex items-center gap-2",children:[e.jsx(A,{className:"w-4 h-4 text-blue-400"}),"About Backups"]}),e.jsxs("ul",{className:"text-xs text-tide-text-muted space-y-1.5",children:[e.jsxs("li",{children:[" Backups are stored in ",e.jsx("code",{className:"bg-tide-surface/50 px-1 rounded text-tide-text",children:"/data/backups"})," directory"]}),e.jsx("li",{children:" Backups include all TideWatch settings (credentials, configuration, policies)"}),e.jsxs("li",{children:[" Restoring creates an automatic ",e.jsx("span",{className:"text-blue-400",children:"safety backup"})," of current settings"]}),e.jsx("li",{children:" Safety backups are protected and cannot be deleted"}),e.jsx("li",{children:" Container and update history data is not included in backups"}),e.jsx("li",{children:" Encrypted values (API keys, tokens) remain encrypted in backups"})]})]})]})]}):e.jsxs("div",{className:"bg-tide-surface rounded-lg p-12 text-center",children:[e.jsx("p",{className:"text-tide-text-muted",children:"Failed to load backup information"}),e.jsx("button",{onClick:z,className:"mt-4 px-4 py-2 bg-primary hover:bg-primary/80 text-tide-text rounded-lg text-sm",children:"Retry"})]})})]})]}),$t&&T&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-tide-surface rounded-lg max-w-md w-full p-6 border border-tide-border",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-tide-text",children:"Delete Backup"}),e.jsx("button",{onClick:()=>{ee(!1),R(null)},className:"text-tide-text-muted hover:text-tide-text transition-colors",children:e.jsx(S,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-red-500/10 border border-red-500/20 rounded-lg p-4",children:[e.jsx("p",{className:"text-red-400 text-sm font-medium mb-2",children:"Warning: This action cannot be undone"}),e.jsx("p",{className:"text-tide-text text-sm",children:"Are you sure you want to delete this backup? Once deleted, it cannot be recovered."})]}),e.jsxs("div",{className:"space-y-2 bg-tide-surface/50 rounded-lg p-4",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-tide-text-muted",children:"Filename:"}),e.jsx("span",{className:"text-tide-text font-mono",children:T.filename})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-tide-text-muted",children:"Size:"}),e.jsx("span",{className:"text-tide-text",children:oe(T.size_bytes)})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-tide-text-muted",children:"Created:"}),e.jsx("span",{className:"text-tide-text",children:V(new Date(T.created),{addSuffix:!0})})]})]}),e.jsxs("div",{className:"flex gap-3 pt-2",children:[e.jsx("button",{onClick:()=>{ee(!1),R(null)},className:"flex-1 px-4 py-2 bg-tide-surface-light hover:bg-tide-border-light text-tide-text rounded-lg transition-colors",children:"Cancel"}),e.jsx("button",{onClick:Qt,className:"flex-1 px-4 py-2 bg-red-500 hover:bg-red-600 text-tide-text rounded-lg transition-colors",children:"Delete Backup"})]})]})]})}),Mt&&T&&C&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-tide-surface rounded-lg max-w-md w-full p-6 border border-tide-border",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-tide-text",children:"Restore Backup"}),e.jsx("button",{onClick:()=>{te(!1),R(null)},className:"text-tide-text-muted hover:text-tide-text transition-colors",children:e.jsx(S,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-orange-500/10 border border-orange-500/20 rounded-lg p-4",children:[e.jsx("p",{className:"text-orange-400 text-sm font-medium mb-2",children:"Before Restoring"}),e.jsx("p",{className:"text-tide-text text-sm",children:"A safety backup of your current settings will be created automatically before restoring. This ensures you can rollback if needed."})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"bg-tide-surface/50 rounded-lg p-4",children:[e.jsx("p",{className:"text-xs text-tide-text-muted uppercase tracking-wide mb-2",children:"Backup to Restore"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-tide-text-muted",children:"Filename:"}),e.jsx("span",{className:"text-tide-text font-mono text-xs",children:T.filename})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-tide-text-muted",children:"Backup Size:"}),e.jsx("span",{className:"text-tide-text",children:oe(T.size_bytes)})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-tide-text-muted",children:"Created:"}),e.jsx("span",{className:"text-tide-text",children:V(new Date(T.created),{addSuffix:!0})})]})]})]}),e.jsxs("div",{className:"bg-tide-surface/50 rounded-lg p-4",children:[e.jsx("p",{className:"text-xs text-tide-text-muted uppercase tracking-wide mb-2",children:"Current Database"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-tide-text-muted",children:"Current Size:"}),e.jsx("span",{className:"text-tide-text",children:oe(C.stats.database_size)})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-tide-text-muted",children:"Last Modified:"}),e.jsx("span",{className:"text-tide-text",children:V(new Date(C.stats.database_modified),{addSuffix:!0})})]})]})]})]}),e.jsxs("div",{className:"flex gap-3 pt-2",children:[e.jsx("button",{onClick:()=>{te(!1),R(null)},className:"flex-1 px-4 py-2 bg-tide-surface-light hover:bg-tide-border-light text-tide-text rounded-lg transition-colors",children:"Cancel"}),e.jsx("button",{onClick:Jt,className:"flex-1 px-4 py-2 bg-orange-500 hover:bg-orange-600 text-tide-text rounded-lg transition-colors",children:"Restore Backup"})]})]})]})}),Bt&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-tide-surface rounded-lg shadow-xl max-w-md w-full p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-teal-500/10 rounded-lg flex items-center justify-center",children:e.jsx(Le,{className:"w-5 h-5 text-teal-500"})}),e.jsx("h2",{className:"text-xl font-semibold text-tide-text",children:"Enable Local Authentication"})]}),e.jsx("button",{onClick:()=>Fe(!1),className:"text-tide-text-muted hover:text-tide-text transition-colors",children:e.jsx(S,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-tide-text",children:"Enabling local authentication will allow you to secure TideWatch with username and password login."}),e.jsx("div",{className:"bg-amber-500/10 border border-amber-500/30 rounded-lg p-4",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx(A,{className:"w-5 h-5 text-amber-500 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsx("p",{className:"font-medium text-amber-500",children:"What happens next:"}),e.jsxs("ul",{className:"list-disc list-inside text-tide-text space-y-1",children:[e.jsx("li",{children:'Authentication mode will be set to "local"'}),e.jsx("li",{children:"You'll be redirected to create an admin account"}),e.jsx("li",{children:"All API endpoints will require authentication"}),e.jsx("li",{children:"You can disable authentication anytime from settings"})]})]})]})})]}),e.jsxs("div",{className:"flex gap-3 mt-6",children:[e.jsx("button",{onClick:()=>Fe(!1),className:"flex-1 px-4 py-2 bg-tide-bg hover:bg-tide-surface-light text-tide-text border border-tide-border rounded-lg transition-colors",children:"Cancel"}),e.jsx("button",{onClick:async()=>{try{await p.settings.update("auth_mode","local"),r.success("Enabled local authentication. Redirecting to setup..."),setTimeout(()=>window.location.href="/setup",1e3)}catch{r.error("Failed to enable authentication")}},className:"flex-1 px-4 py-2 bg-teal-500 hover:bg-teal-600 text-white rounded-lg transition-colors font-medium",children:"Enable & Setup"})]})]})}),Ut&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-tide-surface rounded-lg shadow-xl max-w-md w-full p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-teal-500/10 rounded-lg flex items-center justify-center",children:e.jsx(H,{className:"w-5 h-5 text-teal-500"})}),e.jsx("h2",{className:"text-xl font-semibold text-tide-text",children:"Enable OIDC/SSO Authentication"})]}),e.jsx("button",{onClick:()=>Re(!1),className:"text-tide-text-muted hover:text-tide-text transition-colors",children:e.jsx(S,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-tide-text",children:"Enabling OIDC/SSO authentication will allow users to log in using Single Sign-On with OAuth2/OpenID Connect providers like Authentik, Keycloak, or Okta."}),e.jsx("div",{className:"bg-teal-500/10 border border-teal-500/30 rounded-lg p-4",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx(A,{className:"w-5 h-5 text-teal-500 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsx("p",{className:"font-medium text-teal-500",children:"What happens next:"}),e.jsxs("ul",{className:"list-disc list-inside text-tide-text space-y-1",children:[e.jsx("li",{children:'Authentication mode will be set to "oidc"'}),e.jsx("li",{children:"OIDC configuration section will appear below"}),e.jsx("li",{children:"Configure your OIDC provider settings"}),e.jsx("li",{children:"Test the connection before using"}),e.jsx("li",{children:"All API endpoints will require SSO authentication"})]})]})]})})]}),e.jsxs("div",{className:"flex gap-3 mt-6",children:[e.jsx("button",{onClick:()=>Re(!1),className:"flex-1 px-4 py-2 bg-tide-bg hover:bg-tide-surface-light text-tide-text border border-tide-border rounded-lg transition-colors",children:"Cancel"}),e.jsx("button",{onClick:async()=>{try{await p.settings.update("auth_mode","oidc"),r.success("Enabled OIDC authentication. Refreshing..."),setTimeout(()=>window.location.reload(),1e3)}catch{r.error("Failed to enable OIDC")}},className:"flex-1 px-4 py-2 bg-teal-500 hover:bg-teal-600 text-white rounded-lg transition-colors font-medium",children:"Enable OIDC"})]})]})}),Oe&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-tide-surface rounded-lg shadow-xl max-w-md w-full p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-tide-text",children:"Edit Profile"}),e.jsx("button",{onClick:()=>de(!1),className:"text-tide-text-muted hover:text-tide-text transition-colors",children:e.jsx(S,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-tide-text mb-2",children:"Username"}),e.jsx("input",{type:"text",value:f?.username||"",disabled:!0,className:"w-full px-4 py-2 bg-tide-bg border border-tide-border rounded-lg text-tide-text-muted cursor-not-allowed"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-tide-text mb-2",children:"Email"}),e.jsx("input",{type:"email",value:qe,onChange:t=>Se(t.target.value),className:"w-full px-4 py-2 bg-tide-bg border border-tide-border rounded-lg text-tide-text focus:outline-none focus:ring-2 focus:ring-primary",placeholder:"your@email.com"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-tide-text mb-2",children:"Full Name"}),e.jsx("input",{type:"text",value:Ze,onChange:t=>Ae(t.target.value),className:"w-full px-4 py-2 bg-tide-bg border border-tide-border rounded-lg text-tide-text focus:outline-none focus:ring-2 focus:ring-primary",placeholder:"John Doe"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-tide-text-muted",children:[e.jsx(nt,{className:"w-4 h-4"}),e.jsxs("span",{children:["Authentication: ",f?.auth_method==="oidc"?`SSO (${f.oidc_provider})`:"Local"]})]})]}),e.jsxs("div",{className:"flex gap-3 mt-6",children:[e.jsx("button",{onClick:()=>de(!1),className:"flex-1 px-4 py-2 bg-tide-bg hover:bg-tide-surface-light text-tide-text border border-tide-border rounded-lg transition-colors",children:"Cancel"}),e.jsx("button",{onClick:async()=>{try{Qe(!0),await y(qe,Ze),r.success("Profile updated successfully"),de(!1)}catch{r.error("Failed to update profile")}finally{Qe(!1)}},disabled:Je,className:"flex-1 px-4 py-2 bg-teal-500 hover:bg-teal-600 disabled:bg-teal-500/50 disabled:cursor-not-allowed text-white rounded-lg transition-colors",children:Je?"Saving...":"Save Changes"})]})]})}),It&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-tide-surface rounded-lg shadow-xl max-w-md w-full p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-tide-text",children:"Change Password"}),e.jsx("button",{onClick:()=>{ce(!1),se(""),ae(""),le(""),ie(!1),ne(!1),re(!1)},className:"text-tide-text-muted hover:text-tide-text transition-colors",children:e.jsx(S,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-tide-text mb-2",children:"Current Password"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:De?"text":"password",value:Te,onChange:t=>se(t.target.value),className:"w-full px-4 py-2 pr-10 bg-tide-bg border border-tide-border rounded-lg text-tide-text focus:outline-none focus:ring-2 focus:ring-primary",placeholder:"Enter current password"}),e.jsx("button",{type:"button",onClick:()=>ie(!De),className:"absolute right-3 top-1/2 -translate-y-1/2 text-tide-text-muted hover:text-tide-text",children:De?e.jsx(je,{className:"w-4 h-4"}):e.jsx(Ne,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-tide-text mb-2",children:"New Password"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:Pe?"text":"password",value:_,onChange:t=>ae(t.target.value),className:"w-full px-4 py-2 pr-10 bg-tide-bg border border-tide-border rounded-lg text-tide-text focus:outline-none focus:ring-2 focus:ring-primary",placeholder:"Enter new password"}),e.jsx("button",{type:"button",onClick:()=>ne(!Pe),className:"absolute right-3 top-1/2 -translate-y-1/2 text-tide-text-muted hover:text-tide-text",children:Pe?e.jsx(je,{className:"w-4 h-4"}):e.jsx(Ne,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-tide-text mb-2",children:"Confirm Password"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:Ee?"text":"password",value:G,onChange:t=>le(t.target.value),className:"w-full px-4 py-2 pr-10 bg-tide-bg border border-tide-border rounded-lg text-tide-text focus:outline-none focus:ring-2 focus:ring-primary",placeholder:"Confirm new password"}),e.jsx("button",{type:"button",onClick:()=>re(!Ee),className:"absolute right-3 top-1/2 -translate-y-1/2 text-tide-text-muted hover:text-tide-text",children:Ee?e.jsx(je,{className:"w-4 h-4"}):e.jsx(Ne,{className:"w-4 h-4"})})]})]}),_&&e.jsxs("div",{className:"text-xs space-y-1",children:[e.jsxs("div",{className:`flex items-center gap-2 ${_.length>=8?"text-teal-500":"text-tide-text-muted"}`,children:[_.length>=8?e.jsx(L,{className:"w-3 h-3"}):e.jsx(S,{className:"w-3 h-3"}),e.jsx("span",{children:"At least 8 characters"})]}),e.jsxs("div",{className:`flex items-center gap-2 ${/[A-Z]/.test(_)?"text-teal-500":"text-tide-text-muted"}`,children:[/[A-Z]/.test(_)?e.jsx(L,{className:"w-3 h-3"}):e.jsx(S,{className:"w-3 h-3"}),e.jsx("span",{children:"One uppercase letter"})]}),e.jsxs("div",{className:`flex items-center gap-2 ${/[a-z]/.test(_)?"text-teal-500":"text-tide-text-muted"}`,children:[/[a-z]/.test(_)?e.jsx(L,{className:"w-3 h-3"}):e.jsx(S,{className:"w-3 h-3"}),e.jsx("span",{children:"One lowercase letter"})]}),e.jsxs("div",{className:`flex items-center gap-2 ${/[0-9]/.test(_)?"text-teal-500":"text-tide-text-muted"}`,children:[/[0-9]/.test(_)?e.jsx(L,{className:"w-3 h-3"}):e.jsx(S,{className:"w-3 h-3"}),e.jsx("span",{children:"One number"})]}),e.jsxs("div",{className:`flex items-center gap-2 ${/[!@#$%^&*(),.?":{}|<>]/.test(_)?"text-teal-500":"text-tide-text-muted"}`,children:[/[!@#$%^&*(),.?":{}|<>]/.test(_)?e.jsx(L,{className:"w-3 h-3"}):e.jsx(S,{className:"w-3 h-3"}),e.jsx("span",{children:"One special character"})]}),G&&e.jsxs("div",{className:`flex items-center gap-2 ${_===G?"text-teal-500":"text-red-500"}`,children:[_===G?e.jsx(L,{className:"w-3 h-3"}):e.jsx(S,{className:"w-3 h-3"}),e.jsx("span",{children:"Passwords match"})]})]})]}),e.jsxs("div",{className:"flex gap-3 mt-6",children:[e.jsx("button",{onClick:()=>{ce(!1),se(""),ae(""),le(""),ie(!1),ne(!1),re(!1)},className:"flex-1 px-4 py-2 bg-tide-bg hover:bg-tide-surface-light text-tide-text border border-tide-border rounded-lg transition-colors",children:"Cancel"}),e.jsx("button",{onClick:async()=>{if(_!==G){r.error("Passwords do not match");return}try{et(!0),await Z(Te,_),r.success("Password changed successfully"),ce(!1),se(""),ae(""),le(""),ie(!1),ne(!1),re(!1)}catch{r.error("Failed to change password")}finally{et(!1)}},disabled:Xe||!Te||!_||_!==G,className:"flex-1 px-4 py-2 bg-teal-500 hover:bg-teal-600 disabled:bg-teal-500/50 disabled:cursor-not-allowed text-white rounded-lg transition-colors",children:Xe?"Changing...":"Change Password"})]})]})}),Lt&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-tide-surface rounded-lg shadow-xl max-w-2xl w-full p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(H,{className:"w-6 h-6 text-primary"}),e.jsx("h2",{className:"text-xl font-semibold text-tide-text",children:"OIDC/SSO Configuration"})]}),e.jsx("button",{onClick:()=>Ie(!1),className:"text-tide-text-muted hover:text-tide-text transition-colors",children:e.jsx(S,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-tide-text mb-1",children:"Enable OIDC/SSO"}),e.jsx("p",{className:"text-sm text-tide-text-muted",children:"Allow users to log in with Single Sign-On"})]}),e.jsx("button",{type:"button",onClick:()=>U({...k,enabled:!k.enabled}),disabled:O,className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none ${k.enabled?"bg-teal-500":"bg-red-500"}`,children:e.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${k.enabled?"translate-x-6":"translate-x-1"}`})})]}),k.enabled&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-tide-text mb-1",children:"Issuer URL"}),e.jsx("input",{type:"url",value:k.issuer_url,onChange:t=>U({...k,issuer_url:t.target.value}),disabled:O,placeholder:"https://auth.example.com",className:"w-full px-3 py-2 bg-tide-surface border border-tide-border rounded-lg text-tide-text focus:outline-none focus:ring-2 focus:ring-teal-500 disabled:opacity-50"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-tide-text mb-1",children:"Client ID"}),e.jsx("input",{type:"text",value:k.client_id,onChange:t=>U({...k,client_id:t.target.value}),disabled:O,className:"w-full px-3 py-2 bg-tide-surface border border-tide-border rounded-lg text-tide-text focus:outline-none focus:ring-2 focus:ring-teal-500 disabled:opacity-50"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-tide-text mb-1",children:"Client Secret"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:Me?"text":"password",value:k.client_secret,onChange:t=>U({...k,client_secret:t.target.value}),disabled:O,className:"w-full px-3 py-2 pr-10 bg-tide-surface border border-tide-border rounded-lg text-tide-text focus:outline-none focus:ring-2 focus:ring-teal-500 disabled:opacity-50"}),e.jsx("button",{type:"button",onClick:()=>Rt(!Me),className:"absolute right-3 top-1/2 -translate-y-1/2 text-tide-text-muted hover:text-tide-text",children:Me?e.jsx(je,{size:18}):e.jsx(Ne,{size:18})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-tide-text mb-1",children:"Provider Name"}),e.jsx("input",{type:"text",value:k.provider_name,onChange:t=>U({...k,provider_name:t.target.value}),disabled:O,placeholder:"Authentik",className:"w-full px-3 py-2 bg-tide-surface border border-tide-border rounded-lg text-tide-text focus:outline-none focus:ring-2 focus:ring-teal-500 disabled:opacity-50"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-tide-text mb-1",children:"Scopes"}),e.jsx("input",{type:"text",value:k.scopes,onChange:t=>U({...k,scopes:t.target.value}),disabled:O,className:"w-full px-3 py-2 bg-tide-surface border border-tide-border rounded-lg text-tide-text focus:outline-none focus:ring-2 focus:ring-teal-500 disabled:opacity-50"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-tide-text mb-1",children:"Redirect URI (read-only)"}),e.jsx("input",{type:"text",value:k.redirect_uri||`${window.location.origin}/api/v1/auth/oidc/callback`,disabled:!0,className:"w-full px-3 py-2 bg-tide-bg border border-tide-border rounded-lg text-tide-text-muted cursor-not-allowed"})]})]})]}),e.jsxs("div",{className:"flex gap-3 mt-6",children:[e.jsx("button",{onClick:()=>Ie(!1),className:"flex-1 px-4 py-2 bg-tide-bg hover:bg-tide-surface-light text-tide-text border border-tide-border rounded-lg transition-colors",children:"Cancel"}),k.enabled&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:Ht,disabled:$e||O,className:"px-4 py-2 bg-tide-surface hover:bg-tide-surface-light text-tide-text border border-tide-border rounded-lg font-medium flex items-center gap-2 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:$e?e.jsxs(e.Fragment,{children:[e.jsx(w,{className:"w-4 h-4 animate-spin"}),"Testing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(D,{className:"w-4 h-4"}),"Test Connection"]})}),e.jsx("button",{onClick:Wt,disabled:O||$e,className:"px-4 py-2 bg-teal-500 hover:bg-teal-600 disabled:bg-teal-500/50 disabled:cursor-not-allowed text-white rounded-lg font-medium flex items-center gap-2 transition-colors",children:O?e.jsxs(e.Fragment,{children:[e.jsx(w,{className:"w-4 h-4 animate-spin"}),"Saving..."]}):e.jsxs(e.Fragment,{children:[e.jsx(L,{className:"w-4 h-4"}),"Save Configuration"]})})]})]})]})})]})}export{Es as default};
