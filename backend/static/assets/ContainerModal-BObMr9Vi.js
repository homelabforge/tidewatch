import{a as l,j as e}from"./index-CGBKEoxX.js";import{r}from"./router-vendor-B592UMyg.js";import{t as i,X as ye,I as Zt,V as Jt,L as Je,j as es,P as et,S as ts,n as tt,R as x,o as ss,a0 as st,a1 as as,h as rs,a2 as is,Q as ls,x as ds,a3 as ns,a as cs,z as os,p as xs,i as ms,a4 as us,u as at,a5 as hs,g as ps,G as bs,q as gs,a6 as fs,a7 as js,a8 as ys,f as vs,a9 as Ns,aa as rt,ab as ws,C as ks}from"./ui-vendor-C8hJcGlO.js";import{S as _s}from"./StatusBadge-Cc0T94DK.js";import{R as Cs,L as K,C as O,X as V,Y as M,T as X,a as G,b as _}from"./charts-vendor-DENkKz6H.js";import{a as T,f as b}from"./utils-vendor-DnsfCnls.js";import"./react-vendor-OvXVS5lI.js";function Ps({container:a,onClose:se,onUpdate:u}){const[c,$]=r.useState("overview"),[P,ve]=r.useState(!1),[o,Ne]=r.useState(null),[it,we]=r.useState(!1),[g,H]=r.useState(null),[Q,lt]=r.useState("24h"),[y,ke]=r.useState([]),[dt,_e]=r.useState(!1),[S,Ce]=r.useState(""),[ae,Se]=r.useState(!1),[C,nt]=r.useState(!0),[re,ct]=r.useState(100),[U,ot]=r.useState(""),[B,xt]=r.useState(!0),[A,mt]=r.useState(!1),[Ae,De]=r.useState([]),[ie,Fe]=r.useState(!1),[le,ut]=r.useState(a.policy),[Re,ht]=r.useState(a.scope),[q,pt]=r.useState(a.include_prereleases),[Me]=r.useState(a.vulnforge_enabled),[bt,gt]=r.useState(a.health_check_method),[de,$e]=r.useState(a.health_check_url||""),[ne,Pe]=r.useState(""),[ce,He]=r.useState(a.release_source||""),[L,Le]=r.useState(a.auto_restart_enabled),[f,Ee]=r.useState(!1),[j,oe]=r.useState(null),[ft,Te]=r.useState(!1),[d,v]=r.useState({max_attempts:10,backoff_strategy:"exponential",base_delay_seconds:2,max_delay_seconds:300,success_window_seconds:300,health_check_enabled:!0,health_check_timeout:60,rollback_on_health_fail:!1}),[I,xe]=r.useState(a.dependencies||[]),[Ue,jt]=r.useState(a.dependents||[]),[yt,vt]=r.useState([]),[Y,Be]=r.useState(""),[Ie,ze]=r.useState(a.update_window||""),[me,E]=r.useState(a.update_window||""),[m,Nt]=r.useState(null),[We,Ke]=r.useState(!1),[Oe,Ve]=r.useState(!1),[z,ue]=r.useState("updates"),[N,he]=r.useState(null),[pe,Z]=r.useState(!1),[D,Xe]=r.useState(null),[be,J]=r.useState(!1),[wt,kt]=r.useState(!0);r.useEffect(()=>{(async()=>{try{const n=(await l.settings.getAll()).find(k=>k.key==="my_projects_enabled");kt(n?.value==="true"||n?.value===!0)}catch(s){console.error("Failed to load settings:",s)}})()},[]),r.useEffect(()=>{c==="metrics"&&_t(),c==="dependencies"&&(a.is_my_project&&Ge(),Qe(),qe())},[c,a.id]),r.useEffect(()=>{g&&Ct()},[g,Q,a.id]),r.useEffect(()=>{c==="history"&&ge()},[c,a.id]),r.useEffect(()=>{c==="settings"&&(L&&te(),Lt(),Et())},[c,a.id,L]);const _t=async()=>{we(!0);try{const t=await l.containers.getMetrics(a.id);Ne(t)}catch(t){console.error("Failed to load metrics:",t),Ne(null)}finally{we(!1)}},Ct=async()=>{_e(!0);try{const t=await fetch(`/api/v1/containers/${a.id}/metrics/history?period=${Q}`);if(!t.ok)throw new Error("Failed to fetch history");const s=await t.json();ke(s)}catch(t){console.error("Failed to load historical data:",t),ke([])}finally{_e(!1)}},ee=r.useCallback(async()=>{Se(!0);try{const t=await l.containers.getLogs(a.id,re);Ce(t.logs.join(`
`)||"")}catch(t){console.error("Failed to load logs:",t),Ce("Failed to load logs")}finally{Se(!1)}},[a.id,re]);r.useEffect(()=>{if(c==="logs"&&(ee(),C)){const t=setInterval(ee,2e3);return()=>clearInterval(t)}},[c,C,ee]);const ge=async()=>{Fe(!0);try{const t=await fetch(`/api/v1/containers/${a.id}/details`);if(!t.ok)throw new Error("Failed to fetch history");const s=await t.json();console.log("History data:",s.history),De(s.history||[])}catch(t){console.error("Failed to load update history:",t),De([])}finally{Fe(!1)}},w=async t=>{Ee(!0);try{await l.containers.update(a.id,t),i.success("Settings saved successfully"),u&&u()}catch(s){console.error("Failed to save settings:",s),i.error("Failed to save settings")}finally{Ee(!1)}},St=async t=>{ut(t),await w({policy:t})},At=async t=>{ht(t),await w({scope:t})},Dt=async()=>{const t=!q;pt(t),await w({include_prereleases:t})},Ft=async t=>{gt(t),await w({health_check_method:t})},Rt=async()=>{console.log("Saving health check URL:",de),await w({health_check_url:de})},Mt=async()=>{console.log("Saving health check auth"),await w({health_check_auth:ne}),Pe("")},$t=async()=>{console.log("Saving release source:",ce),await w({release_source:ce})},Pt=async()=>{try{const s=await(await fetch(`/api/v1/containers/${a.id}/detect-health-check`)).json();s.success&&s.detected_url?($e(s.detected_url),await w({health_check_url:s.detected_url}),i.success(`Health check URL detected: ${s.detected_url}`)):i.error(s.message||"No health check found in compose file")}catch(t){console.error("Error detecting health check:",t),i.error("Failed to detect health check URL")}},Ht=async()=>{try{const s=await(await fetch(`/api/v1/containers/${a.id}/detect-release-source`)).json();s.success&&s.detected_source?(He(s.detected_source),await w({release_source:s.detected_source}),i.success(`Release source detected: ${s.detected_source}`)):i(s.message||"Could not auto-detect release source. Please enter manually.")}catch(t){console.error("Error detecting release source:",t),i.error("Failed to detect release source")}},te=async()=>{Te(!0);try{const t=await l.restarts.getState(a.id);oe(t),t&&v({max_attempts:t.max_attempts,backoff_strategy:t.backoff_strategy,base_delay_seconds:t.base_delay_seconds,max_delay_seconds:t.max_delay_seconds,success_window_seconds:t.success_window_seconds,health_check_enabled:t.health_check_enabled,health_check_timeout:t.health_check_timeout,rollback_on_health_fail:t.rollback_on_health_fail})}catch(t){console.error("Failed to load restart state:",t)}finally{Te(!1)}},Lt=async()=>{try{const t=await l.containers.getDependencies(a.id);xe(t.dependencies),jt(t.dependents)}catch(t){console.error("Failed to load dependencies:",t)}},Et=async()=>{try{const t=await l.containers.getAll();vt(t.filter(s=>s.id!==a.id))}catch(t){console.error("Failed to load containers:",t)}},Tt=async()=>{const t=!L;try{if(t){const s=await l.restarts.enable(a.id,d);oe(s.state),Le(!0),i.success("Auto-restart enabled")}else await l.restarts.disable(a.id),Le(!1),i.success("Auto-restart disabled");u?.()}catch(s){console.error("Error toggling auto-restart:",s),i.error(s instanceof Error?s.message:"Failed to toggle auto-restart")}},Ut=async()=>{try{const t=await l.restarts.enable(a.id,d);oe(t.state),i.success("Restart configuration saved"),u?.()}catch(t){console.error("Error saving restart config:",t),i.error(t instanceof Error?t.message:"Failed to save configuration")}},Bt=async()=>{if(confirm("Are you sure you want to reset the restart failure count?"))try{await l.restarts.reset(a.id),await te(),i.success("Restart state reset")}catch(t){console.error("Error resetting restart state:",t),i.error(t instanceof Error?t.message:"Failed to reset state")}},It=async()=>{const t=prompt("Pause auto-restart for how many hours?","24");if(!t)return;const s=parseInt(t)*3600;if(isNaN(s)||s<=0){i.error("Invalid duration");return}try{await l.restarts.pause(a.id,s),await te(),i.success(`Auto-restart paused for ${t} hours`)}catch(n){console.error("Error pausing restart:",n),i.error(n instanceof Error?n.message:"Failed to pause")}},zt=async()=>{try{await l.restarts.resume(a.id),await te(),i.success("Auto-restart resumed")}catch(t){console.error("Error resuming restart:",t),i.error(t instanceof Error?t.message:"Failed to resume")}},Wt=async()=>{if(!Y)return;const t=[...I,Y];try{await l.containers.updateDependencies(a.id,t),xe(t),Be(""),i.success("Dependency added"),u?.()}catch(s){console.error("Error adding dependency:",s),i.error(s instanceof Error?s.message:"Failed to add dependency")}},Kt=async t=>{const s=I.filter(n=>n!==t);try{await l.containers.updateDependencies(a.id,s),xe(s),i.success("Dependency removed"),u?.()}catch(n){console.error("Error removing dependency:",n),i.error(n instanceof Error?n.message:"Failed to remove dependency")}},Ot=async()=>{try{await l.containers.updateUpdateWindow(a.id,me||null),ze(me),i.success("Update window saved"),u?.()}catch(t){console.error("Error saving update window:",t),i.error(t instanceof Error?t.message:"Failed to save update window")}},Vt=async()=>{try{const t=!a.is_my_project;await l.containers.update(a.id,{is_my_project:t}),a.is_my_project=t,i.success(t?"Added to My Projects":"Removed from My Projects"),u?.()}catch(t){console.error("Error toggling My Project:",t),i.error(t instanceof Error?t.message:"Failed to update My Project status")}},Ge=async()=>{Ke(!0);try{const t=await l.containers.getAppDependencies(a.id);Nt(t)}catch(t){console.error("Error loading app dependencies:",t),i.error("Failed to load app dependencies")}finally{Ke(!1)}},Qe=async()=>{Z(!0);try{const t=await l.containers.getDockerfileDependencies(a.id);if(he(t),t.total===0&&!t.last_scan)try{await l.containers.scanDockerfileDependencies(a.id);const s=await l.containers.getDockerfileDependencies(a.id);he(s)}catch{console.log("Auto-scan skipped: no Dockerfile found")}}catch(t){console.error("Error loading Dockerfile dependencies:",t),he(null)}finally{Z(!1)}},qe=async()=>{J(!0);try{const t=await l.containers.getHttpServers(a.id);Xe(t)}catch(t){console.error("Error loading HTTP servers:",t),Xe(null)}finally{J(!1)}},fe=t=>t<60?`${t}s`:t<3600?`${Math.floor(t/60)}m`:t<86400?`${Math.floor(t/3600)}h`:`${Math.floor(t/86400)}d`,Xt=async t=>{if(confirm("Are you sure you want to rollback to the previous version? This will restart the container."))try{await l.history.rollback(t),i.success("Rollback initiated successfully"),await ge(),se()}catch(s){console.error("Rollback error:",s),i.error(s instanceof Error?s.message:"Failed to rollback")}},h=t=>{if(t===0)return"0 B";const s=1024,n=["B","KB","MB","GB"],k=Math.floor(Math.log(t)/Math.log(s));return`${(t/Math.pow(s,k)).toFixed(2)} ${n[k]}`},Gt=t=>{const s=t.toLowerCase();return s.includes("error")?"text-red-400":s.includes("warn")||s.includes("warning")?"text-yellow-400":s.includes("info")?"text-blue-400":s.includes("debug")?"text-tide-text-muted":"text-tide-text"},je=t=>{if(!U.trim())return t;const s=t.split(`
`),n=U.toLowerCase();return s.filter(F=>F.toLowerCase().includes(n)).join(`
`)},Qt=async()=>{try{const t=je(S);await navigator.clipboard.writeText(t),i.success("Logs copied to clipboard")}catch(t){console.error("Failed to copy logs:",t),i.error("Failed to copy logs")}},qt=()=>{try{const t=je(S),s=b(new Date,"yyyy-MM-dd-HHmmss"),n=`${a.name}-logs-${s}.txt`,k=new Blob([t],{type:"text/plain"}),F=URL.createObjectURL(k),R=document.createElement("a");R.href=F,R.download=n,document.body.appendChild(R),R.click(),document.body.removeChild(R),URL.revokeObjectURL(F),i.success(`Logs downloaded as ${n}`)}catch(t){console.error("Failed to download logs:",t),i.error("Failed to download logs")}},Yt=()=>{if(y.length===0){i.error("No metrics data to export");return}try{const t=["Timestamp","CPU %","Memory Usage (bytes)","Memory Limit (bytes)","Memory %","Network RX (bytes)","Network TX (bytes)","Block Read (bytes)","Block Write (bytes)","PIDs"],s=y.map(p=>[p.timestamp,p.cpu_percent,p.memory_usage,p.memory_limit,p.memory_percent,p.network_rx,p.network_tx,p.block_read,p.block_write,p.pids]),n=[t.join(","),...s.map(p=>p.join(","))].join(`
`),k=b(new Date,"yyyy-MM-dd-HHmmss"),F=`${a.name}-metrics-${Q}-${k}.csv`,R=new Blob([n],{type:"text/csv"}),Ze=URL.createObjectURL(R),W=document.createElement("a");W.href=Ze,W.download=F,document.body.appendChild(W),W.click(),document.body.removeChild(W),URL.revokeObjectURL(Ze),i.success(`Metrics exported as ${F}`)}catch(t){console.error("Failed to export metrics:",t),i.error("Failed to export metrics")}},Ye=async()=>{ve(!0);try{const t=await l.containers.checkForUpdates(a.id);t.update?i.success(`Update found: ${t.update.to_tag}`):i.success("No updates available"),u&&u()}catch(t){i.error("Failed to check for updates"),console.error(t)}finally{ve(!1)}};return e.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:e.jsxs("div",{className:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0",children:[e.jsx("div",{className:"fixed inset-0 transition-opacity bg-tide-surface/75",onClick:se}),e.jsxs("div",{className:"inline-block overflow-hidden text-left align-bottom transition-all transform bg-tide-surface rounded-lg shadow-xl sm:my-8 sm:align-middle sm:max-w-6xl sm:w-full relative",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-tide-border",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-tide-text",children:a.name}),e.jsxs("p",{className:"text-sm text-tide-text-muted mt-1",children:[a.image,":",a.current_tag]})]}),e.jsx("button",{onClick:se,className:"text-tide-text-muted hover:text-tide-text transition-colors",children:e.jsx(ye,{className:"w-6 h-6"})})]}),e.jsx("div",{className:"border-b border-tide-border px-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex space-x-1",children:[e.jsxs("button",{onClick:()=>$("overview"),className:`px-4 py-3 text-sm font-medium transition-colors border-b-2 flex items-center gap-2 ${c==="overview"?"border-primary text-primary":"border-transparent text-tide-text-muted hover:text-tide-text"}`,children:[e.jsx(Zt,{size:16}),"Overview"]}),e.jsxs("button",{onClick:()=>$("metrics"),className:`px-4 py-3 text-sm font-medium transition-colors border-b-2 flex items-center gap-2 ${c==="metrics"?"border-primary text-primary":"border-transparent text-tide-text-muted hover:text-tide-text"}`,children:[e.jsx(Jt,{size:16}),"Metrics"]}),e.jsxs("button",{onClick:()=>$("logs"),className:`px-4 py-3 text-sm font-medium transition-colors border-b-2 flex items-center gap-2 ${c==="logs"?"border-primary text-primary":"border-transparent text-tide-text-muted hover:text-tide-text"}`,children:[e.jsx(Je,{size:16}),"Logs"]}),e.jsxs("button",{onClick:()=>$("history"),className:`px-4 py-3 text-sm font-medium transition-colors border-b-2 flex items-center gap-2 ${c==="history"?"border-primary text-primary":"border-transparent text-tide-text-muted hover:text-tide-text"}`,children:[e.jsx(es,{size:16}),"History"]}),a.is_my_project&&e.jsxs("button",{onClick:()=>$("dependencies"),className:`px-4 py-3 text-sm font-medium transition-colors border-b-2 flex items-center gap-2 ${c==="dependencies"?"border-primary text-primary":"border-transparent text-tide-text-muted hover:text-tide-text"}`,children:[e.jsx(et,{size:16}),"Dependencies"]})]}),e.jsxs("button",{onClick:()=>$("settings"),className:`px-4 py-3 text-sm font-medium transition-colors border-b-2 flex items-center gap-2 ${c==="settings"?"border-primary text-primary":"border-transparent text-tide-text-muted hover:text-tide-text"}`,children:[e.jsx(ts,{size:16}),"Settings"]})]})}),e.jsxs("div",{className:"p-6 max-h-[70vh] overflow-y-auto",children:[c==="overview"&&e.jsxs("div",{className:"space-y-6",children:[a.update_available?e.jsxs("div",{className:"bg-tide-surface/50 rounded-lg p-4 border border-tide-border border-l-4 border-l-accent",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(tt,{className:"w-8 h-8 text-accent"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-tide-text",children:"Update Available"}),e.jsxs("p",{className:"text-tide-text-muted text-sm mt-1",children:["A new version is available: ",a.latest_tag||"Unknown"]})]})]}),e.jsxs("div",{className:"mt-4 flex gap-2",children:[e.jsxs("button",{onClick:Ye,disabled:P,className:"px-4 py-2 bg-tide-surface-light hover:bg-gray-500 text-tide-text rounded-lg transition-colors flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(x,{className:`w-4 h-4 ${P?"animate-spin":""}`}),P?"Checking...":"Check for Updates"]}),e.jsxs("button",{onClick:async()=>{const t=prompt("Optional: Enter a reason for the restart");try{await l.restarts.manualRestart(a.id,t||void 0),i.success("Container restarted successfully"),u?.()}catch{i.error("Failed to restart container")}},className:"px-4 py-2 bg-accent hover:bg-accent-dark text-tide-text rounded-lg transition-colors flex items-center gap-2",children:[e.jsx(x,{className:"w-4 h-4"}),"Restart"]})]})]}):e.jsxs("div",{className:"bg-tide-surface/50 rounded-lg p-4 border border-tide-border border-l-4 border-l-green-500",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ss,{className:"w-8 h-8 text-green-500"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-tide-text",children:"Up to Date"}),e.jsx("p",{className:"text-tide-text-muted text-sm mt-1",children:"This container is running the latest version."})]})]}),e.jsxs("div",{className:"mt-4 flex gap-2",children:[e.jsxs("button",{onClick:Ye,disabled:P,className:"px-4 py-2 bg-tide-surface-light hover:bg-gray-500 text-tide-text rounded-lg transition-colors flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(x,{className:`w-4 h-4 ${P?"animate-spin":""}`}),P?"Checking...":"Check for Updates"]}),e.jsxs("button",{onClick:async()=>{const t=prompt("Optional: Enter a reason for the restart");try{await l.restarts.manualRestart(a.id,t||void 0),i.success("Container restarted successfully"),u?.()}catch{i.error("Failed to restart container")}},className:"px-4 py-2 bg-accent hover:bg-accent-dark text-tide-text rounded-lg transition-colors flex items-center gap-2",children:[e.jsx(x,{className:"w-4 h-4"}),"Restart"]})]})]}),e.jsxs("div",{className:"bg-tide-surface/50 rounded-lg p-4 border border-tide-border",children:[e.jsx("h3",{className:"text-lg font-semibold text-tide-text mb-4",children:"Information"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-tide-text-muted",children:"Registry"}),e.jsx("span",{className:"text-tide-text font-mono text-sm",children:a.registry})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-tide-text-muted",children:"Compose File"}),e.jsx("span",{className:"text-tide-text font-mono text-sm truncate max-w-xs",title:a.compose_file,children:a.compose_file})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-tide-text-muted",children:"Service Name"}),e.jsx("span",{className:"text-tide-text font-mono text-sm",children:a.service_name})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-tide-text-muted",children:"Last Checked"}),e.jsx("span",{className:"text-tide-text text-sm",children:a.last_checked?T(new Date(a.last_checked),{addSuffix:!0}):"Never"})]})]})]})]}),c==="metrics"&&(it?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(x,{className:"w-8 h-8 text-primary animate-spin"})}):g?e.jsxs("div",{children:[e.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[e.jsxs("button",{onClick:()=>H(null),className:"text-primary hover:text-primary/80 transition-colors flex items-center gap-2",children:[e.jsx(ye,{className:"w-4 h-4"}),"Back to Metrics"]}),e.jsx("div",{className:"flex gap-2",children:["1h","6h","24h","7d","30d"].map(t=>e.jsx("button",{onClick:()=>lt(t),className:`px-3 py-1 rounded-lg text-sm transition-colors ${Q===t?"bg-primary text-tide-text":"bg-tide-surface-light text-tide-text hover:bg-gray-500"}`,children:t},t))})]}),e.jsxs("div",{className:"bg-tide-surface/50 rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h3",{className:"text-xl font-semibold text-tide-text capitalize",children:[g," History"]}),e.jsxs("div",{className:"flex items-center gap-3",children:[(g==="cpu"||g==="memory")&&e.jsxs("button",{onClick:()=>mt(!A),className:`flex items-center gap-2 px-3 py-2 rounded-lg text-sm transition-colors ${A?"bg-primary text-tide-text":"bg-tide-surface-light text-tide-text hover:bg-gray-500"}`,children:[e.jsx(st,{className:"w-4 h-4"}),A?"Comparing":"Compare"]}),e.jsxs("button",{onClick:Yt,disabled:y.length===0,className:"flex items-center gap-2 px-3 py-2 bg-tide-surface-light hover:bg-gray-500 text-tide-text rounded-lg text-sm transition-colors disabled:opacity-50",children:[e.jsx(as,{className:"w-4 h-4"}),"Export CSV"]})]})]}),dt?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(x,{className:"w-8 h-8 text-primary animate-spin"})}):y.length===0?e.jsx("div",{className:"flex items-center justify-center h-64 text-tide-text-muted",children:e.jsx("p",{children:"No historical data available yet. Data will be collected every 5 minutes."})}):e.jsx("div",{className:"h-80",children:e.jsxs(Cs,{width:"100%",height:"100%",children:[g==="cpu"&&e.jsxs(K,{data:y,children:[e.jsx(O,{strokeDasharray:"3 3",stroke:"#374151"}),e.jsx(V,{dataKey:"timestamp",stroke:"#9CA3AF",tickFormatter:t=>b(new Date(t),"HH:mm")}),e.jsx(M,{yAxisId:"left",stroke:"#9CA3AF",label:{value:"CPU %",angle:-90,position:"insideLeft",style:{fill:"#9CA3AF"}}}),A&&e.jsx(M,{yAxisId:"right",orientation:"right",stroke:"#9CA3AF",tickFormatter:t=>h(t),label:{value:"Memory (MB)",angle:90,position:"insideRight",style:{fill:"#9CA3AF"}}}),e.jsx(X,{contentStyle:{backgroundColor:"#1F2937",border:"1px solid #374151"},labelFormatter:t=>b(new Date(t),"PPpp")}),e.jsx(G,{}),e.jsx(_,{yAxisId:"left",type:"monotone",dataKey:"cpu_percent",stroke:"#3B82F6",name:"CPU %",strokeWidth:2}),A&&e.jsx(_,{yAxisId:"right",type:"monotone",dataKey:"memory_usage",stroke:"#10B981",name:"Memory Usage",strokeWidth:2})]}),g==="memory"&&e.jsxs(K,{data:y,children:[e.jsx(O,{strokeDasharray:"3 3",stroke:"#374151"}),e.jsx(V,{dataKey:"timestamp",stroke:"#9CA3AF",tickFormatter:t=>b(new Date(t),"HH:mm")}),e.jsx(M,{yAxisId:"left",stroke:"#9CA3AF",tickFormatter:t=>h(t),label:{value:"Memory (MB)",angle:-90,position:"insideLeft",style:{fill:"#9CA3AF"}}}),A&&e.jsx(M,{yAxisId:"right",orientation:"right",stroke:"#9CA3AF",label:{value:"CPU %",angle:90,position:"insideRight",style:{fill:"#9CA3AF"}}}),e.jsx(X,{contentStyle:{backgroundColor:"#1F2937",border:"1px solid #374151"},labelFormatter:t=>b(new Date(t),"PPpp")}),e.jsx(G,{}),e.jsx(_,{yAxisId:"left",type:"monotone",dataKey:"memory_usage",stroke:"#10B981",name:"Memory Usage",strokeWidth:2}),A&&e.jsx(_,{yAxisId:"right",type:"monotone",dataKey:"cpu_percent",stroke:"#3B82F6",name:"CPU %",strokeWidth:2})]}),g==="network"&&e.jsxs(K,{data:y,children:[e.jsx(O,{strokeDasharray:"3 3",stroke:"#374151"}),e.jsx(V,{dataKey:"timestamp",stroke:"#9CA3AF",tickFormatter:t=>b(new Date(t),"HH:mm")}),e.jsx(M,{stroke:"#9CA3AF",tickFormatter:t=>h(t)}),e.jsx(X,{contentStyle:{backgroundColor:"#1F2937",border:"1px solid #374151"},labelFormatter:t=>b(new Date(t),"PPpp"),formatter:(t,s)=>[h(t),s]}),e.jsx(G,{}),e.jsx(_,{type:"monotone",dataKey:"network_rx",stroke:"#8B5CF6",name:"RX"}),e.jsx(_,{type:"monotone",dataKey:"network_tx",stroke:"#EC4899",name:"TX"})]}),g==="disk"&&e.jsxs(K,{data:y,children:[e.jsx(O,{strokeDasharray:"3 3",stroke:"#374151"}),e.jsx(V,{dataKey:"timestamp",stroke:"#9CA3AF",tickFormatter:t=>b(new Date(t),"HH:mm")}),e.jsx(M,{stroke:"#9CA3AF",tickFormatter:t=>h(t)}),e.jsx(X,{contentStyle:{backgroundColor:"#1F2937",border:"1px solid #374151"},labelFormatter:t=>b(new Date(t),"PPpp"),formatter:(t,s)=>[h(t),s]}),e.jsx(G,{}),e.jsx(_,{type:"monotone",dataKey:"block_read",stroke:"#F59E0B",name:"Read"}),e.jsx(_,{type:"monotone",dataKey:"block_write",stroke:"#EF4444",name:"Write"})]}),g==="pids"&&e.jsxs(K,{data:y,children:[e.jsx(O,{strokeDasharray:"3 3",stroke:"#374151"}),e.jsx(V,{dataKey:"timestamp",stroke:"#9CA3AF",tickFormatter:t=>b(new Date(t),"HH:mm")}),e.jsx(M,{stroke:"#9CA3AF"}),e.jsx(X,{contentStyle:{backgroundColor:"#1F2937",border:"1px solid #374151"},labelFormatter:t=>b(new Date(t),"PPpp"),formatter:t=>[t,"Processes"]}),e.jsx(G,{}),e.jsx(_,{type:"monotone",dataKey:"pids",stroke:"#06B6D4",name:"PIDs"})]})]})})]})]}):e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{onClick:()=>H("cpu"),className:"bg-tide-surface/50 rounded-lg p-4 cursor-pointer hover:bg-tide-surface transition-colors border border-tide-border",children:[e.jsx("h3",{className:"text-lg font-semibold text-tide-text mb-4",children:"CPU Usage"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-tide-text-muted",children:"Current"}),e.jsx("span",{className:"text-tide-text font-mono text-sm",children:o?`${o.cpu_percent.toFixed(2)}%`:"N/A"})]}),e.jsx("div",{className:"w-full bg-tide-surface-light rounded-full h-2",children:e.jsx("div",{className:"bg-primary h-2 rounded-full transition-all",style:{width:`${o?Math.min(o.cpu_percent,100):0}%`}})})]})]}),e.jsxs("div",{onClick:()=>H("memory"),className:"bg-tide-surface/50 rounded-lg p-4 cursor-pointer hover:bg-tide-surface transition-colors border border-tide-border",children:[e.jsx("h3",{className:"text-lg font-semibold text-tide-text mb-4",children:"Memory Usage"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-tide-text-muted",children:"Current"}),e.jsx("span",{className:"text-tide-text font-mono text-sm",children:o?`${h(o.memory_usage)} / ${h(o.memory_limit)}`:"N/A"})]}),e.jsx("div",{className:"w-full bg-tide-surface-light rounded-full h-2",children:e.jsx("div",{className:"bg-accent h-2 rounded-full transition-all",style:{width:`${o?Math.min(o.memory_percent,100):0}%`}})})]})]}),e.jsxs("div",{onClick:()=>H("pids"),className:"bg-tide-surface/50 rounded-lg p-4 cursor-pointer hover:bg-tide-surface transition-colors border border-tide-border",children:[e.jsx("h3",{className:"text-lg font-semibold text-tide-text mb-4",children:"Processes"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-tide-text-muted",children:"PIDs"}),e.jsx("span",{className:"text-tide-text font-mono text-sm",children:o?o.pids:"N/A"})]}),e.jsx("div",{className:"text-tide-text-muted text-xs mt-2",children:"Active process count"})]})]}),e.jsxs("div",{onClick:()=>H("network"),className:"bg-tide-surface/50 rounded-lg p-4 cursor-pointer hover:bg-tide-surface transition-colors border border-tide-border",children:[e.jsx("h3",{className:"text-lg font-semibold text-tide-text mb-4",children:"Network I/O"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-tide-text-muted",children:"RX"}),e.jsx("span",{className:"text-tide-text font-mono text-sm",children:o?h(o.network_rx):"N/A"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-tide-text-muted",children:"TX"}),e.jsx("span",{className:"text-tide-text font-mono text-sm",children:o?h(o.network_tx):"N/A"})]})]})]}),e.jsxs("div",{onClick:()=>H("disk"),className:"bg-tide-surface/50 rounded-lg p-4 cursor-pointer hover:bg-tide-surface transition-colors border border-tide-border",children:[e.jsx("h3",{className:"text-lg font-semibold text-tide-text mb-4",children:"Block I/O"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-tide-text-muted",children:"Read"}),e.jsx("span",{className:"text-tide-text font-mono text-sm",children:o?h(o.block_read):"N/A"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-tide-text-muted",children:"Write"}),e.jsx("span",{className:"text-tide-text font-mono text-sm",children:o?h(o.block_write):"N/A"})]})]})]})]})),c==="logs"&&e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsxs("div",{className:"flex flex-col gap-3 mb-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold text-tide-text",children:"Container Logs"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("label",{className:"text-sm text-tide-text-muted",children:"Lines:"}),e.jsxs("select",{value:re,onChange:t=>ct(Number(t.target.value)),className:"bg-tide-surface text-tide-text text-sm rounded-lg px-3 py-1 border border-tide-border-light focus:outline-none focus:ring-2 focus:ring-primary",children:[e.jsx("option",{value:100,children:"100"}),e.jsx("option",{value:500,children:"500"}),e.jsx("option",{value:1e3,children:"1000"}),e.jsx("option",{value:1e4,children:"All"})]})]}),e.jsxs("button",{onClick:()=>nt(!C),className:`flex items-center gap-2 px-3 py-1 rounded-lg text-sm transition-colors ${C?"bg-primary text-tide-text":"bg-tide-surface-light text-tide-text hover:bg-gray-500"}`,children:[e.jsx(x,{className:`w-4 h-4 ${C&&ae?"animate-spin":""}`}),C?"Live":"Paused"]}),e.jsx("button",{onClick:ee,disabled:ae,className:"px-3 py-1 bg-tide-surface-light hover:bg-gray-500 text-tide-text rounded-lg text-sm transition-colors disabled:opacity-50",children:"Refresh"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(rs,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-tide-text-muted"}),e.jsx("input",{type:"text",placeholder:"Search logs...",value:U,onChange:t=>ot(t.target.value),className:"w-full pl-10 pr-3 py-2 bg-tide-surface border border-tide-border text-tide-text rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-primary"})]}),e.jsxs("button",{onClick:Qt,disabled:!S,className:"flex items-center gap-2 px-3 py-2 bg-tide-surface-light hover:bg-gray-500 text-tide-text rounded-lg text-sm transition-colors disabled:opacity-50",title:"Copy to clipboard",children:[e.jsx(is,{className:"w-4 h-4"}),"Copy"]}),e.jsxs("button",{onClick:qt,disabled:!S,className:"flex items-center gap-2 px-3 py-2 bg-tide-surface-light hover:bg-gray-500 text-tide-text rounded-lg text-sm transition-colors disabled:opacity-50",title:"Download as .txt file",children:[e.jsx(ls,{className:"w-4 h-4"}),"Download"]}),e.jsxs("button",{onClick:()=>xt(!B),className:`flex items-center gap-2 px-3 py-2 rounded-lg text-sm transition-colors ${B?"bg-primary text-tide-text":"bg-tide-surface-light text-tide-text hover:bg-gray-500"}`,title:B?"Auto-scroll enabled":"Auto-scroll disabled",children:[B?e.jsx(ds,{className:"w-4 h-4"}):e.jsx(ns,{className:"w-4 h-4"}),"Follow"]})]})]}),e.jsx("div",{className:"flex-1 bg-tide-surface rounded-lg p-4 overflow-auto font-mono text-xs",children:ae&&!S?e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsx(x,{className:"w-8 h-8 text-primary animate-spin"})}):S?e.jsx("div",{className:"whitespace-pre-wrap break-words",children:je(S).split(`
`).map((t,s)=>e.jsx("div",{className:Gt(t),children:t},s))}):e.jsx("div",{className:"flex items-center justify-center h-full text-tide-text-muted",children:"No logs available"})}),e.jsxs("div",{className:"mt-2 flex items-center justify-between text-xs text-tide-text-muted",children:[e.jsxs("span",{children:[C&&"Auto-refreshing every 2 seconds",!C&&"Auto-refresh paused",U&&` â€¢ Filtering by: "${U}"`]}),e.jsx("span",{children:B&&"Auto-scroll enabled"})]})]}),c==="history"&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-tide-text",children:"Update History"}),e.jsxs("button",{onClick:ge,disabled:ie,className:"px-3 py-1 bg-tide-surface-light hover:bg-gray-500 text-tide-text rounded-lg text-sm transition-colors disabled:opacity-50 flex items-center gap-2",children:[e.jsx(x,{className:`w-4 h-4 ${ie?"animate-spin":""}`}),"Refresh"]})]}),ie?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(x,{className:"w-8 h-8 text-primary animate-spin"})}):Ae.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-tide-text-muted",children:[e.jsx(cs,{className:"w-12 h-12 mb-3 opacity-50"}),e.jsx("p",{children:"No update history available for this container"})]}):e.jsx("div",{className:"space-y-4",children:Ae.map(t=>e.jsxs("div",{className:"bg-tide-surface/50 rounded-lg p-4 border border-tide-border border-l-4",style:{borderLeftColor:t.status==="completed"?"#10B981":t.status==="failed"?"#EF4444":t.status==="rolled_back"?"#F59E0B":"#6B7280"},children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[t.status==="completed"&&e.jsx(os,{className:"w-5 h-5 text-green-500 flex-shrink-0"}),t.status==="failed"&&e.jsx(xs,{className:"w-5 h-5 text-red-500 flex-shrink-0"}),t.status==="rolled_back"&&e.jsx(tt,{className:"w-5 h-5 text-yellow-500 flex-shrink-0"}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 text-tide-text font-medium",children:[e.jsx("span",{className:"font-mono text-sm",children:t.from_tag}),e.jsx(ms,{className:"w-4 h-4 text-tide-text-muted"}),e.jsx("span",{className:"font-mono text-sm",children:t.to_tag})]}),e.jsx("p",{className:"text-xs text-tide-text-muted mt-1",children:T(new Date(t.started_at),{addSuffix:!0})})]})]}),e.jsxs("div",{className:"flex flex-col items-end gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_s,{status:t.status}),t.can_rollback&&(t.status==="completed"||t.status==="success")&&!t.rolled_back_at&&e.jsxs("button",{onClick:()=>Xt(t.id),className:"flex items-center gap-1.5 px-2.5 py-1 bg-yellow-500/10 hover:bg-yellow-500/20 text-yellow-500 rounded-lg transition-colors text-xs",children:[e.jsx(us,{className:"w-3.5 h-3.5"}),"Rollback"]})]}),t.duration_seconds!==null&&e.jsx("span",{className:"text-xs text-tide-text-muted",children:t.duration_seconds<60?`${t.duration_seconds}s`:`${Math.floor(t.duration_seconds/60)}m ${t.duration_seconds%60}s`})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm mt-3 pt-3 border-t border-tide-border-light",children:[t.reason_summary&&e.jsxs("div",{className:"col-span-2",children:[e.jsx("span",{className:"text-tide-text-muted",children:"Reason:"}),e.jsx("span",{className:"text-tide-text ml-2",children:t.reason_summary})]}),t.triggered_by&&e.jsxs("div",{children:[e.jsx("span",{className:"text-tide-text-muted",children:"Triggered by:"}),e.jsx("span",{className:"text-tide-text ml-2",children:t.triggered_by})]}),t.update_type&&e.jsxs("div",{children:[e.jsx("span",{className:"text-tide-text-muted",children:"Type:"}),e.jsx("span",{className:"text-tide-text ml-2",children:t.update_type})]}),t.cves_fixed&&t.cves_fixed.length>0&&e.jsxs("div",{className:"col-span-2",children:[e.jsx("span",{className:"text-tide-text-muted",children:"CVEs Fixed:"}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:t.cves_fixed.map(s=>e.jsx("span",{className:"px-2 py-0.5 bg-blue-500/20 text-blue-400 rounded text-xs font-mono",children:s},s))})]}),t.error_message&&e.jsxs("div",{className:"col-span-2",children:[e.jsx("span",{className:"text-tide-text-muted",children:"Error:"}),e.jsx("p",{className:"text-red-400 text-xs mt-1 font-mono bg-red-500/10 p-2 rounded",children:t.error_message})]}),t.rolled_back_at&&e.jsxs("div",{className:"col-span-2",children:[e.jsx("span",{className:"text-tide-text-muted",children:"Rolled back:"}),e.jsx("span",{className:"text-yellow-400 ml-2",children:T(new Date(t.rolled_back_at),{addSuffix:!0})})]})]})]},t.id))})]}),c==="dependencies"&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"mb-4 flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold text-tide-text",children:"HTTP Servers"}),e.jsx("p",{className:"text-sm text-tide-text-muted mt-1",children:"Detected HTTP servers running in the container with version information."})]}),e.jsxs("button",{onClick:async()=>{J(!0);try{await l.containers.scanHttpServers(a.id),await qe(),i.success("HTTP servers rescanned successfully")}catch{i.error("Failed to rescan HTTP servers")}finally{J(!1)}},disabled:be,className:"px-3 py-1.5 bg-primary hover:bg-primary-dark text-tide-text rounded-lg font-medium transition-colors disabled:opacity-50 flex items-center gap-2 text-sm",children:[e.jsx(x,{size:14,className:be?"animate-spin":""}),"Rescan"]})]}),be?e.jsxs("div",{className:"text-center py-12 bg-tide-surface border border-tide-border rounded-lg",children:[e.jsx(x,{className:"animate-spin mx-auto mb-4 text-primary",size:48}),e.jsx("p",{className:"text-tide-text-muted",children:"Scanning for HTTP servers..."})]}):D&&D.servers.length>0?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{className:"bg-tide-surface rounded-lg p-4 border border-tide-border",children:[e.jsx("p",{className:"text-sm text-tide-text-muted",children:"Total Servers"}),e.jsx("p",{className:"text-2xl font-bold text-tide-text mt-1",children:D.total})]}),e.jsxs("div",{className:"bg-tide-surface rounded-lg p-4 border border-tide-border",children:[e.jsx("p",{className:"text-sm text-tide-text-muted",children:"Updates Available"}),e.jsx("p",{className:"text-2xl font-bold text-accent mt-1",children:D.with_updates})]})]}),e.jsx("div",{className:"space-y-2",children:D.servers.map((t,s)=>{const n={critical:"bg-red-500/20 text-red-400 border-red-500/30",high:"bg-orange-500/20 text-orange-400 border-orange-500/30",medium:"bg-yellow-500/20 text-yellow-400 border-yellow-500/30",low:"bg-blue-500/20 text-blue-400 border-blue-500/30",info:"bg-gray-500/20 text-tide-text-muted border-gray-500/30"};return e.jsx("div",{className:"bg-tide-surface rounded-lg p-4 border border-tide-border",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(at,{size:20,className:"text-primary"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-tide-text font-medium capitalize",children:t.name}),e.jsxs("p",{className:"text-sm text-tide-text-muted",children:[t.current_version?`v${t.current_version}`:"Version unknown",t.latest_version&&t.update_available&&e.jsxs("span",{className:"text-accent ml-2",children:["â†’ v",t.latest_version]})]}),e.jsxs("p",{className:"text-xs text-tide-text-muted mt-1",children:["Detected via ",t.detection_method==="version_command"?"version command":"process scan"]})]})]})}),e.jsxs("div",{className:"flex items-center gap-2",children:[t.update_available&&e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${n[t.severity]}`,children:"Update Available"}),!t.update_available&&t.current_version&&e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-500/20 text-green-400 border border-green-500/30",children:"Up to date"})]})]})},`${t.name}-${s}`)})}),D.last_scan&&e.jsxs("div",{className:"text-sm text-tide-text-muted text-center mt-4",children:["Last scanned: ",T(new Date(D.last_scan),{addSuffix:!0})]})]}):e.jsxs("div",{className:"text-center py-12 bg-tide-surface border border-tide-border rounded-lg",children:[e.jsx(at,{className:"mx-auto mb-4 text-gray-600",size:48}),e.jsx("p",{className:"text-tide-text-muted",children:"No HTTP servers detected"}),e.jsx("p",{className:"text-sm text-tide-text-muted mt-1",children:"Container may not be running or doesn't contain common HTTP servers"})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"mb-4 flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold text-tide-text",children:"Dockerfile Dependencies"}),e.jsx("p",{className:"text-sm text-tide-text-muted mt-1",children:"Base and build images used in your Dockerfile. Dependencies are scanned automatically when you open this tab."})]}),e.jsxs("button",{onClick:async()=>{Z(!0);try{await l.containers.scanDockerfileDependencies(a.id),await Qe(),i.success("Dockerfile dependencies rescanned successfully")}catch{i.error("Failed to rescan Dockerfile dependencies")}finally{Z(!1)}},disabled:pe,className:"px-3 py-1.5 bg-primary hover:bg-primary-dark text-tide-text rounded-lg font-medium transition-colors disabled:opacity-50 flex items-center gap-2 text-sm",children:[e.jsx(x,{size:14,className:pe?"animate-spin":""}),"Rescan"]})]}),N&&N.dependencies.length>0&&e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-tide-surface rounded-lg p-4 border border-tide-border",children:[e.jsx("p",{className:"text-sm text-tide-text-muted",children:"Total Images"}),e.jsx("p",{className:"text-2xl font-bold text-tide-text mt-1",children:N.total})]}),e.jsxs("div",{className:"bg-tide-surface rounded-lg p-4 border border-tide-border",children:[e.jsx("p",{className:"text-sm text-tide-text-muted",children:"Updates Available"}),e.jsx("p",{className:"text-2xl font-bold text-accent mt-1",children:N.with_updates})]})]}),pe?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(x,{className:"animate-spin mx-auto mb-4 text-primary",size:48}),e.jsx("p",{className:"text-tide-text-muted",children:"Loading Dockerfile dependencies..."})]}):N&&N.dependencies.length>0?e.jsx("div",{className:"space-y-2",children:[...N.dependencies].sort((t,s)=>t.image_name.localeCompare(s.image_name)).map(t=>e.jsx("div",{className:"bg-tide-surface rounded-lg p-4 border border-tide-border",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(hs,{size:20,className:"text-primary"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-tide-text font-medium",children:t.image_name}),e.jsxs("p",{className:"text-sm text-tide-text-muted",children:[t.dependency_type==="base_image"?"Base Image":"Build Image",t.stage_name&&` â€¢ Stage: ${t.stage_name}`," â€¢ ","Current: ",t.current_tag,t.latest_tag&&t.update_available&&e.jsxs("span",{className:"text-accent ml-2",children:["â†’ ",t.latest_tag]})]}),e.jsxs("p",{className:"text-xs text-tide-text-muted mt-1",children:[t.dockerfile_path,t.line_number&&` (line ${t.line_number})`]})]})]})}),e.jsxs("div",{className:"flex items-center gap-2",children:[t.update_available&&e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-accent/20 text-accent border border-accent/30",children:"Update Available"}),!t.update_available&&t.last_checked&&e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-500/20 text-green-400 border border-green-500/30",children:"Up to date"})]})]})},t.id))}):e.jsxs("div",{className:"text-center py-12 bg-tide-surface border border-tide-border rounded-lg",children:[e.jsx(Je,{className:"mx-auto mb-4 text-gray-600",size:48}),e.jsx("p",{className:"text-tide-text-muted",children:"No Dockerfile found"}),e.jsx("p",{className:"text-sm text-tide-text-muted mt-1",children:'Click "Scan Dockerfile" to detect base and build images if a Dockerfile exists'})]}),N?.last_scan&&e.jsxs("div",{className:"text-sm text-tide-text-muted text-center mt-4",children:["Last scanned: ",T(new Date(N.last_scan),{addSuffix:!0})]})]})]}),e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{children:[e.jsxs("div",{className:"mb-4 flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold text-tide-text",children:"Application Dependencies"}),e.jsx("p",{className:"text-sm text-tide-text-muted mt-1",children:"Track dependencies used by your application and available updates. Dependencies are scanned automatically when you open this tab."})]}),e.jsxs("button",{onClick:async()=>{Ve(!0);try{await l.containers.scanAppDependencies(a.id),await Ge(),i.success("Application dependencies rescanned successfully")}catch{i.error("Failed to rescan application dependencies")}finally{Ve(!1)}},disabled:Oe||We,className:"px-3 py-1.5 bg-primary hover:bg-primary-dark text-tide-text rounded-lg font-medium transition-colors disabled:opacity-50 flex items-center gap-2 text-sm",children:[e.jsx(x,{size:14,className:Oe?"animate-spin":""}),"Rescan"]})]}),m&&e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-4",children:[e.jsxs("div",{className:"bg-tide-surface rounded-lg p-4 border border-tide-border",children:[e.jsx("p",{className:"text-sm text-tide-text-muted",children:"Total Dependencies"}),e.jsx("p",{className:"text-2xl font-bold text-tide-text mt-1",children:m.total})]}),e.jsxs("div",{className:"bg-tide-surface rounded-lg p-4 border border-tide-border",children:[e.jsx("p",{className:"text-sm text-tide-text-muted",children:"Updates Available"}),e.jsx("p",{className:"text-2xl font-bold text-accent mt-1",children:m.with_updates})]}),e.jsxs("div",{className:"bg-tide-surface rounded-lg p-4 border border-tide-border",children:[e.jsx("p",{className:"text-sm text-tide-text-muted",children:"Security Issues"}),e.jsx("p",{className:"text-2xl font-bold text-red-400 mt-1",children:m.with_security_issues})]})]}),m&&m.dependencies.length>0&&e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>ue("all"),className:`px-4 py-2 rounded-lg font-medium transition-colors ${z==="all"?"bg-primary text-tide-text":"bg-tide-surface text-tide-text hover:bg-tide-surface-light"}`,children:["All (",m.total,")"]}),e.jsxs("button",{onClick:()=>ue("updates"),className:`px-4 py-2 rounded-lg font-medium transition-colors ${z==="updates"?"bg-primary text-tide-text":"bg-tide-surface text-tide-text hover:bg-tide-surface-light"}`,children:["Updates (",m.with_updates,")"]}),e.jsxs("button",{onClick:()=>ue("security"),className:`px-4 py-2 rounded-lg font-medium transition-colors ${z==="security"?"bg-primary text-tide-text":"bg-tide-surface text-tide-text hover:bg-tide-surface-light"}`,children:["Security (",m.with_security_issues,")"]})]}),We?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(x,{className:"animate-spin mx-auto mb-4 text-primary",size:48}),e.jsx("p",{className:"text-tide-text-muted",children:"Loading dependencies..."})]}):m&&m.dependencies.length>0?e.jsx("div",{className:"space-y-2",children:[...m.dependencies].filter(t=>z==="updates"?t.update_available:z==="security"?t.security_advisories>0:!0).sort((t,s)=>t.name.localeCompare(s.name)).map(t=>{const s={critical:"bg-red-500/20 text-red-400 border-red-500/30",high:"bg-orange-500/20 text-orange-400 border-orange-500/30",medium:"bg-yellow-500/20 text-yellow-400 border-yellow-500/30",low:"bg-blue-500/20 text-blue-400 border-blue-500/30",info:"bg-gray-500/20 text-tide-text-muted border-gray-500/30"},n={npm:"ðŸ“¦",pypi:"ðŸ",composer:"ðŸ˜",cargo:"ðŸ¦€",go:"ðŸ¹"};return e.jsxs("div",{className:"bg-tide-surface rounded-lg p-4 border border-tide-border flex items-center justify-between",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-2xl",children:n[t.ecosystem]||"ðŸ“¦"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-tide-text font-medium",children:t.name}),e.jsxs("p",{className:"text-sm text-tide-text-muted",children:[t.ecosystem," â€¢ Current: ",t.current_version,t.latest_version&&t.update_available&&e.jsxs("span",{className:"text-accent ml-2",children:["â†’ ",t.latest_version]})]})]})]})}),e.jsxs("div",{className:"flex items-center gap-2",children:[t.update_available&&e.jsxs("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${s[t.severity]}`,children:[t.severity==="critical"&&"Critical Update",t.severity==="high"&&"High Priority",t.severity==="medium"&&"Major Update",t.severity==="low"&&"Minor Update",t.severity==="info"&&"Patch Update"]}),t.security_advisories>0&&e.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-500/20 text-red-400 border border-red-500/30",children:[e.jsx(ps,{size:12,className:"mr-1"}),t.security_advisories," ",t.security_advisories===1?"Advisory":"Advisories"]}),t.socket_score!==null&&e.jsxs("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${t.socket_score>=70?"bg-green-500/20 text-green-400 border border-green-500/30":t.socket_score>=40?"bg-yellow-500/20 text-yellow-400 border border-yellow-500/30":"bg-red-500/20 text-red-400 border border-red-500/30"}`,children:["Socket: ",t.socket_score]})]})]},`${t.ecosystem}-${t.name}`)})}):e.jsxs("div",{className:"text-center py-12 bg-tide-surface border border-tide-border rounded-lg",children:[e.jsx(et,{className:"mx-auto mb-4 text-gray-600",size:48}),e.jsx("p",{className:"text-tide-text-muted",children:"No dependencies found"}),e.jsx("p",{className:"text-sm text-tide-text-muted mt-1",children:"No package files (package.json, pyproject.toml, composer.json, etc.) detected in your project"})]}),m?.last_scan&&e.jsxs("div",{className:"text-sm text-tide-text-muted text-center mt-4",children:["Last scanned: ",T(new Date(m.last_scan),{addSuffix:!0})]})]})})]}),c==="settings"&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-tide-text mb-6",children:"Container Settings"}),wt&&e.jsx("div",{className:"bg-tide-surface/50 rounded-lg p-6 border border-tide-border-light mb-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(bs,{size:20,className:a.is_my_project?"fill-primary text-primary":"text-tide-text-muted"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-base font-semibold text-tide-text",children:"My Project"}),e.jsx("p",{className:"text-sm text-tide-text-muted mt-1",children:"Mark this as your own project to group it separately and track application dependencies. Dev containers are auto-detected from your projects directory."})]})]}),e.jsx("button",{onClick:Vt,disabled:f,className:`px-4 py-2 rounded-lg font-medium transition-colors ${a.is_my_project?"bg-primary text-tide-text hover:bg-primary/80":"bg-tide-surface-light text-tide-text hover:bg-gray-500"} disabled:opacity-50`,children:a.is_my_project?"Remove from My Projects":"Add to My Projects"})]})}),e.jsxs("div",{className:"columns-1 xl:columns-2 gap-6 space-y-6 xl:space-y-0",style:{columnGap:"1.5rem"},children:[e.jsxs("div",{className:"bg-tide-surface/50 rounded-lg p-6 break-inside-avoid mb-6 border border-tide-border",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center bg-gray-500/10 border border-gray-500/20",children:e.jsx(gs,{className:"w-5 h-5 text-tide-text-muted"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-base font-semibold text-tide-text",children:"Auto-Restart"}),e.jsx("p",{className:"text-sm text-tide-text-muted",children:L?j?.is_paused?"Enabled (Paused)":"Enabled":"Disabled"})]})]}),e.jsx("button",{onClick:Tt,disabled:f,className:"px-4 py-2 bg-primary text-tide-text rounded-lg hover:bg-primary/80 transition-colors disabled:opacity-50",children:L?"Disable":"Enable"})]}),L&&!ft&&j&&e.jsxs("div",{className:"mt-4 space-y-4 pt-4 border-t border-tide-border-light",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium text-tide-text mb-3",children:"Current State"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"bg-tide-surface/50 rounded-lg p-3",children:[e.jsx("div",{className:"text-xs text-tide-text-muted mb-1",children:"Consecutive Failures"}),e.jsx("div",{className:`text-lg font-semibold ${j.consecutive_failures>0?"text-red-400":"text-green-400"}`,children:j.consecutive_failures})]}),e.jsxs("div",{className:"bg-tide-surface/50 rounded-lg p-3",children:[e.jsx("div",{className:"text-xs text-tide-text-muted mb-1",children:"Total Restarts"}),e.jsx("div",{className:"text-lg font-semibold text-tide-text",children:j.total_restarts})]}),e.jsxs("div",{className:"bg-tide-surface/50 rounded-lg p-3",children:[e.jsx("div",{className:"text-xs text-tide-text-muted mb-1",children:"Current Backoff"}),e.jsx("div",{className:"text-lg font-semibold text-tide-text",children:fe(j.current_backoff_seconds)})]}),e.jsxs("div",{className:"bg-tide-surface/50 rounded-lg p-3",children:[e.jsx("div",{className:"text-xs text-tide-text-muted mb-1",children:"Max Retries"}),e.jsx("div",{className:`text-lg font-semibold ${j.max_retries_reached?"text-red-400":"text-tide-text"}`,children:j.max_retries_reached?"Reached":"Not Reached"})]})]})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium text-tide-text mb-3",children:"Configuration"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-tide-text-muted mb-1",children:"Backoff Strategy"}),e.jsxs("select",{value:d.backoff_strategy,onChange:t=>v({...d,backoff_strategy:t.target.value}),className:"w-full px-3 py-2 bg-tide-surface border border-tide-border rounded-lg text-tide-text text-sm focus:outline-none focus:ring-2 focus:ring-primary",children:[e.jsx("option",{value:"exponential",children:"Exponential"}),e.jsx("option",{value:"linear",children:"Linear"}),e.jsx("option",{value:"fixed",children:"Fixed"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs text-tide-text-muted mb-1",children:["Max Attempts (",d.max_attempts,")"]}),e.jsx("input",{type:"range",min:"1",max:"100",value:d.max_attempts,onChange:t=>v({...d,max_attempts:parseInt(t.target.value)}),className:"w-full accent-teal-500"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs text-tide-text-muted mb-1",children:["Base Delay (",d.base_delay_seconds,"s)"]}),e.jsx("input",{type:"range",min:"1",max:"60",value:d.base_delay_seconds,onChange:t=>v({...d,base_delay_seconds:parseFloat(t.target.value)}),className:"w-full accent-teal-500"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs text-tide-text-muted mb-1",children:["Max Delay (",fe(d.max_delay_seconds),")"]}),e.jsx("input",{type:"range",min:"60",max:"3600",value:d.max_delay_seconds,onChange:t=>v({...d,max_delay_seconds:parseFloat(t.target.value)}),className:"w-full accent-teal-500"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs text-tide-text-muted mb-1",children:["Success Window (",fe(d.success_window_seconds),")"]}),e.jsx("input",{type:"range",min:"60",max:"1800",value:d.success_window_seconds,onChange:t=>v({...d,success_window_seconds:parseInt(t.target.value)}),className:"w-full accent-teal-500"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-tide-text",children:"Health Check Enabled"}),e.jsx("button",{onClick:()=>v({...d,health_check_enabled:!d.health_check_enabled}),className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${d.health_check_enabled?"bg-primary":"bg-tide-surface-light"}`,children:e.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${d.health_check_enabled?"translate-x-6":"translate-x-1"}`})})]}),d.health_check_enabled&&e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs text-tide-text-muted mb-1",children:["Health Check Timeout (",d.health_check_timeout,"s)"]}),e.jsx("input",{type:"number",min:"10",max:"300",value:d.health_check_timeout,onChange:t=>v({...d,health_check_timeout:parseInt(t.target.value)}),className:"w-full px-3 py-2 bg-tide-surface border border-tide-border rounded-lg text-tide-text text-sm"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-tide-text",children:"Rollback on Health Fail"}),e.jsx("button",{onClick:()=>v({...d,rollback_on_health_fail:!d.rollback_on_health_fail}),className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${d.rollback_on_health_fail?"bg-primary":"bg-tide-surface-light"}`,children:e.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${d.rollback_on_health_fail?"translate-x-6":"translate-x-1"}`})})]}),e.jsx("button",{onClick:Ut,className:"w-full px-4 py-2 bg-primary text-tide-text rounded-lg hover:bg-primary/80 transition-colors",children:"Save Configuration"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:Bt,disabled:j.consecutive_failures===0,className:"flex-1 px-3 py-2 bg-tide-surface text-tide-text rounded-lg hover:bg-tide-surface-light transition-colors disabled:opacity-50 text-sm flex items-center justify-center gap-2",children:[e.jsx(x,{className:"w-4 h-4"}),"Reset State"]}),j.is_paused?e.jsxs("button",{onClick:zt,className:"flex-1 px-3 py-2 bg-green-600 text-tide-text rounded-lg hover:bg-green-700 transition-colors text-sm flex items-center justify-center gap-2",children:[e.jsx(fs,{className:"w-4 h-4"}),"Resume"]}):e.jsxs("button",{onClick:It,className:"flex-1 px-3 py-2 bg-yellow-600 text-tide-text rounded-lg hover:bg-yellow-700 transition-colors text-sm flex items-center justify-center gap-2",children:[e.jsx(js,{className:"w-4 h-4"}),"Pause"]})]})]})]}),e.jsxs("div",{className:"bg-tide-surface/50 rounded-lg p-6",children:[e.jsx("h4",{className:"text-base font-semibold text-tide-text mb-3",children:"Update Policy"}),e.jsx("p",{className:"text-sm text-tide-text-muted mb-4",children:"Choose how updates should be handled for this container."}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:[{value:"auto",label:"Auto",desc:"Apply updates automatically",icon:st},{value:"manual",label:"Manual",desc:"Require manual approval",icon:ys},{value:"security",label:"Security Only",desc:"Auto-apply security updates",icon:vs},{value:"disabled",label:"Disabled",desc:"No automatic checks",icon:Ns}].map(t=>e.jsxs("button",{onClick:()=>St(t.value),disabled:f,className:`p-4 rounded-lg border-2 transition-all text-left ${le===t.value?"border-primary bg-primary/10":"border-tide-border bg-tide-surface hover:border-tide-border-light"}`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(t.icon,{className:`w-5 h-5 ${le===t.value?"text-primary":"text-tide-text-muted"}`}),e.jsx("span",{className:`font-medium ${le===t.value,"text-tide-text"}`,children:t.label})]}),e.jsx("p",{className:"text-xs text-tide-text-muted",children:t.desc})]},t.value))})]}),e.jsxs("div",{className:"bg-tide-surface/50 rounded-lg p-6",children:[e.jsx("h4",{className:"text-base font-semibold text-tide-text mb-3",children:"Version Scope"}),e.jsx("p",{className:"text-sm text-tide-text-muted mb-4",children:"Control which version changes are allowed during updates."}),e.jsx("div",{className:"grid grid-cols-3 gap-3",children:[{value:"patch",label:"Patch",desc:"Only patch updates (1.2.3 â†’ 1.2.4)"},{value:"minor",label:"Minor",desc:"Minor + patch (1.2.x â†’ 1.3.x)"},{value:"major",label:"Major",desc:"All updates (1.x.x â†’ 2.x.x)"}].map(t=>e.jsxs("button",{onClick:()=>At(t.value),disabled:f,className:`p-4 rounded-lg border-2 transition-all text-left ${Re===t.value?"border-primary bg-primary/10":"border-tide-border bg-tide-surface hover:border-tide-border-light"}`,children:[e.jsx("div",{className:"mb-2",children:e.jsx("span",{className:`font-medium ${Re===t.value,"text-tide-text"}`,children:t.label})}),e.jsx("p",{className:"text-xs text-tide-text-muted",children:t.desc})]},t.value))})]}),e.jsxs("div",{className:"bg-tide-surface/50 rounded-lg p-6",children:[e.jsx("h4",{className:"text-base font-semibold text-tide-text mb-3",children:"Pre-release Versions"}),e.jsx("p",{className:"text-sm text-tide-text-muted mb-4",children:"Control whether to include pre-release tags when checking for updates."}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-tide-text",children:"Include Pre-releases"}),e.jsx("p",{className:"text-xs text-tide-text-muted mt-1",children:q?"Including pre-releases":"Stable releases only"})]}),e.jsx("button",{onClick:Dt,disabled:f,className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${q?"bg-primary":"bg-tide-surface-light"}`,children:e.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${q?"translate-x-6":"translate-x-1"}`})})]})]}),e.jsxs("div",{className:"bg-tide-surface/50 rounded-lg p-6",children:[e.jsx("h4",{className:"text-base font-semibold text-tide-text mb-3",children:"Vulnerability Scanning"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-tide-text",children:"VulnForge Integration"}),e.jsx("p",{className:"text-xs text-tide-text-muted mt-1",children:"Scan for security vulnerabilities"})]}),e.jsx("div",{className:`px-3 py-1.5 rounded ${Me?"bg-green-500/10 text-green-500":"bg-gray-500/10 text-tide-text-muted"}`,children:Me?"Enabled":"Disabled"})]})]}),e.jsxs("div",{className:"bg-tide-surface/50 rounded-lg p-6 break-inside-avoid mb-6 border border-tide-border",children:[e.jsx("h4",{className:"text-base font-semibold text-tide-text mb-3",children:"Health Check"}),e.jsx("p",{className:"text-sm text-tide-text-muted mb-3",children:"Control how TideWatch validates this container after updates."}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs uppercase tracking-wide text-tide-text-muted mb-1 block",children:"Health Check URL"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{placeholder:"http://container:port/health",className:"flex-1 px-3 py-2 bg-tide-surface border border-tide-border text-tide-text placeholder-gray-500 rounded-lg",type:"text",value:de,onChange:t=>$e(t.target.value)}),e.jsx("button",{onClick:Pt,className:"px-3 py-2 bg-tide-surface hover:bg-tide-surface-light text-tide-text rounded-lg flex items-center gap-1",title:"Auto-fill from compose labels",children:e.jsx(rt,{className:"w-4 h-4"})}),e.jsx("button",{onClick:Rt,disabled:f,className:"px-4 py-2 bg-tide-surface-light hover:bg-gray-500 text-tide-text rounded-lg disabled:opacity-50",children:"Save"})]}),e.jsx("p",{className:"text-xs text-tide-text-muted mt-1",children:"HTTP endpoint to check container health after updates."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs uppercase tracking-wide text-tide-text-muted mb-1 block",children:"Method"}),e.jsxs("select",{value:bt,onChange:t=>Ft(t.target.value),disabled:f,className:"w-full px-3 py-2 bg-tide-surface border border-tide-border text-tide-text rounded-lg focus:outline-none focus:ring-2 focus:ring-primary disabled:opacity-50",children:[e.jsx("option",{value:"auto",children:"Auto (HTTP if URL, otherwise Docker)"}),e.jsx("option",{value:"http",children:"HTTP only (always hit the URL)"}),e.jsx("option",{value:"docker",children:"Docker inspect only"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs uppercase tracking-wide text-tide-text-muted mb-1 block",children:"Auth Token"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{placeholder:"apikey=XYZ or token:Bearer ...",className:"flex-1 px-3 py-2 bg-tide-surface border border-tide-border text-tide-text placeholder-gray-500 rounded-lg",type:"password",value:ne,onChange:t=>Pe(t.target.value)}),e.jsx("button",{onClick:Mt,disabled:!ne||f,className:"px-4 py-2 bg-tide-surface-light hover:bg-gray-500 text-tide-text rounded-lg disabled:opacity-50 disabled:cursor-not-allowed",children:"Save"})]}),e.jsx("p",{className:"text-xs text-tide-text-muted mt-1",children:a.health_check_has_auth?"Auth token configured":"No auth token stored"})]})]})]}),e.jsxs("div",{className:"bg-tide-surface/50 rounded-lg p-6 break-inside-avoid mb-6 border border-tide-border",children:[e.jsx("h4",{className:"text-base font-semibold text-tide-text mb-3",children:"Release Source"}),e.jsx("p",{className:"text-sm text-tide-text-muted mb-3",children:"Provide a GitHub repo or changelog URL for release notes."}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{placeholder:"github:user/repo or https://example.com/changelog",className:"flex-1 px-3 py-2 bg-tide-surface border border-tide-border text-tide-text placeholder-gray-500 rounded-lg",type:"text",value:ce,onChange:t=>He(t.target.value)}),e.jsx("button",{onClick:Ht,className:"px-3 py-2 bg-tide-surface hover:bg-tide-surface-light text-tide-text rounded-lg flex items-center gap-1",title:"Auto-detect from image name",children:e.jsx(rt,{className:"w-4 h-4"})}),e.jsx("button",{onClick:$t,disabled:f,className:"px-4 py-2 bg-tide-surface-light hover:bg-gray-500 text-tide-text rounded-lg disabled:opacity-50",children:"Save"})]}),e.jsx("p",{className:"text-xs text-tide-text-muted mt-2",children:"Examples: github:linuxserver/docker-sonarr, https://lscr.io/changelog/sonarr"})]}),e.jsxs("div",{className:"bg-tide-surface/50 rounded-lg p-6 break-inside-avoid mb-6 border border-tide-border",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center bg-gray-500/10 border border-gray-500/20",children:e.jsx(ws,{className:"w-5 h-5 text-tide-text-muted"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-base font-semibold text-tide-text",children:"Dependency Management"}),e.jsx("p",{className:"text-sm text-tide-text-muted",children:"Define update order based on container dependencies"})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-xs uppercase tracking-wide text-tide-text-muted mb-2",children:"This container depends on:"}),I.length>0?e.jsx("div",{className:"flex flex-wrap gap-2 mb-3",children:I.map(t=>e.jsxs("span",{className:"px-3 py-1 bg-primary/20 text-primary rounded-lg text-sm flex items-center gap-2",children:[t,e.jsx("button",{onClick:()=>Kt(t),className:"hover:text-red-400 transition-colors",children:e.jsx(ye,{className:"w-3 h-3"})})]},t))}):e.jsx("p",{className:"text-tide-text-muted text-sm mb-3",children:"No dependencies configured. This container can update independently."})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-xs uppercase tracking-wide text-tide-text-muted mb-2",children:"Add Dependency"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("select",{value:Y,onChange:t=>Be(t.target.value),className:"flex-1 px-3 py-2 bg-tide-surface border border-tide-border text-tide-text rounded-lg focus:outline-none focus:ring-2 focus:ring-primary",children:[e.jsx("option",{value:"",children:"Select container..."}),yt.filter(t=>!I.includes(t.name)).map(t=>e.jsx("option",{value:t.name,children:t.name},t.id))]}),e.jsx("button",{onClick:Wt,disabled:!Y,className:"px-4 py-2 bg-primary hover:bg-primary/80 text-tide-text rounded-lg transition-colors disabled:opacity-50",children:"Add"})]}),e.jsx("p",{className:"text-xs text-tide-text-muted mt-2",children:"Dependencies will be updated before this container"})]}),e.jsxs("div",{className:"pt-4 border-t border-tide-border-light",children:[e.jsx("label",{className:"block text-xs uppercase tracking-wide text-tide-text-muted mb-2",children:"Containers that depend on this one:"}),Ue.length>0?e.jsx("div",{className:"flex flex-wrap gap-2",children:Ue.map(t=>e.jsx("span",{className:"px-3 py-1 bg-tide-surface-light/50 text-tide-text rounded-lg text-sm",children:t},t))}):e.jsx("p",{className:"text-tide-text-muted text-sm",children:"No containers depend on this one"})]})]}),e.jsxs("div",{className:"bg-tide-surface/50 rounded-lg p-6 break-inside-avoid mb-6 border border-tide-border",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center bg-gray-500/10 border border-gray-500/20",children:e.jsx(ks,{className:"w-5 h-5 text-tide-text-muted"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-base font-semibold text-tide-text",children:"Update Window"}),e.jsx("p",{className:"text-sm text-tide-text-muted",children:"Restrict updates to specific time periods"})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-xs uppercase tracking-wide text-tide-text-muted mb-2",children:"Allowed Update Window"}),Ie?e.jsxs("div",{className:"bg-tide-surface border border-tide-border rounded-lg p-3 mb-2 flex items-center justify-between",children:[e.jsx("span",{className:"text-tide-text font-mono text-sm",children:Ie}),e.jsx("button",{onClick:()=>{ze(""),E("")},className:"text-red-400 hover:text-red-300 text-sm transition-colors",children:"Clear"})]}):e.jsx("p",{className:"text-tide-text-muted text-sm mb-2",children:"No restrictions - updates allowed anytime"})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"block text-xs uppercase tracking-wide text-tide-text-muted mb-1",children:"Set Update Window"}),e.jsx("input",{type:"text",placeholder:"HH:MM-HH:MM or Days:HH:MM-HH:MM",className:"w-full px-3 py-2 bg-tide-surface border border-tide-border text-tide-text placeholder-gray-500 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary",value:me,onChange:t=>E(t.target.value)})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-xs uppercase tracking-wide text-tide-text-muted mb-2",children:"Quick Presets"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("button",{onClick:()=>E("02:00-06:00"),className:"px-3 py-2 bg-tide-surface hover:bg-tide-surface border border-tide-border text-tide-text rounded-lg text-sm text-left transition-colors",children:[e.jsx("div",{className:"font-medium",children:"Night Window"}),e.jsx("div",{className:"text-xs text-tide-text-muted",children:"02:00-06:00 daily"})]}),e.jsxs("button",{onClick:()=>E("Sat,Sun:00:00-23:59"),className:"px-3 py-2 bg-tide-surface hover:bg-tide-surface border border-tide-border text-tide-text rounded-lg text-sm text-left transition-colors",children:[e.jsx("div",{className:"font-medium",children:"Weekends Only"}),e.jsx("div",{className:"text-xs text-tide-text-muted",children:"Sat,Sun anytime"})]}),e.jsxs("button",{onClick:()=>E("Mon-Fri:22:00-06:00"),className:"px-3 py-2 bg-tide-surface hover:bg-tide-surface border border-tide-border text-tide-text rounded-lg text-sm text-left transition-colors",children:[e.jsx("div",{className:"font-medium",children:"Weeknights"}),e.jsx("div",{className:"text-xs text-tide-text-muted",children:"Mon-Fri 22:00-06:00"})]}),e.jsxs("button",{onClick:()=>E("Sat,Sun:02:00-10:00"),className:"px-3 py-2 bg-tide-surface hover:bg-tide-surface border border-tide-border text-tide-text rounded-lg text-sm text-left transition-colors",children:[e.jsx("div",{className:"font-medium",children:"Weekend Mornings"}),e.jsx("div",{className:"text-xs text-tide-text-muted",children:"Sat,Sun 02:00-10:00"})]})]})]}),e.jsx("button",{onClick:Ot,disabled:f,className:"w-full px-4 py-2 bg-primary hover:bg-primary/80 text-tide-text rounded-lg transition-colors disabled:opacity-50",children:"Save Update Window"}),e.jsxs("div",{className:"mt-3 text-xs text-tide-text-muted",children:[e.jsx("p",{className:"font-medium mb-1",children:"Format Examples:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 ml-2",children:[e.jsx("li",{children:"02:00-06:00 (daily window)"}),e.jsx("li",{children:"Sat,Sun:00:00-23:59 (weekends)"}),e.jsx("li",{children:"Mon-Fri:22:00-06:00 (crosses midnight)"})]})]})]})]})]})]})]})]})})}export{Ps as default};
